{"data":{"site":{"siteMetadata":{"title":"酱香型猫砂盆","author":"xuzhanhh"}},"markdownRemark":{"id":"e13ff1bd-6c57-514f-aa81-e04621899e38","html":"<h2>前言</h2>\n<p>​\t产品需求选择器实现如下效果，即某一行选中了某一个数值后那么其余行该选项就不可以选中了，这种就是很明显的标志位操作了，一般用字符串，对象什么的也可以解决。就是选中时在字符串中加入该value，然后在遍历渲染<Option>时用正则match一下判断是否该渲染即可。</p>\n<p><img src=\"/images/image-20190320202815576.png\" alt=\"image-20190320202815576\"></p>\n<h2>位操作逻辑</h2>\n<p> 以下逻辑仅为本人<strong>快速实现业务逻辑</strong>，没怎么经过拓展和优化代码的。如果有更好的实现方案欢迎大佬指导！</p>\n<h3>定义tag</h3>\n<p>在每一个选项多一个tag项，其值为二进制全部0并只有一位为1的number，且唯一。currentSelect作为记录当前的tag总和</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> pointMap <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token constant\">APP</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'APP'</span><span class=\"token punctuation\">,</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token string\">'APP'</span><span class=\"token punctuation\">,</span>\n    tag<span class=\"token punctuation\">:</span> <span class=\"token number\">0b0001</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">M</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'M'</span><span class=\"token punctuation\">,</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token string\">'M'</span><span class=\"token punctuation\">,</span>\n    tag<span class=\"token punctuation\">:</span> <span class=\"token number\">0b0010</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">WQ</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'WQ'</span><span class=\"token punctuation\">,</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token string\">'WQ'</span><span class=\"token punctuation\">,</span>\n    tag<span class=\"token punctuation\">:</span> <span class=\"token number\">0b0100</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">MINI</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'小程序'</span><span class=\"token punctuation\">,</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token string\">'MINI'</span><span class=\"token punctuation\">,</span>\n    tag<span class=\"token punctuation\">:</span> <span class=\"token number\">0b1000</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>添加/修改选项</h3>\n<p>当前tag ^ 被取消选择的tag(如果有的话) | 当前选中的tag </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">currentData<span class=\"token punctuation\">.</span>currentSelect <span class=\"token operator\">^</span> pointMap<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>oldItemChannel <span class=\"token operator\">?</span> oldItemChannel <span class=\"token punctuation\">:</span> item<span class=\"token punctuation\">.</span>channel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>tag <span class=\"token operator\">|</span> tag</code></pre></div>\n<h3>取消选择/删除行</h3>\n<p>当前tag ^ 被取消选择的tag</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">currentData<span class=\"token punctuation\">.</span>currentSelect <span class=\"token operator\">^</span> pointMap<span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span>channel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>tag</code></pre></div>\n<h3>简单解析</h3>\n<p><strong>1. 删除</strong></p>\n<p>假定有三行，且当前选择了APP，M，WQ 那么currentSelect是0b0111，如果删除WQ行则运算为：</p>\n<p>​\t0b0111 ^ 0b0100 = 0b011</p>\n<p>相同的位置0，不同的位置1</p>\n<p><strong>2. 添加</strong></p>\n<p>这个太简单了，就是有1的位就置1</p>","timeToRead":1,"frontmatter":{"title":"使用位操作快速实现互斥选项","date":"March 20, 2019","spoiler":"位操作入门篇"},"fields":{"slug":"/使用位操作快速实现互斥选项/"}}},"pageContext":{"slug":"/使用位操作快速实现互斥选项/","previous":{"fields":{"slug":"/why hooks/"},"frontmatter":{"title":"why hooks（一）"}},"next":{"fields":{"slug":"/css world(1)/"},"frontmatter":{"title":"神奇的CSS世界(1)"}}}}