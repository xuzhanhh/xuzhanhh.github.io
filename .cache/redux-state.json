{
  "nodes": {
    "SitePage /dev-404-page/": {
      "path": "/dev-404-page/",
      "id": "SitePage /dev-404-page/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "f91d29e10ba680b413138cf9ed86e655",
        "owner": "internal-data-bridge"
      }
    },
    "d48d1c52-fe48-53cb-8f08-aa4b47dde5a5": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/dev-404-page",
      "id": "d48d1c52-fe48-53cb-8f08-aa4b47dde5a5",
      "name": "dev-404-page",
      "version": "1.0.0",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "createPagesStatefully"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/dev-404-page",
      "packageJson": {
        "name": "dev-404-page",
        "description": "Internal plugin to add a 404 page in development with helpful information",
        "version": "1.0.0",
        "main": "index.js",
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [],
        "devDependencies": [],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "c5dc32e8672ffa3711c9f14a985665c5",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "1fc32581-893a-55e8-8927-bcd667e2b700": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/load-babel-config",
      "id": "1fc32581-893a-55e8-8927-bcd667e2b700",
      "name": "load-babel-config",
      "version": "1.0.0",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onPreBootstrap"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/load-babel-config",
      "packageJson": {
        "name": "load-babel-config",
        "description": "Internal plugin that handles loading Babel configs",
        "version": "1.0.0",
        "main": "index.js",
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [],
        "devDependencies": [],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "6f5dd718a65e911d99ba9bfc681527ee",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "a5079d69-ba80-53dc-82f9-0f440bd5448c": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/internal-data-bridge",
      "id": "a5079d69-ba80-53dc-82f9-0f440bd5448c",
      "name": "internal-data-bridge",
      "version": "1.0.0",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "sourceNodes",
        "onCreatePage"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/internal-data-bridge",
      "packageJson": {
        "name": "internal-data-bridge",
        "description": "An internal Gatsby plugin which creates data nodes from internal data",
        "version": "1.0.0",
        "main": "index.js",
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [],
        "devDependencies": [],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "ddecd3e2945140d003bb16552a2a66da",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "f795702c-a3b8-5a88-88ee-5d06019d44fa": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/prod-404",
      "id": "f795702c-a3b8-5a88-88ee-5d06019d44fa",
      "name": "prod-404",
      "version": "1.0.0",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onCreatePage"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/prod-404",
      "packageJson": {
        "name": "prod-404",
        "description": "Internal plugin to detect various flavors of 404 pages and ensure there's a 404.html path created as well to ensure compatability with static hosts",
        "version": "1.0.0",
        "main": "index.js",
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [],
        "devDependencies": [],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "a49125cb2da03cd5866ffbf7f0eb3bb8",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "84dad27f-1d44-51fc-ac56-4db2e5222995": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/query-runner",
      "id": "84dad27f-1d44-51fc-ac56-4db2e5222995",
      "name": "query-runner",
      "version": "1.0.0",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onCreatePage"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/query-runner",
      "packageJson": {
        "name": "query-runner",
        "description": "Internal plugin for running queries",
        "version": "1.0.0",
        "main": "index.js",
        "author": "",
        "license": "MIT",
        "dependencies": [],
        "devDependencies": [],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "340aacadac9e7d5d027402666b8ddc7a",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "6f4b2fa9-66b5-5205-a03f-140005a2cfe5": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing",
      "id": "6f4b2fa9-66b5-5205-a03f-140005a2cfe5",
      "name": "webpack-theme-component-shadowing",
      "version": "1.0.0",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onCreateWebpackConfig"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby/dist/internal-plugins/webpack-theme-component-shadowing",
      "packageJson": {
        "name": "webpack-theme-component-shadowing",
        "description": "An internal Gatsby plugin which handles configuring webpack to ensure theme components fall back from the user's site to theme modules.",
        "version": "1.0.0",
        "main": "index.js",
        "author": "Chris Biscardi <chris@christopherbiscardi.com>",
        "license": "MIT",
        "dependencies": [],
        "devDependencies": [],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "1f94bf8c57ab5c9d0493211894e07fab",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "6b7473d7-11d5-5975-a1ef-2c4465ca30e9": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-source-filesystem",
      "id": "6b7473d7-11d5-5975-a1ef-2c4465ca30e9",
      "name": "gatsby-source-filesystem",
      "version": "2.0.10",
      "pluginOptions": {
        "plugins": [],
        "path": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
        "name": "pages"
      },
      "nodeAPIs": [
        "sourceNodes",
        "setFieldsOnGraphQLNodeType"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-source-filesystem",
      "packageJson": {
        "name": "gatsby-source-filesystem",
        "description": "Gatsby plugin which parses files within a directory for further parsing by other plugins",
        "version": "2.0.10",
        "keywords": [
          "gatsby",
          "gatsby-plugin"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "better-queue",
            "version": "^3.8.7"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "chokidar",
            "version": "^1.7.0"
          },
          {
            "name": "file-type",
            "version": "^10.2.0"
          },
          {
            "name": "fs-extra",
            "version": "^5.0.0"
          },
          {
            "name": "got",
            "version": "^7.1.0"
          },
          {
            "name": "md5-file",
            "version": "^3.1.1"
          },
          {
            "name": "mime",
            "version": "^2.2.0"
          },
          {
            "name": "pretty-bytes",
            "version": "^4.0.2"
          },
          {
            "name": "read-chunk",
            "version": "^3.0.0"
          },
          {
            "name": "slash",
            "version": "^1.0.0"
          },
          {
            "name": "valid-url",
            "version": "^1.0.9"
          },
          {
            "name": "xstate",
            "version": "^3.1.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "73ebc1bfeac83572ae4d773ef4ccf55b",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "1410f0a6-4bed-597e-bbd8-cfa10306010a": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-transformer-remark",
      "id": "1410f0a6-4bed-597e-bbd8-cfa10306010a",
      "name": "gatsby-transformer-remark",
      "version": "2.1.15",
      "pluginOptions": {
        "plugins": [
          {
            "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-images",
            "id": "4a359a36-fef3-5c49-a0f9-45c24a5fd434",
            "name": "gatsby-remark-images",
            "version": "2.0.6",
            "pluginOptions": {
              "plugins": [],
              "maxWidth": 590,
              "wrapperStyle": "",
              "backgroundColor": "white",
              "linkImagesToOriginal": true,
              "showCaptions": false,
              "pathPrefix": "",
              "withWebp": false
            },
            "nodeAPIs": [],
            "browserAPIs": [],
            "ssrAPIs": [],
            "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-images"
          },
          {
            "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-responsive-iframe",
            "id": "1a3d9dbf-c3c7-50dc-9f59-97f0cf8bb163",
            "name": "gatsby-remark-responsive-iframe",
            "version": "2.0.7",
            "pluginOptions": {
              "plugins": [],
              "wrapperStyle": "margin-bottom: 1.0725rem"
            },
            "nodeAPIs": [],
            "browserAPIs": [],
            "ssrAPIs": [],
            "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-responsive-iframe"
          },
          {
            "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-prismjs",
            "id": "83cfc03c-b808-589d-aa21-bdd6ebeda192",
            "name": "gatsby-remark-prismjs",
            "version": "3.1.2",
            "pluginOptions": {
              "plugins": [],
              "inlineCodeMarker": "รท"
            },
            "nodeAPIs": [],
            "browserAPIs": [],
            "ssrAPIs": [],
            "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-prismjs"
          },
          {
            "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-copy-linked-files",
            "id": "80533a5b-ad2d-50ff-af51-726674869458",
            "name": "gatsby-remark-copy-linked-files",
            "version": "2.0.7",
            "pluginOptions": {
              "plugins": [],
              "ignoreFileExtensions": [
                "png",
                "jpg",
                "jpeg",
                "bmp",
                "tiff"
              ]
            },
            "nodeAPIs": [],
            "browserAPIs": [],
            "ssrAPIs": [],
            "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-copy-linked-files"
          },
          {
            "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-smartypants",
            "id": "90305615-131b-5991-a708-2c2d1c43d946",
            "name": "gatsby-remark-smartypants",
            "version": "2.0.7",
            "pluginOptions": {
              "plugins": []
            },
            "nodeAPIs": [],
            "browserAPIs": [],
            "ssrAPIs": [],
            "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-smartypants"
          }
        ]
      },
      "nodeAPIs": [
        "onCreateNode",
        "setFieldsOnGraphQLNodeType"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-transformer-remark",
      "packageJson": {
        "name": "gatsby-transformer-remark",
        "description": "Gatsby transformer plugin for Markdown using the Remark library and ecosystem",
        "version": "2.1.15",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "markdown",
          "remark"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "gray-matter",
            "version": "^4.0.0"
          },
          {
            "name": "hast-util-raw",
            "version": "^4.0.0"
          },
          {
            "name": "hast-util-to-html",
            "version": "^4.0.0"
          },
          {
            "name": "lodash",
            "version": "^4.17.10"
          },
          {
            "name": "mdast-util-to-hast",
            "version": "^3.0.0"
          },
          {
            "name": "mdast-util-toc",
            "version": "^2.0.1"
          },
          {
            "name": "remark",
            "version": "^9.0.0"
          },
          {
            "name": "remark-parse",
            "version": "^5.0.0"
          },
          {
            "name": "remark-retext",
            "version": "^3.1.0"
          },
          {
            "name": "remark-stringify",
            "version": "^5.0.0"
          },
          {
            "name": "retext-english",
            "version": "^3.0.0"
          },
          {
            "name": "sanitize-html",
            "version": "^1.18.2"
          },
          {
            "name": "underscore.string",
            "version": "^3.3.4"
          },
          {
            "name": "unified",
            "version": "^6.1.5"
          },
          {
            "name": "unist-util-remove-position",
            "version": "^1.1.2"
          },
          {
            "name": "unist-util-select",
            "version": "^1.5.0"
          },
          {
            "name": "unist-util-visit",
            "version": "^1.3.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": "^2.0.33"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "1562254c7f8122eea54b228502c1ade2",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "4a359a36-fef3-5c49-a0f9-45c24a5fd434": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-images",
      "id": "4a359a36-fef3-5c49-a0f9-45c24a5fd434",
      "name": "gatsby-remark-images",
      "version": "2.0.6",
      "pluginOptions": {
        "plugins": [],
        "maxWidth": 590,
        "wrapperStyle": "",
        "backgroundColor": "white",
        "linkImagesToOriginal": true,
        "showCaptions": false,
        "pathPrefix": "",
        "withWebp": false
      },
      "nodeAPIs": [],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-images",
      "packageJson": {
        "name": "gatsby-remark-images",
        "description": "Processes images in markdown so they can be used in the production build.",
        "version": "2.0.6",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "image",
          "markdown",
          "remark",
          "responsive images"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "cheerio",
            "version": "^1.0.0-rc.2"
          },
          {
            "name": "is-relative-url",
            "version": "^2.0.0"
          },
          {
            "name": "lodash",
            "version": "^4.17.10"
          },
          {
            "name": "slash",
            "version": "^1.0.0"
          },
          {
            "name": "unist-util-select",
            "version": "^1.5.0"
          },
          {
            "name": "unist-util-visit-parents",
            "version": "^2.0.1"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.2"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          },
          {
            "name": "gatsby-plugin-sharp",
            "version": "^2.0.0-beta.5"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "4054764a06439c6db1a8585efb6bbe8f",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "1a3d9dbf-c3c7-50dc-9f59-97f0cf8bb163": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-responsive-iframe",
      "id": "1a3d9dbf-c3c7-50dc-9f59-97f0cf8bb163",
      "name": "gatsby-remark-responsive-iframe",
      "version": "2.0.7",
      "pluginOptions": {
        "plugins": [],
        "wrapperStyle": "margin-bottom: 1.0725rem"
      },
      "nodeAPIs": [],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-responsive-iframe",
      "packageJson": {
        "name": "gatsby-remark-responsive-iframe",
        "description": "Make iframes in Markdown processed by Remark responsive",
        "version": "2.0.7",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "remark"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "cheerio",
            "version": "^1.0.0-rc.2"
          },
          {
            "name": "lodash",
            "version": "^4.17.10"
          },
          {
            "name": "unist-util-visit",
            "version": "^1.3.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          },
          {
            "name": "remark",
            "version": "^9.0.0"
          },
          {
            "name": "unist-util-find",
            "version": "^1.0.1"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "0750beea1beab9512d3282360ef26c07",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "83cfc03c-b808-589d-aa21-bdd6ebeda192": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-prismjs",
      "id": "83cfc03c-b808-589d-aa21-bdd6ebeda192",
      "name": "gatsby-remark-prismjs",
      "version": "3.1.2",
      "pluginOptions": {
        "plugins": [],
        "inlineCodeMarker": "รท"
      },
      "nodeAPIs": [],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-prismjs",
      "packageJson": {
        "name": "gatsby-remark-prismjs",
        "description": "Adds syntax highlighting to code blocks at build time using PrismJS",
        "version": "3.1.2",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "prismjs",
          "remark"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "parse-numeric-range",
            "version": "^0.0.2"
          },
          {
            "name": "unist-util-visit",
            "version": "^1.3.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          },
          {
            "name": "prismjs",
            "version": "^1.15.0"
          },
          {
            "name": "remark",
            "version": "^9.0.0"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          },
          {
            "name": "prismjs",
            "version": "^1.15.0"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "7f7d80054d514440bf7377fbed630300",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "80533a5b-ad2d-50ff-af51-726674869458": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-copy-linked-files",
      "id": "80533a5b-ad2d-50ff-af51-726674869458",
      "name": "gatsby-remark-copy-linked-files",
      "version": "2.0.7",
      "pluginOptions": {
        "plugins": [],
        "ignoreFileExtensions": [
          "png",
          "jpg",
          "jpeg",
          "bmp",
          "tiff"
        ]
      },
      "nodeAPIs": [],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-copy-linked-files",
      "packageJson": {
        "name": "gatsby-remark-copy-linked-files",
        "description": "Find files which are linked to from markdown and copy them to the public directory",
        "version": "2.0.7",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "prismjs",
          "remark"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "cheerio",
            "version": "^1.0.0-rc.2"
          },
          {
            "name": "fs-extra",
            "version": "^4.0.1"
          },
          {
            "name": "is-relative-url",
            "version": "^2.0.0"
          },
          {
            "name": "lodash",
            "version": "^4.17.10"
          },
          {
            "name": "path-is-inside",
            "version": "^1.0.2"
          },
          {
            "name": "probe-image-size",
            "version": "^4.0.0"
          },
          {
            "name": "unist-util-visit",
            "version": "^1.3.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "ef08f89b0b76d0ed7312370543b20816",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "90305615-131b-5991-a708-2c2d1c43d946": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-smartypants",
      "id": "90305615-131b-5991-a708-2c2d1c43d946",
      "name": "gatsby-remark-smartypants",
      "version": "2.0.7",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-remark-smartypants",
      "packageJson": {
        "name": "gatsby-remark-smartypants",
        "description": "Use retext-smartypants to auto-enhance typography of markdown",
        "version": "2.0.7",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "smartypants"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "retext",
            "version": "^5.0.0"
          },
          {
            "name": "retext-smartypants",
            "version": "^3.0.0"
          },
          {
            "name": "unist-util-visit",
            "version": "^1.3.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "36d9425c7e53a69a4bf0b8f6838aecf1",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "da3d06eb-685e-5c77-ae1d-750eb6a2e4a9": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-transformer-sharp",
      "id": "da3d06eb-685e-5c77-ae1d-750eb6a2e4a9",
      "name": "gatsby-transformer-sharp",
      "version": "2.1.9",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onCreateNode",
        "setFieldsOnGraphQLNodeType",
        "onPreExtractQueries"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-transformer-sharp",
      "packageJson": {
        "name": "gatsby-transformer-sharp",
        "description": "Gatsby transformer plugin for images using Sharp",
        "version": "2.1.9",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "image",
          "sharp"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "fs-extra",
            "version": "^4.0.2"
          },
          {
            "name": "potrace",
            "version": "^2.1.1"
          },
          {
            "name": "probe-image-size",
            "version": "^4.0.0"
          },
          {
            "name": "sharp",
            "version": "^0.21.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": "^2.0.33"
          },
          {
            "name": "gatsby-plugin-sharp",
            "version": "^2.0.0-beta.3"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "0cfa5c839e14b2e4ab679d4911a6b2b8",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "84d6154d-4241-556c-a679-cc8339cac100": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-sharp",
      "id": "84d6154d-4241-556c-a679-cc8339cac100",
      "name": "gatsby-plugin-sharp",
      "version": "2.0.14",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onPreInit"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-sharp",
      "packageJson": {
        "name": "gatsby-plugin-sharp",
        "description": "Wrapper of the Sharp image manipulation library for Gatsby plugins",
        "version": "2.0.14",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "image",
          "sharp"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "async",
            "version": "^2.1.2"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "fs-exists-cached",
            "version": "^1.0.0"
          },
          {
            "name": "fs-extra",
            "version": "^7.0.0"
          },
          {
            "name": "imagemin",
            "version": "^6.0.0"
          },
          {
            "name": "imagemin-mozjpeg",
            "version": "^7.0.0"
          },
          {
            "name": "imagemin-pngquant",
            "version": "^6.0.0"
          },
          {
            "name": "imagemin-webp",
            "version": "^4.1.0"
          },
          {
            "name": "lodash",
            "version": "^4.17.10"
          },
          {
            "name": "mini-svg-data-uri",
            "version": "^1.0.0"
          },
          {
            "name": "potrace",
            "version": "^2.1.1"
          },
          {
            "name": "probe-image-size",
            "version": "^4.0.0"
          },
          {
            "name": "progress",
            "version": "^1.1.8"
          },
          {
            "name": "sharp",
            "version": "^0.21.0"
          },
          {
            "name": "svgo",
            "version": "^0.7.2"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "9fbac62876dbdc3eb1cd6d6529d2d7a7",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "74656790-483d-545c-a4b8-5b552a89d319": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-google-analytics",
      "id": "74656790-483d-545c-a4b8-5b552a89d319",
      "name": "gatsby-plugin-google-analytics",
      "version": "2.0.8",
      "pluginOptions": {
        "plugins": [],
        "trackingId": "UA-130227707-1"
      },
      "nodeAPIs": [],
      "browserAPIs": [
        "onRouteUpdate"
      ],
      "ssrAPIs": [
        "onRenderBody"
      ],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-google-analytics",
      "packageJson": {
        "name": "gatsby-plugin-google-analytics",
        "description": "Gatsby plugin to add google analytics onto a site",
        "version": "2.0.8",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "google analytics"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "fae319bb53e5a7a1c1ba6d32932c29a7",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "e1a9b6ff-843f-5a8b-b9fa-7ab223df58a2": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-feed",
      "id": "e1a9b6ff-843f-5a8b-b9fa-7ab223df58a2",
      "name": "gatsby-plugin-feed",
      "version": "2.0.10",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "onPostBuild"
      ],
      "browserAPIs": [],
      "ssrAPIs": [
        "onRenderBody"
      ],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-feed",
      "packageJson": {
        "name": "gatsby-plugin-feed",
        "description": "Creates an RSS feed for your Gatsby site.",
        "version": "2.0.10",
        "main": "index.js",
        "keywords": [
          "atom",
          "feed",
          "gatsby",
          "gatsby-plugin",
          "rss"
        ],
        "author": "Nicholas Young <nicholas@nicholaswyoung.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "lodash.merge",
            "version": "^4.6.0"
          },
          {
            "name": "mkdirp",
            "version": "^0.5.1"
          },
          {
            "name": "pify",
            "version": "^3.0.0"
          },
          {
            "name": "rss",
            "version": "^1.2.2"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "f6b9bc335a65e2134a776dbb8dfc4358",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "da8ce566-1185-5b0e-b1d5-4898dce3efa2": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-manifest",
      "id": "da8ce566-1185-5b0e-b1d5-4898dce3efa2",
      "name": "gatsby-plugin-manifest",
      "version": "2.0.11",
      "pluginOptions": {
        "plugins": [],
        "name": "Overreacted",
        "short_name": "Overreacted",
        "start_url": "/",
        "background_color": "#ffffff",
        "theme_color": "#ffa7c4",
        "display": "minimal-ui",
        "icon": "src/assets/icon.png"
      },
      "nodeAPIs": [
        "onPostBootstrap"
      ],
      "browserAPIs": [],
      "ssrAPIs": [
        "onRenderBody"
      ],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-manifest",
      "packageJson": {
        "name": "gatsby-plugin-manifest",
        "description": "Gatsby plugin which adds a manifest.webmanifest to make sites progressive web apps",
        "version": "2.0.11",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "favicon",
          "icons",
          "manifest.webmanifest",
          "progressive-web-app",
          "pwa"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "sharp",
            "version": "^0.21.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "7f39c379fc54bba19482b02179891e3e",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "1943ff2f-9c0c-558d-8d0c-006603e8106a": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-react-helmet",
      "id": "1943ff2f-9c0c-558d-8d0c-006603e8106a",
      "name": "gatsby-plugin-react-helmet",
      "version": "3.0.3",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [],
      "browserAPIs": [],
      "ssrAPIs": [
        "onRenderBody"
      ],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-react-helmet",
      "packageJson": {
        "name": "gatsby-plugin-react-helmet",
        "description": "Manage document head data with react-helmet. Provides drop-in server rendering support for Gatsby.",
        "version": "3.0.3",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "favicon",
          "react-helmet",
          "seo",
          "document",
          "head",
          "title",
          "meta",
          "link",
          "script",
          "base",
          "noscript",
          "style"
        ],
        "author": "Kyle Mathews <matthews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          },
          {
            "name": "react-helmet",
            "version": ">=5.1.3"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "fa26be7bf2cace2ba4a641ce5ebaf253",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "64059fc2-eafe-53ab-a542-ad6d70a5c7ff": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-typography",
      "id": "64059fc2-eafe-53ab-a542-ad6d70a5c7ff",
      "name": "gatsby-plugin-typography",
      "version": "2.2.2",
      "pluginOptions": {
        "plugins": [],
        "pathToConfigModule": "src/utils/typography"
      },
      "nodeAPIs": [
        "onPreBootstrap"
      ],
      "browserAPIs": [],
      "ssrAPIs": [
        "onRenderBody"
      ],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-typography",
      "packageJson": {
        "name": "gatsby-plugin-typography",
        "description": "Gatsby plugin to setup server rendering of Typography.js' CSS",
        "version": "2.2.2",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin",
          "typography",
          "typography.js"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.1.4"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          },
          {
            "name": "react-typography",
            "version": "^0.16.1 || ^1.0.0-alpha.0"
          },
          {
            "name": "typography",
            "version": "^0.16.0 || ^1.0.0-alpha.0"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "80316fd4c6e1c7768ef26a3543823a9f",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "7374ebf2-d961-52ee-92a2-c25e7cb387a9": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io",
      "id": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "name": "default-site-plugin",
      "version": "2f45c2831eb5a3c4e3e650cf120c57a8",
      "pluginOptions": {
        "plugins": []
      },
      "nodeAPIs": [
        "createPages",
        "onCreateNode"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io",
      "packageJson": {
        "name": "overreacted",
        "description": "Overreacted",
        "version": "1.0.0",
        "author": "Dan Abramov <dan.abramov@me.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "gatsby",
            "version": "^2.0.19"
          },
          {
            "name": "gatsby-plugin-feed",
            "version": "^2.0.8"
          },
          {
            "name": "gatsby-plugin-google-analytics",
            "version": "^2.0.5"
          },
          {
            "name": "gatsby-plugin-manifest",
            "version": "^2.0.5"
          },
          {
            "name": "gatsby-plugin-offline",
            "version": "^2.0.5"
          },
          {
            "name": "gatsby-plugin-react-helmet",
            "version": "^3.0.0"
          },
          {
            "name": "gatsby-plugin-sharp",
            "version": "^2.0.6"
          },
          {
            "name": "gatsby-plugin-typography",
            "version": "^2.2.0"
          },
          {
            "name": "gatsby-remark-copy-linked-files",
            "version": "^2.0.5"
          },
          {
            "name": "gatsby-remark-images",
            "version": "^2.0.4"
          },
          {
            "name": "gatsby-remark-prismjs",
            "version": "^3.0.0"
          },
          {
            "name": "gatsby-remark-responsive-iframe",
            "version": "^2.0.5"
          },
          {
            "name": "gatsby-remark-smartypants",
            "version": "^2.0.5"
          },
          {
            "name": "gatsby-source-filesystem",
            "version": "^2.0.2"
          },
          {
            "name": "gatsby-transformer-remark",
            "version": "^2.1.6"
          },
          {
            "name": "gatsby-transformer-sharp",
            "version": "^2.1.3"
          },
          {
            "name": "lodash",
            "version": "^4.17.11"
          },
          {
            "name": "prismjs",
            "version": "^1.15.0"
          },
          {
            "name": "react",
            "version": "^16.5.1"
          },
          {
            "name": "react-dom",
            "version": "^16.5.1"
          },
          {
            "name": "react-helmet",
            "version": "^5.2.0"
          },
          {
            "name": "react-typography",
            "version": "^0.16.13"
          },
          {
            "name": "typeface-merriweather",
            "version": "0.0.43"
          },
          {
            "name": "typeface-montserrat",
            "version": "0.0.43"
          },
          {
            "name": "typography",
            "version": "^0.16.17"
          },
          {
            "name": "typography-theme-wordpress-2016",
            "version": "^0.15.10"
          }
        ],
        "devDependencies": [
          {
            "name": "eslint",
            "version": "^4.19.1"
          },
          {
            "name": "eslint-plugin-react",
            "version": "^7.11.1"
          },
          {
            "name": "gh-pages",
            "version": "^1.2.0"
          },
          {
            "name": "prettier",
            "version": "^1.14.2"
          }
        ],
        "peerDependencies": [],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "7e5a7034d49d22f10f7c2728c9e0096b",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "de1454a8-036b-57ef-8599-4e481f13b079": {
      "resolve": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-page-creator",
      "id": "de1454a8-036b-57ef-8599-4e481f13b079",
      "name": "gatsby-plugin-page-creator",
      "version": "2.0.5",
      "pluginOptions": {
        "plugins": [],
        "path": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
        "pathCheck": false
      },
      "nodeAPIs": [
        "createPagesStatefully"
      ],
      "browserAPIs": [],
      "ssrAPIs": [],
      "pluginFilepath": "/Users/xuzhanhong1/study/overreacted.io/node_modules/gatsby-plugin-page-creator",
      "packageJson": {
        "name": "gatsby-plugin-page-creator",
        "description": "Gatsby plugin that automatically creates pages from React components in specified directories",
        "version": "2.0.5",
        "main": "index.js",
        "keywords": [
          "gatsby",
          "gatsby-plugin"
        ],
        "author": "Kyle Mathews <mathews.kyle@gmail.com>",
        "license": "MIT",
        "dependencies": [
          {
            "name": "@babel/runtime",
            "version": "^7.0.0"
          },
          {
            "name": "bluebird",
            "version": "^3.5.0"
          },
          {
            "name": "chokidar",
            "version": "^1.7.0"
          },
          {
            "name": "fs-exists-cached",
            "version": "^1.0.0"
          },
          {
            "name": "glob",
            "version": "^7.1.1"
          },
          {
            "name": "lodash",
            "version": "^4.17.10"
          },
          {
            "name": "micromatch",
            "version": "^3.1.10"
          },
          {
            "name": "parse-filepath",
            "version": "^1.0.1"
          },
          {
            "name": "slash",
            "version": "^1.0.0"
          }
        ],
        "devDependencies": [
          {
            "name": "@babel/cli",
            "version": "^7.0.0"
          },
          {
            "name": "@babel/core",
            "version": "^7.0.0"
          },
          {
            "name": "babel-preset-gatsby-package",
            "version": "^0.1.3"
          },
          {
            "name": "cross-env",
            "version": "^5.0.5"
          }
        ],
        "peerDependencies": [
          {
            "name": "gatsby",
            "version": ">2.0.0-alpha"
          }
        ],
        "optionalDependecies": [],
        "bundledDependecies": []
      },
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "852b28dfb0bc29cc20f3d40e9c4cb8d1",
        "type": "SitePlugin",
        "owner": "internal-data-bridge"
      }
    },
    "Site": {
      "siteMetadata": {
        "title": "้ฑ้ฆๅ็ซ็็",
        "author": "xuzhanhh",
        "description": "Personal blog by Dan Abramov. I explain with words and code.",
        "siteUrl": "https://overreacted.io",
        "social": {
          "twitter": "@gaeron"
        }
      },
      "pathPrefix": "",
      "polyfill": true,
      "buildTime": "2019-03-18T06:49:12.200Z",
      "id": "Site",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "contentDigest": "8dd2e46b906e5e1e46d6c46508852e5e",
        "type": "Site",
        "owner": "internal-data-bridge"
      }
    },
    "7f66430e-95ee-5784-9689-7e21bb30385f": {
      "id": "7f66430e-95ee-5784-9689-7e21bb30385f",
      "children": [],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "724dc3c8f1af6fe20b4ef17794f08f00",
        "type": "Directory",
        "description": "Directory \"src/pages\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "relativePath": "",
      "extension": "",
      "size": 416,
      "prettySize": "416 B",
      "modifiedTime": "2019-03-18T06:23:47.308Z",
      "accessTime": "2019-03-18T06:49:16.898Z",
      "changeTime": "2019-03-18T06:23:47.308Z",
      "birthTime": "2018-12-12T16:04:16.013Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src",
      "base": "pages",
      "ext": "",
      "name": "pages",
      "relativeDirectory": "..",
      "dev": 16777220,
      "mode": 16877,
      "nlink": 13,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4096,
      "ino": 12669793,
      "blocks": 0,
      "atimeMs": 1552891756897.5264,
      "mtimeMs": 1552890227307.5005,
      "ctimeMs": 1552890227307.5005,
      "birthtimeMs": 1544630656012.8213,
      "atime": "2019-03-18T06:49:16.898Z",
      "mtime": "2019-03-18T06:23:47.308Z",
      "ctime": "2019-03-18T06:23:47.308Z",
      "birthtime": "2018-12-12T16:04:16.013Z"
    },
    "86ce4482-5854-58cb-aa03-bcc2906a61ea": {
      "id": "86ce4482-5854-58cb-aa03-bcc2906a61ea",
      "children": [
        "55557a74-de54-5683-bd78-3de2108f3ce8"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "6f55284090486e26b4cd6f20735d0324",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/Inside Fiber.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/Inside Fiber.md",
      "relativePath": "Inside Fiber.md",
      "extension": "md",
      "size": 13216,
      "prettySize": "13.2 kB",
      "modifiedTime": "2018-12-22T07:09:07.635Z",
      "accessTime": "2019-03-18T06:22:15.910Z",
      "changeTime": "2019-03-05T06:27:19.274Z",
      "birthTime": "2018-12-14T07:01:39.661Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "Inside Fiber.md",
      "ext": ".md",
      "name": "Inside Fiber",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4096,
      "ino": 13372526,
      "blocks": 32,
      "atimeMs": 1552890135909.627,
      "mtimeMs": 1545462547634.6165,
      "ctimeMs": 1551767239274.265,
      "birthtimeMs": 1544770899660.6099,
      "atime": "2019-03-18T06:22:15.910Z",
      "mtime": "2018-12-22T07:09:07.635Z",
      "ctime": "2019-03-05T06:27:19.274Z",
      "birthtime": "2018-12-14T07:01:39.661Z"
    },
    "b767f2c2-e388-50f4-8212-63aec759cf47": {
      "id": "b767f2c2-e388-50f4-8212-63aec759cf47",
      "children": [],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "f37fda6645715a1a93b142a5f146ef35",
        "type": "File",
        "mediaType": "application/javascript",
        "description": "File \"src/pages/index.js\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/index.js",
      "relativePath": "index.js",
      "extension": "js",
      "size": 2048,
      "prettySize": "2.05 kB",
      "modifiedTime": "2018-12-12T16:13:06.021Z",
      "accessTime": "2018-12-14T06:16:16.531Z",
      "changeTime": "2018-12-12T16:13:06.021Z",
      "birthTime": "2018-12-12T16:04:16.014Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "index.js",
      "ext": ".js",
      "name": "index",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4194304,
      "ino": 12669797,
      "blocks": 8,
      "atimeMs": 1544768176531.2156,
      "mtimeMs": 1544631186021.2659,
      "ctimeMs": 1544631186021.2659,
      "birthtimeMs": 1544630656013.689,
      "atime": "2018-12-14T06:16:16.531Z",
      "mtime": "2018-12-12T16:13:06.021Z",
      "ctime": "2018-12-12T16:13:06.021Z",
      "birthtime": "2018-12-12T16:04:16.014Z"
    },
    "e8ec8119-272f-5ede-9062-62d6d04ec767": {
      "id": "e8ec8119-272f-5ede-9062-62d6d04ec767",
      "children": [
        "8b5a4b64-a89e-5d42-a386-121a4aeb1e1d"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "616fa54d30653d0e03c287fed11c416c",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/learning A Cartoon to Fiber.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/learning A Cartoon to Fiber.md",
      "relativePath": "learning A Cartoon to Fiber.md",
      "extension": "md",
      "size": 12165,
      "prettySize": "12.2 kB",
      "modifiedTime": "2018-12-12T16:31:06.351Z",
      "accessTime": "2018-12-12T16:32:27.617Z",
      "changeTime": "2018-12-12T16:31:06.351Z",
      "birthTime": "2018-11-10T12:12:19.979Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "learning A Cartoon to Fiber.md",
      "ext": ".md",
      "name": "learning A Cartoon to Fiber",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4194304,
      "ino": 12709591,
      "blocks": 24,
      "atimeMs": 1544632347616.597,
      "mtimeMs": 1544632266350.997,
      "ctimeMs": 1544632266350.997,
      "birthtimeMs": 1541851939978.5884,
      "atime": "2018-12-12T16:32:27.617Z",
      "mtime": "2018-12-12T16:31:06.351Z",
      "ctime": "2018-12-12T16:31:06.351Z",
      "birthtime": "2018-11-10T12:12:19.979Z"
    },
    "457e1448-0238-5a66-aff8-18835b352611": {
      "id": "457e1448-0238-5a66-aff8-18835b352611",
      "children": [
        "351744df-b3d1-5265-a694-9e77f722426e"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "12eafdaa95738e2270f075d7bb7f0ad0",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/react hooks@seb.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/react hooks@seb.md",
      "relativePath": "react hooks@seb.md",
      "extension": "md",
      "size": 7469,
      "prettySize": "7.47 kB",
      "modifiedTime": "2018-12-12T16:26:17.882Z",
      "accessTime": "2018-12-14T06:16:16.532Z",
      "changeTime": "2018-12-12T16:26:17.882Z",
      "birthTime": "2018-12-04T11:56:26.700Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "react hooks@seb.md",
      "ext": ".md",
      "name": "react hooks@seb",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4194304,
      "ino": 12708967,
      "blocks": 16,
      "atimeMs": 1544768176532.3567,
      "mtimeMs": 1544631977882.4976,
      "ctimeMs": 1544631977882.4976,
      "birthtimeMs": 1543924586700.4119,
      "atime": "2018-12-14T06:16:16.532Z",
      "mtime": "2018-12-12T16:26:17.882Z",
      "ctime": "2018-12-12T16:26:17.882Z",
      "birthtime": "2018-12-04T11:56:26.700Z"
    },
    "96f4be9a-0dc7-5d6a-8d1a-bdbfe6a54723": {
      "id": "96f4be9a-0dc7-5d6a-8d1a-bdbfe6a54723",
      "children": [],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "1ee54ca3bbc62ba450ac224f4f06695f",
        "type": "File",
        "mediaType": "application/javascript",
        "description": "File \"src/pages/404.js\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js",
      "relativePath": "404.js",
      "extension": "js",
      "size": 666,
      "prettySize": "666 B",
      "modifiedTime": "2018-12-12T16:04:16.013Z",
      "accessTime": "2018-12-12T16:04:16.056Z",
      "changeTime": "2018-12-12T16:04:16.013Z",
      "birthTime": "2018-12-12T16:04:16.013Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "404.js",
      "ext": ".js",
      "name": "404",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4194304,
      "ino": 12669794,
      "blocks": 8,
      "atimeMs": 1544630656056.4028,
      "mtimeMs": 1544630656012.924,
      "ctimeMs": 1544630656012.924,
      "birthtimeMs": 1544630656012.8677,
      "atime": "2018-12-12T16:04:16.056Z",
      "mtime": "2018-12-12T16:04:16.013Z",
      "ctime": "2018-12-12T16:04:16.013Z",
      "birthtime": "2018-12-12T16:04:16.013Z"
    },
    "af562c41-a48f-5b7c-b2db-cced04ba9be3": {
      "id": "af562c41-a48f-5b7c-b2db-cced04ba9be3",
      "children": [
        "d16d8354-6f61-5f1a-ad48-bd02309a1329"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "24857a13887f14cff969674681ae750c",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/Promise.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/Promise.md",
      "relativePath": "Promise.md",
      "extension": "md",
      "size": 4372,
      "prettySize": "4.37 kB",
      "modifiedTime": "2018-12-12T16:30:22.920Z",
      "accessTime": "2018-12-12T16:32:27.616Z",
      "changeTime": "2018-12-12T16:30:22.920Z",
      "birthTime": "2018-07-18T08:53:02.708Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "Promise.md",
      "ext": ".md",
      "name": "Promise",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4194304,
      "ino": 12709468,
      "blocks": 16,
      "atimeMs": 1544632347615.9578,
      "mtimeMs": 1544632222919.77,
      "ctimeMs": 1544632222919.77,
      "birthtimeMs": 1531903982708.1873,
      "atime": "2018-12-12T16:32:27.616Z",
      "mtime": "2018-12-12T16:30:22.920Z",
      "ctime": "2018-12-12T16:30:22.920Z",
      "birthtime": "2018-07-18T08:53:02.708Z"
    },
    "351744df-b3d1-5265-a694-9e77f722426e": {
      "id": "351744df-b3d1-5265-a694-9e77f722426e",
      "children": [],
      "parent": "457e1448-0238-5a66-aff8-18835b352611",
      "internal": {
        "content": "\n็ฟป่ฏ่ฟไธช [issue](https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884)\n\n## ๆณจๅฅๆจกๅ\n\nโ\tๅบๆฌไธ๏ผไบ่ฎบๅ่งฃไธบๆณ่ฆไบคๆข(swap out)ๅฎ็ฐ้ฉๅญ็ไปฃ็(the code that implements the hooks)ใ่ฟ็ฑปไผผไบไธ่ฌไพ่ตๆณจๅฅๅๆงๅถ้ฎ้ข็ๅ่ฝฌ(inversion of control problem)ใReactๆฒกๆ่ชๅทฑ็ไพ่ตๆณจๅฅ็ณป็ป๏ผไธๅไบAngular๏ผใ้ๅธธไปไธ้่ฆ่ฟไธชๅไธบๅคงๅคๆฐๅฅๅฃ้ฝๆฏpull่ไธๆฏpushใๅฏนไบๅถไปไปฃ็๏ผๆจกๅ็ณป็ปๅทฒ็ปๆไพไบ่ฏๅฅฝ็ไพ่ตๆณจๅฅ่พน็๏ผๅฏนไบๆต่ฏ๏ผๆไปฌๅพๅไบๆจ่ๅถไปๆๆฏ๏ผไพๅฆๅจๆจกๅ็ณป็ป็บงๅซ่ฟ่กๆจกๆ๏ผไพๅฆไฝฟ็จjest๏ผ\n\nโ\tไธไบไพๅคๆฏๅsetState, replaceState, isMounted, findDOMNode, batchedUpdates็ญAPI๏ผไธไธชๅฐ็ไบๅฎๆฏReactๅทฒ็ปไฝฟ็จไพ่ตๆณจๅฅๅฐโupdaterโๆๅฅๅฐComponent base classใ่ฟๆฏๆ้ๅฝๆฐ็็ฌฌไธไธชๅๆฐใ่ฏฅ็ปไปถๅฎ้ไธไธ้่ฆๅไปปไฝไบๆใ่ฟๅฐฑๆฏ่ฎฉReactๅจReact ARTๆReact Test Renderer็ญ็ธๅ็ฏๅขไธญ็ไธๅ็ๆฌไธญๅทๆๅค็งไธๅ็ฑปๅ็ๆธฒๆๅจๅฎ็ฐ็ๅๅใ ่ชๅฎไนๆธฒๆๅจๅทฒ็ปๅฉ็จไบ่ฟไธ็นใ\n\n```javascript\nimport ReactNoopUpdateQueue from './ReactNoopUpdateQueue';\n/**\n * Base class helpers for the updating state of a component.\n */\nfunction Component(props, context, updater) {\n  this.props = props;\n  this.context = context;\n  // If a component has string refs, we will assign a different object later.\n  this.refs = emptyObject;\n  // We initialize the default updater but the real one gets injected by the\n  // renderer.\n  this.updater = updater || ReactNoopUpdateQueue;\n}\n```\n\nโ\t็่ฎบไธ๏ผๅReact-clones่ฟๆท็็ฌฌไธๆนๅบๅฏไปฅไฝฟ็จupdaterๆฅๆณจๅฅไปไปฌ็ๅฎ็ฐใๅฎ่ทตไธญ๏ผๅคง้จๅๅพๅไบไฝฟ็จmodule shimmingๆฅๆฟๆขๆดไธชreactๆจกๅ๏ผๅไธบไปไปฌๆๆ่กกๆ่ๆณ่ฆๅฎ็ฐๅถไปAPI๏ผไพๅฆ๏ผ ็งป้คdevๆจกๅผๅๅฎนๆ่ๅฐbase classesๅๅฎ็ฐ็ป่ๅๅนถ๏ผ\n\nโ\t่ฟไบ้้กนไป็ถไฟ็ๅจhooks็็จๅบไธญใhooks็ๅฎ็ฐๅฎ้ไธๆฒกๆๅจreactๅไธญๅฎ็ฐ๏ผๅฎๅชๆฏ่ฐ็จๅฝๅ็โ่ฐๅบฆ็จๅบโ๏ผdispatcher๏ผใๅฐฑๅฆๆไธ้ข่งฃ้็้ฃๆท๏ผๅฏไปฅๆๆถ่ฆ็ไปปไฝ็ปๅฎ็น็ๅฎ็ฐใ่ฟๅฐฑๆฏreactๆธฒๆๅจ๏ผrenderers๏ผ่ฎฉๅคไธชๆธฒๆๅจๅฑไบซ็ธๅAPIใไพๅฆ๏ผไฝๅฏไปฅ่ฎฉไธไธช้ฉๅญๆต่ฏ่ฐๅบฆ็จๅบ๏ผhooks test dispatcher๏ผๅชๆฏไธบไบๅๅๆต่ฏhooksใ็ฎๅไปๆไธไธช็่ตทๆฅๅพๅฏๆ็ๅๅญไธ่ฟๆไปฌๅฏไปฅๅพๅฎนๅจ็ๆนๅ่ฟไธชๅ่ฏ๏ผ่ฟไธๆฏ่ฎพ่ฎก็็ผบ้ท๏ผflaw of the design๏ผใ็ฐๅจโ่ฐๅบฆ็จๅบ๏ผdispatcher๏ผโๅฏไปฅ็งปๅจๅฐ็จๆท็ฉบ้ดไธญ๏ผไฝๆฏ่ฟไผๅขๅ้ขๅค็ๅช้ณ๏ผ่ฟไบๅช้ณๅไนไปๆฅไธไธๅไธช็ปไปถ็ไฝ่็ธๅณ๏ผbut this adds additional noise for something that almost never is relevant to the author of an individual component๏ผ๏ผๅฐฑๅๅคงๅคๆฐไบบไธ็ฅ้Reactไธญ็updaterไธๆทใ\n\nโ\tๆป็ๆฅ่ฏด๏ผๆไปฌๅฏ่ฝไผไฝฟ็จๆดๅค็้ๆๅฝๆฐ่ฐ็จๅไธบไปไปฌๆด้ๅtree-shakingๅๆดๅฅฝๅฐไผๅๅๅ่ใ\n\nโ\tๅฆไธไธช้ฎ้ขๆฏhooks็ไธปๅฅๅฃๅจreactๅไธญ่ไธๆฏ็ฌฌไธๆนๅ๏ผๅจๆชๆฅๅพๆๅฏ่ฝๅถไปไปฃ็ไผ็งป้คreactๅๆไปฅhooksไผๆฏๅฉไธ็ๅคง้จๅๅๅฎน๏ผๆไปฅๅไฝ็งฏไธ้่ฆๆๅฟใๅฏไธ็้ฎ้ขๆฏhooksๅฑไบreactไธ็่ไธๆฏๆด้็จ็ใไพๅฆ๏ผVueๆพ็ป่่่ฟhooks APIใไฝๆฏhooks็ๅณ้ฎๆฏๅถๅๅฝๆฐๆไปฌๅทฒ็ปๅฎไนๅฅฝ็ใ่ฟไธVueๆๅฎๅจไธๅ็ๅๅฝๆฐใๆไปฌๅทฒ็ป่ฟญไปฃไบๆไปฌ็ๅฝๆฐใๅถไปๅบๅฏ่ฝไผๆๅบ็ฅๆไธๅ็ๅๅฝๆฐใๅจ่ฟไธ็นไธ๏ผ่ฟๆฉๅฐไฝฟ่ฟไบ่ฟไบ็ฌผ็ปๆฏๆฒกๆๆไน็ใ็ฌฌไธๆฌก่ฟญไปฃๅจreactๅไธ็ไบๅฎๅชๆฏไธบไบ่ฏดๆ่ฟๅฐฑๆฏๆไปฌๅฏนๅๅฝๆฐ็็ๆณใๅฆๆๅญๅจ้ๅ๏ผ้ฃไนๅฐฑๆฒกๆไปไน่ฝ้ปๆญขๆไปฌๅจ็ฌฌไธๆนๅฝๅๅไธไธๅถไปๅบ่ฟ่กๆดๅ๏ผๅนถๅฐๅๅบ็้ฃไบ่ฝฌๅๅฐ่ฏฅๅใ\n\n## ไพ่ตๆ็ปญ่ฐ็จ้กบๅบ\n\nโ\t่ฆๆ็กฎ็ๆฏ๏ผๆง่ก้กบๅบ็ไพ่ตๅนถไธๆฏๆไปฌ็ๆญฃๆณ่ฆ็ใ ้ฆๅๆพ็ฝฎuseStateๆuseEffectๆ็ฑปไผผ็ไธ่ฅฟๅนถไธ้่ฆใReactๆๅพๅคไพ่ตไบๆง่ก้กบๅบ็ๆจกๅผ๏ผๅชๆฏๅไธบๅจๆธฒๆไธญๅ่ฎธๅๅผ๏ผ่ฟไป็ถไฝฟๆธฒๆๆฌ่บซๅๅพ็บฏๅ๏ผใ\n\n```javascript\nlet count = 0;\n\nlet children = items.map(item => {\n  count++;\n  return <Item item={item} key={item.id} />;\n});\n\nlet header = <Header>Number of items {count}</Header>;\n```\n\nโ\tๆไธ่ฝๅจๆ็ไปฃ็ไธญๅชๆนๅchildrenๅheader็้กบๅบใ\n\nโ\thooksไธๅณๅฟไฝฟ็จ็้กบๅบ๏ผๅฎๅณ็ณปๆฏๅฆๆๆ็ปญๆฏๆฌก้ฝไธๆท็้กบๅบใ่ฟไธ่ฐ็จไน้ด้ๅซ็ไพ่ตๆง้ๅธธไธๅใ\n\nโ\tๆๅฅฝไธ่ฆไพ่ตๆไน็งฉๅบ - ๆๆไบๆ้ฝๆฏๅนณ็ญ็ใ ไฝๆฏ๏ผๆไธไบๆ่กกใ ไพๅฆใ ่ฏญๆณๅช้ณๆๅถไปไปคไบบๅฐๆ็ไบๆใ\n\nโ\tSome think that it is worth the cost for puritism reasons alone. However, some also have practical concerns.\n\n\n\n## API่ฎพ่ฎก\n\n### useReducer\n\n```javascript\nconst initialState = {count: 0};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'reset':\n      return initialState;\n    case 'increment':\n      return {count: state.count + 1};\n    case 'decrement':\n      return {count: state.count - 1};\n    default:\n      // A reducer must always return a valid state.\n      // Alternatively you can throw an error if an invalid action is dispatched.\n      return state;\n  }\n}\n\nfunction Counter({initialCount}) {\n  const [state, dispatch] = useReducer(reducer, {count: initialCount});\n  return (\n    <>\n      Count: {state.count}\n      <button onClick={() => dispatch({type: 'reset'})}>\n        Reset\n      </button>\n      <button onClick={() => dispatch({type: 'increment'})}>+</button>\n      <button onClick={() => dispatch({type: 'decrement'})}>-</button>\n    </>\n  );\n}\n```\n\n่ฟไธชไผๆฟๆขReduxๅ๏ผ่ฟๅๅ้ๅญฆไนflux็่ดๆๅ๏ผไธ่ฌๆฅ่ฏดๆฏ่ตทๅพๅคfluxๆกๆถ๏ผReducerๆฏไธไธชๆด็ญ้็็จไพ๏ผReducer้ๅธธ็ฎๅ๏ผไฝๆฏ๏ผๅฆๆไฝๅจๅญฆไนVue๏ผReason๏ผElm็ญๆกๆถ/่ฏญ่จ๏ผ่ฐๅบฆๅ้ไธญ้ป่พไปฅๅจๆด้ซ็บงๅซ็็ถๆไน้ด่ฝฌๆข็่ฟ็งไธ่ฌๆจกๅผไผผไนๅๅพไบๅทจๅคงๆๅใๅฎ่ฟ่งฃๅณไบReactไธญๅธฆๆๅ่ฐ็่ฎธๅคๆช็๏ผไธบๅคๆ็็ถๆ่ฝฌๆขๅธฆๆฅไบๆดๅค็ด่ง็่งฃๅณๆนๆกใ็นๅซๆฏๅจๅนถ่ก๏ผconcurrent๏ผ็ไธ็ไธญใ\n\nไปไปฃ็ไฝ็งฏไธ็๏ผไปไธไผๅขๅไปปไฝ้ๅฝๅๅฟ้กป็ไปฃ็๏ผไปๆฆๅฟตไธ๏ผๆ่ฎคไธบ่ฟๆฏไธไธชๅผๅพๅญฆไน็ๆฆๅฟต๏ผๅไธบ็ธๅ็ๆจกๅผไธๆญไปฅๅ็งๅฝขๅผๅบ็ฐๅจๅๅคใ ๆๅฅฝๆไธไธชไธญๅคฎAPIๆฅ็ฎก็ๅฎใ\n\nๆไปฅๆ่ฎคไธบๆฏ่ตทuseState๏ผuseReducerๆฏๆดๅๆธๅฟ็APIใไฝๆฏuseStateไพ็ถๅพๆฃๅไธบๅฏนไบ็ฎๅ็็จไพๆฅ่ฏดๅฎ้ๅธธ็ฎๆด่ไธ็ฎๆ่งฃ้๏ผไธ่ฟๅคงๅฎถๅบ่ฏฅๅฐฝๆฉ็็ฉถuseReducerๆๅถไป็ธไผผ็ๆจกๅผใ\n\nไนๅฐฑๆฏ่ฏด๏ผๅฎไนๆฒกๆๅReduxๅๅถไปFluxๆกๆถๆๅ็ๅพๅคไบๆใ้ๅธธๆ่ฎคไธบไฝไธไผ้่ฆๅฎ๏ผๆไปฅๅฎๅฏ่ฝไธๅ็ฐๅจ้ฃๆทๆฎ้ๅญๅจ๏ผไฝๅฎไป็ถๅญๅจใ\n\n### Context Provider\n\n\n\n### useEffect\n\n็ฎๅๆๅฅๆช็Hookๆฏ`useEffect`ใ้่ฆๆ็กฎ็ๆฏ๏ผ้ข่ฎก่ฟๆฏ่ฟไปไธบๆญขๆ้พไฝฟ็จ็Hook๏ผๅไธบๅฎๆญฃๅจไฝฟ็จๅฝไปคๅผไปฃ็๏ผinteroping with imperative code๏ผใๅฝไปคๅผไปฃ็ๅพ้พ็ฎก็๏ผ่ฟๅฐฑๆฏไธบไปไนๆไปฌ่ฏๅพไฟๆๅฃฐๆๅผไปฃ็ใไฝๆฏ๏ผไปๅฃฐๆๅผๅไธบๅฝไปคๅผๅพ้พ๏ผๅไธบๅฃฐๆๅผๅฏไปฅๅค็ๆดๅคไธๅ็ฑปๅ็็ถๆๅๆฏ่กไปฃ็็่ฝฌๆขใ ๅฎ็ฐๆๆๆถ๏ผ็ๆณๆๅตไธไนๅบๅค็ๆๆ่ฟไบๆๅตใ ่ฟ้็้จๅ็ฎๆๆฏ้ผๅฑๅค็ๆดๅคๆๅตใ ๅฆๆ่ฟๆทๅ๏ผ้ฃไนไธไบๆช็ๆฏๅฏไปฅ็ใ",
        "type": "MarkdownRemark",
        "contentDigest": "d8c15aa6dea77d9ed3d0484bb25af5e8",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "react hooks@seb",
        "date": "2018-12-11",
        "spoiler": "้ๆ็ฟป่ฏ๏ผๆ่งๅพdanไผ็จไบบ่ฏๅ่ฏดไธ้็ใ",
        "_PARENT": "457e1448-0238-5a66-aff8-18835b352611"
      },
      "excerpt": "",
      "rawMarkdownBody": "\n็ฟป่ฏ่ฟไธช [issue](https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884)\n\n## ๆณจๅฅๆจกๅ\n\nโ\tๅบๆฌไธ๏ผไบ่ฎบๅ่งฃไธบๆณ่ฆไบคๆข(swap out)ๅฎ็ฐ้ฉๅญ็ไปฃ็(the code that implements the hooks)ใ่ฟ็ฑปไผผไบไธ่ฌไพ่ตๆณจๅฅๅๆงๅถ้ฎ้ข็ๅ่ฝฌ(inversion of control problem)ใReactๆฒกๆ่ชๅทฑ็ไพ่ตๆณจๅฅ็ณป็ป๏ผไธๅไบAngular๏ผใ้ๅธธไปไธ้่ฆ่ฟไธชๅไธบๅคงๅคๆฐๅฅๅฃ้ฝๆฏpull่ไธๆฏpushใๅฏนไบๅถไปไปฃ็๏ผๆจกๅ็ณป็ปๅทฒ็ปๆไพไบ่ฏๅฅฝ็ไพ่ตๆณจๅฅ่พน็๏ผๅฏนไบๆต่ฏ๏ผๆไปฌๅพๅไบๆจ่ๅถไปๆๆฏ๏ผไพๅฆๅจๆจกๅ็ณป็ป็บงๅซ่ฟ่กๆจกๆ๏ผไพๅฆไฝฟ็จjest๏ผ\n\nโ\tไธไบไพๅคๆฏๅsetState, replaceState, isMounted, findDOMNode, batchedUpdates็ญAPI๏ผไธไธชๅฐ็ไบๅฎๆฏReactๅทฒ็ปไฝฟ็จไพ่ตๆณจๅฅๅฐโupdaterโๆๅฅๅฐComponent base classใ่ฟๆฏๆ้ๅฝๆฐ็็ฌฌไธไธชๅๆฐใ่ฏฅ็ปไปถๅฎ้ไธไธ้่ฆๅไปปไฝไบๆใ่ฟๅฐฑๆฏ่ฎฉReactๅจReact ARTๆReact Test Renderer็ญ็ธๅ็ฏๅขไธญ็ไธๅ็ๆฌไธญๅทๆๅค็งไธๅ็ฑปๅ็ๆธฒๆๅจๅฎ็ฐ็ๅๅใ ่ชๅฎไนๆธฒๆๅจๅทฒ็ปๅฉ็จไบ่ฟไธ็นใ\n\n```javascript\nimport ReactNoopUpdateQueue from './ReactNoopUpdateQueue';\n/**\n * Base class helpers for the updating state of a component.\n */\nfunction Component(props, context, updater) {\n  this.props = props;\n  this.context = context;\n  // If a component has string refs, we will assign a different object later.\n  this.refs = emptyObject;\n  // We initialize the default updater but the real one gets injected by the\n  // renderer.\n  this.updater = updater || ReactNoopUpdateQueue;\n}\n```\n\nโ\t็่ฎบไธ๏ผๅReact-clones่ฟๆท็็ฌฌไธๆนๅบๅฏไปฅไฝฟ็จupdaterๆฅๆณจๅฅไปไปฌ็ๅฎ็ฐใๅฎ่ทตไธญ๏ผๅคง้จๅๅพๅไบไฝฟ็จmodule shimmingๆฅๆฟๆขๆดไธชreactๆจกๅ๏ผๅไธบไปไปฌๆๆ่กกๆ่ๆณ่ฆๅฎ็ฐๅถไปAPI๏ผไพๅฆ๏ผ ็งป้คdevๆจกๅผๅๅฎนๆ่ๅฐbase classesๅๅฎ็ฐ็ป่ๅๅนถ๏ผ\n\nโ\t่ฟไบ้้กนไป็ถไฟ็ๅจhooks็็จๅบไธญใhooks็ๅฎ็ฐๅฎ้ไธๆฒกๆๅจreactๅไธญๅฎ็ฐ๏ผๅฎๅชๆฏ่ฐ็จๅฝๅ็โ่ฐๅบฆ็จๅบโ๏ผdispatcher๏ผใๅฐฑๅฆๆไธ้ข่งฃ้็้ฃๆท๏ผๅฏไปฅๆๆถ่ฆ็ไปปไฝ็ปๅฎ็น็ๅฎ็ฐใ่ฟๅฐฑๆฏreactๆธฒๆๅจ๏ผrenderers๏ผ่ฎฉๅคไธชๆธฒๆๅจๅฑไบซ็ธๅAPIใไพๅฆ๏ผไฝๅฏไปฅ่ฎฉไธไธช้ฉๅญๆต่ฏ่ฐๅบฆ็จๅบ๏ผhooks test dispatcher๏ผๅชๆฏไธบไบๅๅๆต่ฏhooksใ็ฎๅไปๆไธไธช็่ตทๆฅๅพๅฏๆ็ๅๅญไธ่ฟๆไปฌๅฏไปฅๅพๅฎนๅจ็ๆนๅ่ฟไธชๅ่ฏ๏ผ่ฟไธๆฏ่ฎพ่ฎก็็ผบ้ท๏ผflaw of the design๏ผใ็ฐๅจโ่ฐๅบฆ็จๅบ๏ผdispatcher๏ผโๅฏไปฅ็งปๅจๅฐ็จๆท็ฉบ้ดไธญ๏ผไฝๆฏ่ฟไผๅขๅ้ขๅค็ๅช้ณ๏ผ่ฟไบๅช้ณๅไนไปๆฅไธไธๅไธช็ปไปถ็ไฝ่็ธๅณ๏ผbut this adds additional noise for something that almost never is relevant to the author of an individual component๏ผ๏ผๅฐฑๅๅคงๅคๆฐไบบไธ็ฅ้Reactไธญ็updaterไธๆทใ\n\nโ\tๆป็ๆฅ่ฏด๏ผๆไปฌๅฏ่ฝไผไฝฟ็จๆดๅค็้ๆๅฝๆฐ่ฐ็จๅไธบไปไปฌๆด้ๅtree-shakingๅๆดๅฅฝๅฐไผๅๅๅ่ใ\n\nโ\tๅฆไธไธช้ฎ้ขๆฏhooks็ไธปๅฅๅฃๅจreactๅไธญ่ไธๆฏ็ฌฌไธๆนๅ๏ผๅจๆชๆฅๅพๆๅฏ่ฝๅถไปไปฃ็ไผ็งป้คreactๅๆไปฅhooksไผๆฏๅฉไธ็ๅคง้จๅๅๅฎน๏ผๆไปฅๅไฝ็งฏไธ้่ฆๆๅฟใๅฏไธ็้ฎ้ขๆฏhooksๅฑไบreactไธ็่ไธๆฏๆด้็จ็ใไพๅฆ๏ผVueๆพ็ป่่่ฟhooks APIใไฝๆฏhooks็ๅณ้ฎๆฏๅถๅๅฝๆฐๆไปฌๅทฒ็ปๅฎไนๅฅฝ็ใ่ฟไธVueๆๅฎๅจไธๅ็ๅๅฝๆฐใๆไปฌๅทฒ็ป่ฟญไปฃไบๆไปฌ็ๅฝๆฐใๅถไปๅบๅฏ่ฝไผๆๅบ็ฅๆไธๅ็ๅๅฝๆฐใๅจ่ฟไธ็นไธ๏ผ่ฟๆฉๅฐไฝฟ่ฟไบ่ฟไบ็ฌผ็ปๆฏๆฒกๆๆไน็ใ็ฌฌไธๆฌก่ฟญไปฃๅจreactๅไธ็ไบๅฎๅชๆฏไธบไบ่ฏดๆ่ฟๅฐฑๆฏๆไปฌๅฏนๅๅฝๆฐ็็ๆณใๅฆๆๅญๅจ้ๅ๏ผ้ฃไนๅฐฑๆฒกๆไปไน่ฝ้ปๆญขๆไปฌๅจ็ฌฌไธๆนๅฝๅๅไธไธๅถไปๅบ่ฟ่กๆดๅ๏ผๅนถๅฐๅๅบ็้ฃไบ่ฝฌๅๅฐ่ฏฅๅใ\n\n## ไพ่ตๆ็ปญ่ฐ็จ้กบๅบ\n\nโ\t่ฆๆ็กฎ็ๆฏ๏ผๆง่ก้กบๅบ็ไพ่ตๅนถไธๆฏๆไปฌ็ๆญฃๆณ่ฆ็ใ ้ฆๅๆพ็ฝฎuseStateๆuseEffectๆ็ฑปไผผ็ไธ่ฅฟๅนถไธ้่ฆใReactๆๅพๅคไพ่ตไบๆง่ก้กบๅบ็ๆจกๅผ๏ผๅชๆฏๅไธบๅจๆธฒๆไธญๅ่ฎธๅๅผ๏ผ่ฟไป็ถไฝฟๆธฒๆๆฌ่บซๅๅพ็บฏๅ๏ผใ\n\n```javascript\nlet count = 0;\n\nlet children = items.map(item => {\n  count++;\n  return <Item item={item} key={item.id} />;\n});\n\nlet header = <Header>Number of items {count}</Header>;\n```\n\nโ\tๆไธ่ฝๅจๆ็ไปฃ็ไธญๅชๆนๅchildrenๅheader็้กบๅบใ\n\nโ\thooksไธๅณๅฟไฝฟ็จ็้กบๅบ๏ผๅฎๅณ็ณปๆฏๅฆๆๆ็ปญๆฏๆฌก้ฝไธๆท็้กบๅบใ่ฟไธ่ฐ็จไน้ด้ๅซ็ไพ่ตๆง้ๅธธไธๅใ\n\nโ\tๆๅฅฝไธ่ฆไพ่ตๆไน็งฉๅบ - ๆๆไบๆ้ฝๆฏๅนณ็ญ็ใ ไฝๆฏ๏ผๆไธไบๆ่กกใ ไพๅฆใ ่ฏญๆณๅช้ณๆๅถไปไปคไบบๅฐๆ็ไบๆใ\n\nโ\tSome think that it is worth the cost for puritism reasons alone. However, some also have practical concerns.\n\n\n\n## API่ฎพ่ฎก\n\n### useReducer\n\n```javascript\nconst initialState = {count: 0};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'reset':\n      return initialState;\n    case 'increment':\n      return {count: state.count + 1};\n    case 'decrement':\n      return {count: state.count - 1};\n    default:\n      // A reducer must always return a valid state.\n      // Alternatively you can throw an error if an invalid action is dispatched.\n      return state;\n  }\n}\n\nfunction Counter({initialCount}) {\n  const [state, dispatch] = useReducer(reducer, {count: initialCount});\n  return (\n    <>\n      Count: {state.count}\n      <button onClick={() => dispatch({type: 'reset'})}>\n        Reset\n      </button>\n      <button onClick={() => dispatch({type: 'increment'})}>+</button>\n      <button onClick={() => dispatch({type: 'decrement'})}>-</button>\n    </>\n  );\n}\n```\n\n่ฟไธชไผๆฟๆขReduxๅ๏ผ่ฟๅๅ้ๅญฆไนflux็่ดๆๅ๏ผไธ่ฌๆฅ่ฏดๆฏ่ตทๅพๅคfluxๆกๆถ๏ผReducerๆฏไธไธชๆด็ญ้็็จไพ๏ผReducer้ๅธธ็ฎๅ๏ผไฝๆฏ๏ผๅฆๆไฝๅจๅญฆไนVue๏ผReason๏ผElm็ญๆกๆถ/่ฏญ่จ๏ผ่ฐๅบฆๅ้ไธญ้ป่พไปฅๅจๆด้ซ็บงๅซ็็ถๆไน้ด่ฝฌๆข็่ฟ็งไธ่ฌๆจกๅผไผผไนๅๅพไบๅทจๅคงๆๅใๅฎ่ฟ่งฃๅณไบReactไธญๅธฆๆๅ่ฐ็่ฎธๅคๆช็๏ผไธบๅคๆ็็ถๆ่ฝฌๆขๅธฆๆฅไบๆดๅค็ด่ง็่งฃๅณๆนๆกใ็นๅซๆฏๅจๅนถ่ก๏ผconcurrent๏ผ็ไธ็ไธญใ\n\nไปไปฃ็ไฝ็งฏไธ็๏ผไปไธไผๅขๅไปปไฝ้ๅฝๅๅฟ้กป็ไปฃ็๏ผไปๆฆๅฟตไธ๏ผๆ่ฎคไธบ่ฟๆฏไธไธชๅผๅพๅญฆไน็ๆฆๅฟต๏ผๅไธบ็ธๅ็ๆจกๅผไธๆญไปฅๅ็งๅฝขๅผๅบ็ฐๅจๅๅคใ ๆๅฅฝๆไธไธชไธญๅคฎAPIๆฅ็ฎก็ๅฎใ\n\nๆไปฅๆ่ฎคไธบๆฏ่ตทuseState๏ผuseReducerๆฏๆดๅๆธๅฟ็APIใไฝๆฏuseStateไพ็ถๅพๆฃๅไธบๅฏนไบ็ฎๅ็็จไพๆฅ่ฏดๅฎ้ๅธธ็ฎๆด่ไธ็ฎๆ่งฃ้๏ผไธ่ฟๅคงๅฎถๅบ่ฏฅๅฐฝๆฉ็็ฉถuseReducerๆๅถไป็ธไผผ็ๆจกๅผใ\n\nไนๅฐฑๆฏ่ฏด๏ผๅฎไนๆฒกๆๅReduxๅๅถไปFluxๆกๆถๆๅ็ๅพๅคไบๆใ้ๅธธๆ่ฎคไธบไฝไธไผ้่ฆๅฎ๏ผๆไปฅๅฎๅฏ่ฝไธๅ็ฐๅจ้ฃๆทๆฎ้ๅญๅจ๏ผไฝๅฎไป็ถๅญๅจใ\n\n### Context Provider\n\n\n\n### useEffect\n\n็ฎๅๆๅฅๆช็Hookๆฏ`useEffect`ใ้่ฆๆ็กฎ็ๆฏ๏ผ้ข่ฎก่ฟๆฏ่ฟไปไธบๆญขๆ้พไฝฟ็จ็Hook๏ผๅไธบๅฎๆญฃๅจไฝฟ็จๅฝไปคๅผไปฃ็๏ผinteroping with imperative code๏ผใๅฝไปคๅผไปฃ็ๅพ้พ็ฎก็๏ผ่ฟๅฐฑๆฏไธบไปไนๆไปฌ่ฏๅพไฟๆๅฃฐๆๅผไปฃ็ใไฝๆฏ๏ผไปๅฃฐๆๅผๅไธบๅฝไปคๅผๅพ้พ๏ผๅไธบๅฃฐๆๅผๅฏไปฅๅค็ๆดๅคไธๅ็ฑปๅ็็ถๆๅๆฏ่กไปฃ็็่ฝฌๆขใ ๅฎ็ฐๆๆๆถ๏ผ็ๆณๆๅตไธไนๅบๅค็ๆๆ่ฟไบๆๅตใ ่ฟ้็้จๅ็ฎๆๆฏ้ผๅฑๅค็ๆดๅคๆๅตใ ๅฆๆ่ฟๆทๅ๏ผ้ฃไนไธไบๆช็ๆฏๅฏไปฅ็ใ",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/react hooks@seb.md",
      "fields": {
        "slug": "/react hooks@seb/"
      }
    },
    "8b5a4b64-a89e-5d42-a386-121a4aeb1e1d": {
      "id": "8b5a4b64-a89e-5d42-a386-121a4aeb1e1d",
      "children": [],
      "parent": "e8ec8119-272f-5ede-9062-62d6d04ec767",
      "internal": {
        "content": "\n## ่ฟ้ๆ่ฟๆฒกๅๅฎ\n\n![image-20181110201732613](/Users/xuzhanhong1/Documents/image-20181110201732613.png)\n\n\n\n![image-20181110202214457](/Users/xuzhanhong1/Documents/image-20181110202214457.png)\n\n\n\n![image-20181110203945805](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110203945805.png)\n\n## stack reconciler็็ผบ็น\n\nโ\tๅจๆไปฌๆง่กupdateๆไฝไนๅๆไปฌๅทฒ็ปๆไธไธชๅจๅๅงrenderๆถๅทฒ็ปๆ้ๅฅฝ็fiberๆ๏ผreactไนไผๅผๅงwork-in-progressๆๅนถๆทปๅ็ฌฌไธไธชfiber่็น๏ผๅไธบๆไปฌไธๆณๅฝๆไปฌ่ฎก็ฎๅๅจๆถ็ดๆฅไฟฎๆนdom๏ผ่ฟไธช่ทstack reconcilerไธไธๆท๏ผstack reconcilerๅจๅพไธ่ตฐๆนๅๅฎไพๆถๅๆถๆนๅจๅฝๅ็dom่็นใ\n\nโ\tไพๅฆๅจๅฐๅฎไพ2ๅๆ4ๆถ๏ผๅๆถไนไผๆนๅจdom nodeไป2ๅฐ4ๅจreact่ฎก็ฎ็ฌฌไธไธชๅฎไพๅบ่ฏฅไป3ๅๅฐ9ๅใ\n\n![image-20181110204749728](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110204749728.png)\n\n่ฟๆทๅญๆฏๅฏ่ก็ๅฆๆไฝไธๆฌกๆงๅๆญฅๅฐๅฎๆๆๆไบๆใๅฆๆไฝ้่ฆๅจไธคไธชๅฎไพ้ดๆๆญๆถ๏ผๆต่งๅจ้่ฆๆถ้ดpaintๅlayout๏ผไฝๆฏๅชๆ2ๅๆ4่3ๆฒกๆๅๆ9๏ผ่ฟๆทไฝ็uiๅฐฑไผๅๅพไธ่ฟ็ปญใ\n\n\n\n## fiber phases\n\n็ฌฌไธไธช้ถๆฎต๏ผreactๅชไผๆๅปบfiber treeๅwork-in-progress treeๅๅๅจๅ่กจ๏ผๅฏไธญๆญ๏ผ\n\n็ฌฌไบ้ถๆฎต๏ผๅฐ่ฟไบๅๅจไฝ็จๅฐdomไธ๏ผไธๅฏไธญๆญ๏ผ\n\n![image-20181110205919129](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110210012223.png)\n\n\n\n## ้ถๆฎต1\n\n1. ๅฝๆไปฌ็นๅปๆ้ฎๆถ่งฆๅไบsetState\n\n![image-20181110210205135](/Users/xuzhanhong1/Documents/image-20181110210205135.png)\n\n2. ๅฝsetState่ขซ่ฐ็จๆถ๏ผreactไผๆทปๅList็ปไปถไธ็ณปๅๆดๆฐๆทปๅๅฐๆดๆฐ้ๅไธญ๏ผ็ถๅreactไผๅผๅง่ฐๅบฆ่ฟไบๅทฅไฝ![image-20181110210528429](/Users/xuzhanhong1/Documents/image-20181110210528429.png)\n\n3. ไฝฟ็จrequest idle callbackๅปๅปถ่ฟๅฎๆ่ฟไบๅทฅไฝ \n\n   ![image-20181110210741530](/Users/xuzhanhong1/Documents/image-20181110210741530.png)\n\n   ๅฝไธป็บฟ็จๆ็ฉบ้ฒๆถ้ดๆถไผๆๅทไฝๅฉไฝๆถ้ด็ปreact๏ผๅทไฝๅๆฏซ็งๅฐๅๅๆฏซ็ง๏ผๅฝๆ่ฟ็ๅฐๆฅๆฒกๆframe scheduledๆถ๏ผ\n\n   ![image-20181110211003501](/Users/xuzhanhong1/Documents/image-20181110211003501.png)\n\n   โ\t่ฟๆทreactๅฏไปฅไฝฟ็จ่ฟไบๅฉไฝๆถ้ดๅค็ๆดๆฐๅนถๅฝๅถไปๅทฅไฝ้่ฆๅค็ๆถๅฐๆถ้ด่ฟ็ปไธป็บฟ็จใ่ฟๆท็ๆไฝ้่ฆ่ท่ธชไธคไธชๆถ้ด๏ผnext unit of work that it needs to work on ๅ ไธป็บฟ็จ็ปไธ็ๅฉไฝๆถ้ด\n\n   ![image-20181110211302791](/Users/xuzhanhong1/Documents/image-20181110211302791.png)\n\n4. ไปcurrentๅคๅถHostRoot็ๆฐๆฎๅฐworkInProgress tree ๅนถๆทปๅไธไธชๆ้ๆๅๅฟๅญ๏ผList๏ผ\n\n   ![image-20181110211949517](/Users/xuzhanhong1/Documents/image-20181110211949517.png)\n\n5. ๅไธบListๆฌ่บซๆฒกๆๆดๆฐ๏ผๆไปฅๅฐListๅคๅถๅฐworkInProgress treeใๅนถไธListๆๆดๆฐ้ๅ๏ผๆไปฅไนไผๅคๅถupdate Queueใ\n\n   ![image-20181110212258539](/Users/xuzhanhong1/Documents/image-20181110212258539.png)\n\n6. ๆไปฅList fiber is going to be returned as the next unit of work![image-20181110212347964](/Users/xuzhanhong1/Documents/image-20181110212347964.png)\n\n7. React ไผๆฃๆฅdeadlineๆฏๅฆๅฐๆฅใๅไธบ่ฟๆๅฉไฝ็ๆถ้ด๏ผreactไผ็ปง็ปญๅค็List![image-20181110212645386](/Users/xuzhanhong1/Documents/image-20181110212645386.png)\n\n8. ๅไธบListๆๆดๆฐ้ๅ๏ผๆไปฅreactไผๅค็่ฟไบๆดๆฐ๏ผไปไผ่ฐ็จupdaterๅฝๆฐ๏ผไธไผๅฏน่ฑก็setStateไปฅๅ็ๆไธช็ๆฌ่ขซ็งป้ค![image-20181110212849733](/Users/xuzhanhong1/Documents/image-20181110212849733.png)ๅนถ็ปๆๅค็ๆดๆฐ้ๅ๏ผfiberไผๆ่ฎฐไธไธชtag่กจ็คบไปไผไฟฎๆนdomๆ![image-20181110213110874](/Users/xuzhanhong1/Documents/image-20181110213110874.png)\n\n9. ๅจ็ปง็ปญๅพไธๅค็ๅ๏ผๆไปฌ้่ฆ็ฅ้List็children๏ผๆไปฅreactไผๅจListๅฎไพ่ฎพ็ฝฎpropsๅstateๅนถ่ฐ็จrender๏ผๆไปฌไผๅพๅฐไธไธชๆฐ็ป็ๅ็ดใreactไผ้ๅ่ฟไบๅ็ดๅปๅคๆญๅจcurrent treeไธญๆฏๅฆๆๅฏไปฅ้็จ็fiberใๅฆๆๆ๏ผๅ็ดๆฅๅคๅถ\n\n   ![image-20181110213813900](/Users/xuzhanhong1/Documents/image-20181110213813900.png)\n\n   ![image-20181110213944644](/Users/xuzhanhong1/Documents/image-20181110213944644.png)\n\n10. ็ถๅไผ่ฟๅList็็ฌฌไธไธชchild buttonไฝไธบไธไธไธชunit of work, ็ถๅreactไผๅๅฐwork loopๅนถๆฃๆฅdeadlineใ![image-20181110214543420](/Users/xuzhanhong1/Documents/image-20181110214543420.png)![image-20181110214728829](/Users/xuzhanhong1/Documents/image-20181110214728829.png)\n\n11. ่ฟไธชๆถๅ็จๆทๆณๆไบๆ๏ผ็นๅปๆพๅคงๅญไฝๆ้ฎๅปๆนๅwebๅญไฝๅคงๅฐ![image-20181110214856489](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110214856489.png)\n\n12. ่ฟๆทไผๅฏผ่ด็ป้ๅไธญ็ไธไบไธ่ฅฟๆทปๅไบไธไธชๅ่ฐ๏ผไธป็บฟ็จ้่ฆๅปๅณๅฟ็๏ผไฝๆฏไธๆฏ้ฉฌไธๅไธบreactไป็ถๆๆถ้ด็ปง็ปญๅค็next unit of work -- buttonใbuttonๆฏๆไปฌ็ฌฌไธไธช้ๅฐ็ๆฒกๆๅญฉๅญ็ๅ็ด๏ผๆไปฅไปไธไผๅๅปบๆฐ็ๅทฅไฝใๆไปฅreactๅฏไปฅๅฎๆ่ฟไธชๅไฝ็ๅทฅไฝ๏ผ่ฟๆๅณ็ๆฏ่พๆฐๆงๅ็ดๆฅ็ๆฏๅฆๆๅๅจ๏ผๅฆๆๆๅๅจ้่ฆๅๅจdomๅไผๆ่ฎฐใ็ถๅๅไธบbuttonๆฒกๆๅญฉๅญ๏ผๆไปฅไผ่ฟๅ้ปๅฑไฝไธบไธไธไธชๅไฝ็ๅทฅไฝ![image-20181110215513582](/Users/xuzhanhong1/Documents/image-20181110215513582.png)\n\n13. reactไผ็ปๆ่ฟไธชๅๅ็ๅทฅไฝๅนถๅๅฐwork loopไธญๆฃๆฅdeadline![image-20181110215657530](/Users/xuzhanhong1/Documents/image-20181110215657530.png)\n\n14. itemไธญๆsCU๏ผๅนถไธๅไธบsCU่ฟๅfalseๆไปฅitem1ไธ้่ฆๅฏนdom่ฟ่กไฟฎๆน๏ผๆไปฅไธ้่ฆๆๆ็ญพใ็ถๅ้ปๅฑไฝไธบไธไธไธชๅๅ็ๅทฅไฝใๅๆทๅฐ๏ผreactๅๅฐwork loopๆฃๆฅdeadlineๅนถๅๆฅ![image-20181110215823086](/Users/xuzhanhong1/Documents/image-20181110215823086.png)\n\n15. ็ฌฌไบไธชitem็sCU่ฟๅtrue๏ผๆไปฅไผ่ขซๆ่ฎฐไธบๆๆดๅ๏ผ็ถๅไป็divไผ่ขซๅคๅถ่ฟๆฅ๏ผๅนถไธๅฐdiv่ฟๅไฝไธบไธไธไธชๅๅ็ๅทฅไฝ \n    ![image-20181110220630861](/Users/xuzhanhong1/Documents/image-20181110220630861.png)![image-20181110220704324](/Users/xuzhanhong1/Documents/image-20181110220704324.png)\n\n    \n\n16.  ๅไธบๆไปฌ่ฟๆไธไธขไธขๆถ้ดๆไปฅๆไปฌๅๅคๅค็่ฟไธชdiv๏ผๅไธบ่ฟไธชdivๆฒกๆchildrenๆไปฅๆไปฌๅฏไปฅๅฎๆๅฎ๏ผๆไปฌๅ็ฐ่ฟไธชdiv็ๅๅฎนๅๆดไบ๏ผๆไปฅๆไปฌ็ปไปๆไธๆ่ฎฐ\n    ![image-20181110222222665](/Users/xuzhanhong1/Documents/image-20181110222423364.png)\n\n17. ๅไธบๅฝๅๆฒกๆ้ปๅฑไนๆฒกๆchildren๏ผๆฒกๆไธไธชๅๅ็ๅทฅไฝ๏ผๆไปฅไผ่ฐ็จไป็ถไบฒ็complete๏ผๅนถไธ่ฟๆฏๆไปฌ็ฌฌไธๆฌกๅฐๅๅจๆทปๅๅฐไธไธชๅ่กจ๏ผๅไธบไปๆtagไธๅฎๆไบ(completed)ใ\n    ![image-20181110224035848](/Users/xuzhanhong1/Documents/image-20181110224035848.png)\n\n18. ่ฟไธชๆถๅitemไนๅฎๆไบ(complated)ๅนถไธไปไนๆไธไธชtagใso it's going to move itself up to it's going to start creating this list of changes on its parent. It merge its own list of changes into the parents effect list\n\n19. itemไผๅฐdiv็ๅๅจๆพๅฐeffect list็็ฌฌไธไธช๏ผ็ถๅๅฐ่ชๅทฑๆพๅฐeffect list็ๆซๅฐพ\n    ![image-20181110224526544](/Users/xuzhanhong1/Documents/image-20181110224526544.png)\n\n20. ็ฌฌไบไธชitem complete ๅนถ่ฟๅ้ปๅฑไฝไธบไธไธไธชๅๅ็ๅทฅไฝ![image-20181110224637609](/Users/xuzhanhong1/Documents/image-20181110224637609.png)\n\n    ่ฟๅwork loop๏ผreactๅ็ฐdeadlineๅทฒ็ปๅฐไบใๆไปฅreactไผ้ๆพ่ตๆบๅนถ่ฎฉไธป็บฟ็จๅค็ๅถไปไปปๅก\n\n    ![image-20181110224810666](/Users/xuzhanhong1/Documents/image-20181110224810666.png)\n\n    reactไป็ถ้่ฆ็ปง็ปญๅฎๆไปปๅก๏ผๆไปฅไฝฟ็จrIC่ฎฉไธป็บฟ็จๅฎๆๅทฅไฝๅ็ปง็ปญ่ฐ็จreact\n\n    ![image-20181110224939741](/Users/xuzhanhong1/Documents/image-20181110224939741.png)\n\n    ็ถๅไธป็บฟ็จไผๅปๅค็็ญๅพไธญ็callback๏ผๅจ่ฟไธชไพๅญไธญๆฏlayout\n\n    ![image-20181110225030973](/Users/xuzhanhong1/Documents/image-20181110225030973.png)\n\n    ไธ่ฟๆณจๆๅฐnothing in the content of our react app is changed even though react note says going to need to change two to four ๅจๅฐๆฅ็ๆไธชๆถ้ด๏ผ่ไธๆฏ็ฐๅจใ\n\n    \n\n21. main thread ๅค็ๅฎๅถไปไบๆไผ็ปง็ปญ่ฐ็จreact๏ผๆๅไธคไธชๅๅๅทฅไฝๅ็ฌฌไบไธชitemไธๆท\n\n    ![image-20181110225617532](/Users/xuzhanhong1/Documents/image-20181110225617532.png)\n    ![image-20181110225632116](/Users/xuzhanhong1/Documents/image-20181110225632116.png)\n\nๅณๅฎๆไบListไธ้ข็ๆๆๅๅๅทฅไฝ๏ผๆไปฅListๅฏไปฅ่ฐ็จcomplete๏ผๅนถๅฐ่ชๅทฑๅๅญฉๅญ็ๆดๅๆพๅฐeffect listไธญ๏ผ็ถๅHostRootไนๅฎๆไบ\n![image-20181110225715325](/Users/xuzhanhong1/Documents/image-20181110230128716.png)\n![image-20181110225807413](/Users/xuzhanhong1/Documents/image-20181110225807413.png)\n\n\n\n22. reactไผๅฐwork-in-progress tree่ฎพๆpending commit๏ผ่ฟๆๅณ็็ฌฌไธไธช้ถๆฎต็ปๆไบใๆไปฌๆดๆฐไบwork-in-progress treeๅๆๅบไบๅๅจๅ่กจ\n\n\n\n## ้ถๆฎต2\n\n1. react ไผๆฃๆฅdeadlineๅคๆญๆฏๅฆๆๆถ้ด็ซๅปๆง่กcommit๏ผๅฆๆไธๅคๅๅจrICๅ็ฌฌไธๆถ้ดcommit่ฟไธชpending commit![image-20181110230504330](/Users/xuzhanhong1/Documents/image-20181110230504330.png)\n2. reactไผ้ๅeffect listๅนถๅบ่ฏฅๆดๅๅฐdomไธ๏ผไป็ฌฌไธไธชfiberๅผๅง\n\n![image-20181110230821602](/Users/xuzhanhong1/Documents/image-20181110230821602.png)\n![image-20181110230855909](/Users/xuzhanhong1/Documents/image-20181110230855909.png)\n![image-20181110230913246](/Users/xuzhanhong1/Documents/image-20181110230913246.png)\nitemๆฒกๆไปปไฝๆนๅ๏ผๅไธบๆไปฌไธไฝฟ็จref๏ผไธ่ฟๅฆๆๆไปฌๅจitemไธญๆref will be detached now and then it would be reattached later\n![image-20181110231153619](/Users/xuzhanhong1/Documents/image-20181110231153619.png)\n![image-20181110231121156](/Users/xuzhanhong1/Documents/image-20181110231121156.png)\n็ฐๅจๆๆๅๅจ้ฝๅจ็ฌฌไธ้ถๆฎต่ฎก็ฎๅฎๆฏๅนถcommitๅฐdomๆใ่ฟๆๅณ็work-in-progress tree is actually a more up-to-date version of state of the app than the current tree๏ผๆไปฅreact้่ฆไฟฎๅคcurrent treeใไปไผๅๆขๆ้๏ผๆไปฅๅฝๅๆ้ๆๅๆไปฌๅๆๅปบ็work-in-pregress tree\n![image-20181110231429089](/Users/xuzhanhong1/Documents/image-20181110231429089.png)\n![image-20181110231630674](/Users/xuzhanhong1/Documents/image-20181110231630674.png)\n่ฟๆๅณ็reactๅฏไปฅๅจwork-in-progress treeไธญ้็จๆงๅฏน่ฑก๏ผๅช้่ฆๅจไธๆฌกๆๅปบไธญwork-in-progress treeๅคๅถkey valueใ่ฟๅซdouble buffering๏ผๅฏไปฅๅจๅๅญๅ้ๅgcไธญ่็ๆถ้ด๏ผ็ฐๅจreactๅฎๆไบ่ฟๆฌก็commit๏ผๅนถๆง่กๅฉไธ็lifecycle hooksๅๆดๆฐไปปไฝrefsๅนถๅค็error boundaries\n![image-20181110232043775](/Users/xuzhanhong1/Documents/image-20181110232043775.png)\n\n## ไผๅ็บง\n\n```javascript\n{\n    \"Synchronous\": \"same as stack rec\",\n    \"Task\": \"before next tick\",\n    \"Animation\": \"before next frame\",\n     \"rIC\":{\n        \t\"High\":\"pretty soon\",\n            \"Low\":\"ๅฆๆฐๆฎ่ทๅ๏ผๅฏน100or200msไธๆๆ\",\n\t\t\t\"Offscreen\": \"prep for display/scroll\"\n        }\n}\n```\n\n้ซไผๅ็บง็ไปปๅกไผ็ซๅปๆง่ก๏ผๅฐฝ็ฎก็ฐๅจๅทฒ็ปๅผๅงไบไฝไผๅ็บง็ไปปๅก\n\n![image-20181110232753533](/Users/xuzhanhong1/Documents/image-20181110232753533.png)\n\nๅๅฐไนๅๆไปฌๆไบๆ็ๅฐๆน๏ผๅฆๆๆไปฌๆไธไธช็ดงๆฅ็font resize button\n![image-20181110233032279](/Users/xuzhanhong1/Documents/image-20181110233032279.png)\n\n็จๆท็นๅปๅไผๆพ็ฝฎไธไธชcallbackๅฐไธป็บฟ็จๅค็้ๅไธญ\n\n\n\n\n\n\n\n## lifecycle hook during the phase\n\n![image-20181111143014786](/Users/xuzhanhong1/Documents/image-20181111143014786.png)\n\n![image-20181111143107194](/Users/xuzhanhong1/Documents/image-20181111143107194.png)\n\n\n\n## starvation\n\nreusing work where it can. So if it had a low priority work that was done and the high priority work didn't touch that part of the tree then they can reuse that work.\n\n![image-20181111143219524](/Users/xuzhanhong1/Documents/image-20181111143219524.png)\n\n\n\n## ็ธๅณ่ตๆ\n\n[effectTag](http://link.zhihu.com/?target=https%3A//github.com/facebook/react/blob/master/packages/shared/ReactSideEffectTags.js)\n\n[react custom rIC](https://github.com/facebook/react/blob/0154a79fedef38a824a837c535bc853013dd4588/packages/react-scheduler/src/ReactScheduler.js#L25-L31)\n\n",
        "type": "MarkdownRemark",
        "contentDigest": "6c796db21a5c3323967878c074ea3c18",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "learning A Cartoon to Fiber",
        "date": "2018-11-11",
        "spoiler": "ๅญฆไน่ฎฐๅฝ",
        "_PARENT": "e8ec8119-272f-5ede-9062-62d6d04ec767"
      },
      "excerpt": "",
      "rawMarkdownBody": "\n## ่ฟ้ๆ่ฟๆฒกๅๅฎ\n\n![image-20181110201732613](/Users/xuzhanhong1/Documents/image-20181110201732613.png)\n\n\n\n![image-20181110202214457](/Users/xuzhanhong1/Documents/image-20181110202214457.png)\n\n\n\n![image-20181110203945805](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110203945805.png)\n\n## stack reconciler็็ผบ็น\n\nโ\tๅจๆไปฌๆง่กupdateๆไฝไนๅๆไปฌๅทฒ็ปๆไธไธชๅจๅๅงrenderๆถๅทฒ็ปๆ้ๅฅฝ็fiberๆ๏ผreactไนไผๅผๅงwork-in-progressๆๅนถๆทปๅ็ฌฌไธไธชfiber่็น๏ผๅไธบๆไปฌไธๆณๅฝๆไปฌ่ฎก็ฎๅๅจๆถ็ดๆฅไฟฎๆนdom๏ผ่ฟไธช่ทstack reconcilerไธไธๆท๏ผstack reconcilerๅจๅพไธ่ตฐๆนๅๅฎไพๆถๅๆถๆนๅจๅฝๅ็dom่็นใ\n\nโ\tไพๅฆๅจๅฐๅฎไพ2ๅๆ4ๆถ๏ผๅๆถไนไผๆนๅจdom nodeไป2ๅฐ4ๅจreact่ฎก็ฎ็ฌฌไธไธชๅฎไพๅบ่ฏฅไป3ๅๅฐ9ๅใ\n\n![image-20181110204749728](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110204749728.png)\n\n่ฟๆทๅญๆฏๅฏ่ก็ๅฆๆไฝไธๆฌกๆงๅๆญฅๅฐๅฎๆๆๆไบๆใๅฆๆไฝ้่ฆๅจไธคไธชๅฎไพ้ดๆๆญๆถ๏ผๆต่งๅจ้่ฆๆถ้ดpaintๅlayout๏ผไฝๆฏๅชๆ2ๅๆ4่3ๆฒกๆๅๆ9๏ผ่ฟๆทไฝ็uiๅฐฑไผๅๅพไธ่ฟ็ปญใ\n\n\n\n## fiber phases\n\n็ฌฌไธไธช้ถๆฎต๏ผreactๅชไผๆๅปบfiber treeๅwork-in-progress treeๅๅๅจๅ่กจ๏ผๅฏไธญๆญ๏ผ\n\n็ฌฌไบ้ถๆฎต๏ผๅฐ่ฟไบๅๅจไฝ็จๅฐdomไธ๏ผไธๅฏไธญๆญ๏ผ\n\n![image-20181110205919129](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110210012223.png)\n\n\n\n## ้ถๆฎต1\n\n1. ๅฝๆไปฌ็นๅปๆ้ฎๆถ่งฆๅไบsetState\n\n![image-20181110210205135](/Users/xuzhanhong1/Documents/image-20181110210205135.png)\n\n2. ๅฝsetState่ขซ่ฐ็จๆถ๏ผreactไผๆทปๅList็ปไปถไธ็ณปๅๆดๆฐๆทปๅๅฐๆดๆฐ้ๅไธญ๏ผ็ถๅreactไผๅผๅง่ฐๅบฆ่ฟไบๅทฅไฝ![image-20181110210528429](/Users/xuzhanhong1/Documents/image-20181110210528429.png)\n\n3. ไฝฟ็จrequest idle callbackๅปๅปถ่ฟๅฎๆ่ฟไบๅทฅไฝ \n\n   ![image-20181110210741530](/Users/xuzhanhong1/Documents/image-20181110210741530.png)\n\n   ๅฝไธป็บฟ็จๆ็ฉบ้ฒๆถ้ดๆถไผๆๅทไฝๅฉไฝๆถ้ด็ปreact๏ผๅทไฝๅๆฏซ็งๅฐๅๅๆฏซ็ง๏ผๅฝๆ่ฟ็ๅฐๆฅๆฒกๆframe scheduledๆถ๏ผ\n\n   ![image-20181110211003501](/Users/xuzhanhong1/Documents/image-20181110211003501.png)\n\n   โ\t่ฟๆทreactๅฏไปฅไฝฟ็จ่ฟไบๅฉไฝๆถ้ดๅค็ๆดๆฐๅนถๅฝๅถไปๅทฅไฝ้่ฆๅค็ๆถๅฐๆถ้ด่ฟ็ปไธป็บฟ็จใ่ฟๆท็ๆไฝ้่ฆ่ท่ธชไธคไธชๆถ้ด๏ผnext unit of work that it needs to work on ๅ ไธป็บฟ็จ็ปไธ็ๅฉไฝๆถ้ด\n\n   ![image-20181110211302791](/Users/xuzhanhong1/Documents/image-20181110211302791.png)\n\n4. ไปcurrentๅคๅถHostRoot็ๆฐๆฎๅฐworkInProgress tree ๅนถๆทปๅไธไธชๆ้ๆๅๅฟๅญ๏ผList๏ผ\n\n   ![image-20181110211949517](/Users/xuzhanhong1/Documents/image-20181110211949517.png)\n\n5. ๅไธบListๆฌ่บซๆฒกๆๆดๆฐ๏ผๆไปฅๅฐListๅคๅถๅฐworkInProgress treeใๅนถไธListๆๆดๆฐ้ๅ๏ผๆไปฅไนไผๅคๅถupdate Queueใ\n\n   ![image-20181110212258539](/Users/xuzhanhong1/Documents/image-20181110212258539.png)\n\n6. ๆไปฅList fiber is going to be returned as the next unit of work![image-20181110212347964](/Users/xuzhanhong1/Documents/image-20181110212347964.png)\n\n7. React ไผๆฃๆฅdeadlineๆฏๅฆๅฐๆฅใๅไธบ่ฟๆๅฉไฝ็ๆถ้ด๏ผreactไผ็ปง็ปญๅค็List![image-20181110212645386](/Users/xuzhanhong1/Documents/image-20181110212645386.png)\n\n8. ๅไธบListๆๆดๆฐ้ๅ๏ผๆไปฅreactไผๅค็่ฟไบๆดๆฐ๏ผไปไผ่ฐ็จupdaterๅฝๆฐ๏ผไธไผๅฏน่ฑก็setStateไปฅๅ็ๆไธช็ๆฌ่ขซ็งป้ค![image-20181110212849733](/Users/xuzhanhong1/Documents/image-20181110212849733.png)ๅนถ็ปๆๅค็ๆดๆฐ้ๅ๏ผfiberไผๆ่ฎฐไธไธชtag่กจ็คบไปไผไฟฎๆนdomๆ![image-20181110213110874](/Users/xuzhanhong1/Documents/image-20181110213110874.png)\n\n9. ๅจ็ปง็ปญๅพไธๅค็ๅ๏ผๆไปฌ้่ฆ็ฅ้List็children๏ผๆไปฅreactไผๅจListๅฎไพ่ฎพ็ฝฎpropsๅstateๅนถ่ฐ็จrender๏ผๆไปฌไผๅพๅฐไธไธชๆฐ็ป็ๅ็ดใreactไผ้ๅ่ฟไบๅ็ดๅปๅคๆญๅจcurrent treeไธญๆฏๅฆๆๅฏไปฅ้็จ็fiberใๅฆๆๆ๏ผๅ็ดๆฅๅคๅถ\n\n   ![image-20181110213813900](/Users/xuzhanhong1/Documents/image-20181110213813900.png)\n\n   ![image-20181110213944644](/Users/xuzhanhong1/Documents/image-20181110213944644.png)\n\n10. ็ถๅไผ่ฟๅList็็ฌฌไธไธชchild buttonไฝไธบไธไธไธชunit of work, ็ถๅreactไผๅๅฐwork loopๅนถๆฃๆฅdeadlineใ![image-20181110214543420](/Users/xuzhanhong1/Documents/image-20181110214543420.png)![image-20181110214728829](/Users/xuzhanhong1/Documents/image-20181110214728829.png)\n\n11. ่ฟไธชๆถๅ็จๆทๆณๆไบๆ๏ผ็นๅปๆพๅคงๅญไฝๆ้ฎๅปๆนๅwebๅญไฝๅคงๅฐ![image-20181110214856489](/var/folders/h5/1tnmsg713pldfgpyxh4c41wm0m7_pl/T/abnerworks.Typora/image-20181110214856489.png)\n\n12. ่ฟๆทไผๅฏผ่ด็ป้ๅไธญ็ไธไบไธ่ฅฟๆทปๅไบไธไธชๅ่ฐ๏ผไธป็บฟ็จ้่ฆๅปๅณๅฟ็๏ผไฝๆฏไธๆฏ้ฉฌไธๅไธบreactไป็ถๆๆถ้ด็ปง็ปญๅค็next unit of work -- buttonใbuttonๆฏๆไปฌ็ฌฌไธไธช้ๅฐ็ๆฒกๆๅญฉๅญ็ๅ็ด๏ผๆไปฅไปไธไผๅๅปบๆฐ็ๅทฅไฝใๆไปฅreactๅฏไปฅๅฎๆ่ฟไธชๅไฝ็ๅทฅไฝ๏ผ่ฟๆๅณ็ๆฏ่พๆฐๆงๅ็ดๆฅ็ๆฏๅฆๆๅๅจ๏ผๅฆๆๆๅๅจ้่ฆๅๅจdomๅไผๆ่ฎฐใ็ถๅๅไธบbuttonๆฒกๆๅญฉๅญ๏ผๆไปฅไผ่ฟๅ้ปๅฑไฝไธบไธไธไธชๅไฝ็ๅทฅไฝ![image-20181110215513582](/Users/xuzhanhong1/Documents/image-20181110215513582.png)\n\n13. reactไผ็ปๆ่ฟไธชๅๅ็ๅทฅไฝๅนถๅๅฐwork loopไธญๆฃๆฅdeadline![image-20181110215657530](/Users/xuzhanhong1/Documents/image-20181110215657530.png)\n\n14. itemไธญๆsCU๏ผๅนถไธๅไธบsCU่ฟๅfalseๆไปฅitem1ไธ้่ฆๅฏนdom่ฟ่กไฟฎๆน๏ผๆไปฅไธ้่ฆๆๆ็ญพใ็ถๅ้ปๅฑไฝไธบไธไธไธชๅๅ็ๅทฅไฝใๅๆทๅฐ๏ผreactๅๅฐwork loopๆฃๆฅdeadlineๅนถๅๆฅ![image-20181110215823086](/Users/xuzhanhong1/Documents/image-20181110215823086.png)\n\n15. ็ฌฌไบไธชitem็sCU่ฟๅtrue๏ผๆไปฅไผ่ขซๆ่ฎฐไธบๆๆดๅ๏ผ็ถๅไป็divไผ่ขซๅคๅถ่ฟๆฅ๏ผๅนถไธๅฐdiv่ฟๅไฝไธบไธไธไธชๅๅ็ๅทฅไฝ \n    ![image-20181110220630861](/Users/xuzhanhong1/Documents/image-20181110220630861.png)![image-20181110220704324](/Users/xuzhanhong1/Documents/image-20181110220704324.png)\n\n    \n\n16.  ๅไธบๆไปฌ่ฟๆไธไธขไธขๆถ้ดๆไปฅๆไปฌๅๅคๅค็่ฟไธชdiv๏ผๅไธบ่ฟไธชdivๆฒกๆchildrenๆไปฅๆไปฌๅฏไปฅๅฎๆๅฎ๏ผๆไปฌๅ็ฐ่ฟไธชdiv็ๅๅฎนๅๆดไบ๏ผๆไปฅๆไปฌ็ปไปๆไธๆ่ฎฐ\n    ![image-20181110222222665](/Users/xuzhanhong1/Documents/image-20181110222423364.png)\n\n17. ๅไธบๅฝๅๆฒกๆ้ปๅฑไนๆฒกๆchildren๏ผๆฒกๆไธไธชๅๅ็ๅทฅไฝ๏ผๆไปฅไผ่ฐ็จไป็ถไบฒ็complete๏ผๅนถไธ่ฟๆฏๆไปฌ็ฌฌไธๆฌกๅฐๅๅจๆทปๅๅฐไธไธชๅ่กจ๏ผๅไธบไปๆtagไธๅฎๆไบ(completed)ใ\n    ![image-20181110224035848](/Users/xuzhanhong1/Documents/image-20181110224035848.png)\n\n18. ่ฟไธชๆถๅitemไนๅฎๆไบ(complated)ๅนถไธไปไนๆไธไธชtagใso it's going to move itself up to it's going to start creating this list of changes on its parent. It merge its own list of changes into the parents effect list\n\n19. itemไผๅฐdiv็ๅๅจๆพๅฐeffect list็็ฌฌไธไธช๏ผ็ถๅๅฐ่ชๅทฑๆพๅฐeffect list็ๆซๅฐพ\n    ![image-20181110224526544](/Users/xuzhanhong1/Documents/image-20181110224526544.png)\n\n20. ็ฌฌไบไธชitem complete ๅนถ่ฟๅ้ปๅฑไฝไธบไธไธไธชๅๅ็ๅทฅไฝ![image-20181110224637609](/Users/xuzhanhong1/Documents/image-20181110224637609.png)\n\n    ่ฟๅwork loop๏ผreactๅ็ฐdeadlineๅทฒ็ปๅฐไบใๆไปฅreactไผ้ๆพ่ตๆบๅนถ่ฎฉไธป็บฟ็จๅค็ๅถไปไปปๅก\n\n    ![image-20181110224810666](/Users/xuzhanhong1/Documents/image-20181110224810666.png)\n\n    reactไป็ถ้่ฆ็ปง็ปญๅฎๆไปปๅก๏ผๆไปฅไฝฟ็จrIC่ฎฉไธป็บฟ็จๅฎๆๅทฅไฝๅ็ปง็ปญ่ฐ็จreact\n\n    ![image-20181110224939741](/Users/xuzhanhong1/Documents/image-20181110224939741.png)\n\n    ็ถๅไธป็บฟ็จไผๅปๅค็็ญๅพไธญ็callback๏ผๅจ่ฟไธชไพๅญไธญๆฏlayout\n\n    ![image-20181110225030973](/Users/xuzhanhong1/Documents/image-20181110225030973.png)\n\n    ไธ่ฟๆณจๆๅฐnothing in the content of our react app is changed even though react note says going to need to change two to four ๅจๅฐๆฅ็ๆไธชๆถ้ด๏ผ่ไธๆฏ็ฐๅจใ\n\n    \n\n21. main thread ๅค็ๅฎๅถไปไบๆไผ็ปง็ปญ่ฐ็จreact๏ผๆๅไธคไธชๅๅๅทฅไฝๅ็ฌฌไบไธชitemไธๆท\n\n    ![image-20181110225617532](/Users/xuzhanhong1/Documents/image-20181110225617532.png)\n    ![image-20181110225632116](/Users/xuzhanhong1/Documents/image-20181110225632116.png)\n\nๅณๅฎๆไบListไธ้ข็ๆๆๅๅๅทฅไฝ๏ผๆไปฅListๅฏไปฅ่ฐ็จcomplete๏ผๅนถๅฐ่ชๅทฑๅๅญฉๅญ็ๆดๅๆพๅฐeffect listไธญ๏ผ็ถๅHostRootไนๅฎๆไบ\n![image-20181110225715325](/Users/xuzhanhong1/Documents/image-20181110230128716.png)\n![image-20181110225807413](/Users/xuzhanhong1/Documents/image-20181110225807413.png)\n\n\n\n22. reactไผๅฐwork-in-progress tree่ฎพๆpending commit๏ผ่ฟๆๅณ็็ฌฌไธไธช้ถๆฎต็ปๆไบใๆไปฌๆดๆฐไบwork-in-progress treeๅๆๅบไบๅๅจๅ่กจ\n\n\n\n## ้ถๆฎต2\n\n1. react ไผๆฃๆฅdeadlineๅคๆญๆฏๅฆๆๆถ้ด็ซๅปๆง่กcommit๏ผๅฆๆไธๅคๅๅจrICๅ็ฌฌไธๆถ้ดcommit่ฟไธชpending commit![image-20181110230504330](/Users/xuzhanhong1/Documents/image-20181110230504330.png)\n2. reactไผ้ๅeffect listๅนถๅบ่ฏฅๆดๅๅฐdomไธ๏ผไป็ฌฌไธไธชfiberๅผๅง\n\n![image-20181110230821602](/Users/xuzhanhong1/Documents/image-20181110230821602.png)\n![image-20181110230855909](/Users/xuzhanhong1/Documents/image-20181110230855909.png)\n![image-20181110230913246](/Users/xuzhanhong1/Documents/image-20181110230913246.png)\nitemๆฒกๆไปปไฝๆนๅ๏ผๅไธบๆไปฌไธไฝฟ็จref๏ผไธ่ฟๅฆๆๆไปฌๅจitemไธญๆref will be detached now and then it would be reattached later\n![image-20181110231153619](/Users/xuzhanhong1/Documents/image-20181110231153619.png)\n![image-20181110231121156](/Users/xuzhanhong1/Documents/image-20181110231121156.png)\n็ฐๅจๆๆๅๅจ้ฝๅจ็ฌฌไธ้ถๆฎต่ฎก็ฎๅฎๆฏๅนถcommitๅฐdomๆใ่ฟๆๅณ็work-in-progress tree is actually a more up-to-date version of state of the app than the current tree๏ผๆไปฅreact้่ฆไฟฎๅคcurrent treeใไปไผๅๆขๆ้๏ผๆไปฅๅฝๅๆ้ๆๅๆไปฌๅๆๅปบ็work-in-pregress tree\n![image-20181110231429089](/Users/xuzhanhong1/Documents/image-20181110231429089.png)\n![image-20181110231630674](/Users/xuzhanhong1/Documents/image-20181110231630674.png)\n่ฟๆๅณ็reactๅฏไปฅๅจwork-in-progress treeไธญ้็จๆงๅฏน่ฑก๏ผๅช้่ฆๅจไธๆฌกๆๅปบไธญwork-in-progress treeๅคๅถkey valueใ่ฟๅซdouble buffering๏ผๅฏไปฅๅจๅๅญๅ้ๅgcไธญ่็ๆถ้ด๏ผ็ฐๅจreactๅฎๆไบ่ฟๆฌก็commit๏ผๅนถๆง่กๅฉไธ็lifecycle hooksๅๆดๆฐไปปไฝrefsๅนถๅค็error boundaries\n![image-20181110232043775](/Users/xuzhanhong1/Documents/image-20181110232043775.png)\n\n## ไผๅ็บง\n\n```javascript\n{\n    \"Synchronous\": \"same as stack rec\",\n    \"Task\": \"before next tick\",\n    \"Animation\": \"before next frame\",\n     \"rIC\":{\n        \t\"High\":\"pretty soon\",\n            \"Low\":\"ๅฆๆฐๆฎ่ทๅ๏ผๅฏน100or200msไธๆๆ\",\n\t\t\t\"Offscreen\": \"prep for display/scroll\"\n        }\n}\n```\n\n้ซไผๅ็บง็ไปปๅกไผ็ซๅปๆง่ก๏ผๅฐฝ็ฎก็ฐๅจๅทฒ็ปๅผๅงไบไฝไผๅ็บง็ไปปๅก\n\n![image-20181110232753533](/Users/xuzhanhong1/Documents/image-20181110232753533.png)\n\nๅๅฐไนๅๆไปฌๆไบๆ็ๅฐๆน๏ผๅฆๆๆไปฌๆไธไธช็ดงๆฅ็font resize button\n![image-20181110233032279](/Users/xuzhanhong1/Documents/image-20181110233032279.png)\n\n็จๆท็นๅปๅไผๆพ็ฝฎไธไธชcallbackๅฐไธป็บฟ็จๅค็้ๅไธญ\n\n\n\n\n\n\n\n## lifecycle hook during the phase\n\n![image-20181111143014786](/Users/xuzhanhong1/Documents/image-20181111143014786.png)\n\n![image-20181111143107194](/Users/xuzhanhong1/Documents/image-20181111143107194.png)\n\n\n\n## starvation\n\nreusing work where it can. So if it had a low priority work that was done and the high priority work didn't touch that part of the tree then they can reuse that work.\n\n![image-20181111143219524](/Users/xuzhanhong1/Documents/image-20181111143219524.png)\n\n\n\n## ็ธๅณ่ตๆ\n\n[effectTag](http://link.zhihu.com/?target=https%3A//github.com/facebook/react/blob/master/packages/shared/ReactSideEffectTags.js)\n\n[react custom rIC](https://github.com/facebook/react/blob/0154a79fedef38a824a837c535bc853013dd4588/packages/react-scheduler/src/ReactScheduler.js#L25-L31)\n\n",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/learning A Cartoon to Fiber.md",
      "fields": {
        "slug": "/learning A Cartoon to Fiber/"
      }
    },
    "d16d8354-6f61-5f1a-ad48-bd02309a1329": {
      "id": "d16d8354-6f61-5f1a-ad48-bd02309a1329",
      "children": [],
      "parent": "af562c41-a48f-5b7c-b2db-cced04ba9be3",
      "internal": {
        "content": "\n# Promise\n\n่ง่ฏไบไธ้้ข่ฏ้ข๏ผ้ๆธฉไธไธPromiseใ\n\n## ้ข็ฎ\n\n```javascript\nconst timeout = ms => new Promise((resolve, reject) => {\n setTimeout(() => {\n  resolve();\n }, ms);\n});\n\nconst ajax1 = () => timeout(2000).then(() => {\n console.log('1');\n return 1;\n});\n\nconst ajax2 = () => timeout(1000).then(() => {\n console.log('2');\n return 2;\n});\n\nconst ajax3 = () => timeout(2000).then(() => {\n console.log('3');\n return 3;\n});\n\nmergePromise = ajaxArray => {\n  //ๅกซ่ฟ้\n}\n\nmergePromise([ajax1, ajax2, ajax3]).then(data => {\n console.log('done');\n console.log(data); \n});\n\n// ๅๅซ่พๅบ\n// 1\n// 2\n// 3\n// done\n// [1, 2, 3]\n```\n\n## ๅๆ\n\nโ\tไน็้ข็ฎๆฒกไปไนๅฐ้พ๏ผ่ฆๅฎ็ฐไนๅฏไปฅๅผบ่ก็จtimeoutๅปถ่ฟajax2็่ฐ็จใไฝๆฏ้ข็ฎ่ฏๅฎไธๆฏๅๅฎๅฐฑๅฅฝไบ๏ผๅฐฑๅจๆณmergePromise่ฝๅฆๅๆ่ฝๅฎ็ฐfc๏ผ่ไธๆฏไปไปๅฎๆ่ฟไธ้ขใ้พ็นๅฐฑๅจไบๅฆไฝ่งฃๅณforEachๆ่ไฝฟ็จreduceๅ่ฟ่ฝไฟๆthen็็ถๆ\n\n\n\n## ๆ็่งฃ็Promise\n\n> ๆ่ฐ`Promise`๏ผ็ฎๅ่ฏดๅฐฑๆฏไธไธชๅฎนๅจ๏ผ้้ขไฟๅญ็ๆไธชๆชๆฅๆไผ็ปๆ็ไบไปถ๏ผ้ๅธธๆฏไธไธชๅผๆญฅๆไฝ๏ผ็็ปๆใไป่ฏญๆณไธ่ฏด๏ผPromise ๆฏไธไธชๅฏน่ฑก๏ผไปๅฎๅฏไปฅ่ทๅๅผๆญฅๆไฝ็ๆถๆฏใPromise ๆไพ็ปไธ็ API๏ผๅ็งๅผๆญฅๆไฝ้ฝๅฏไปฅ็จๅๆท็ๆนๆณ่ฟ่กๅค็ใ\n\n> ็น็น๏ผ\n>\n>   ไธๆฆ็ถๆๆนๅ๏ผๅฐฑไธไผๅๅ๏ผไปปไฝๆถๅ้ฝๅฏไปฅๅพๅฐ่ฟไธช็ปๆใ`Promise`ๅฏน่ฑก็็ถๆๆนๅ๏ผๅชๆไธค็งๅฏ่ฝ๏ผไป`pending`ๅไธบ`fulfilled`ๅไป`pending`ๅไธบ`rejected`ใๅช่ฆ่ฟไธค็งๆๅตๅ็๏ผ็ถๆๅฐฑๅๅบไบ๏ผไธไผๅๅไบ๏ผไผไธ็ดไฟๆ่ฟไธช็ปๆ๏ผ่ฟๆถๅฐฑ็งฐไธบ resolved๏ผๅทฒๅฎๅ๏ผใๅฆๆๆนๅๅทฒ็ปๅ็ไบ๏ผไฝๅๅฏน`Promise`ๅฏน่ฑกๆทปๅๅ่ฐๅฝๆฐ๏ผไนไผ็ซๅณๅพๅฐ่ฟไธช็ปๆใ่ฟไธไบไปถ๏ผEvent๏ผๅฎๅจไธๅ๏ผไบไปถ็็น็นๆฏ๏ผๅฆๆไฝ้่ฟไบๅฎ๏ผๅๅป็ๅฌ๏ผๆฏๅพไธๅฐ็ปๆ็ใ\n\n ๆธๅฟๆฏ่ฆ็่งฃๅฎนๅจไธ็ถๆๆนๅๅๅฐฑไธไผๅๅ็็ถๆใๆไปฅๆนๆฎ่ฟไธช็นๆงๅฏไปฅๆๅฑforEachๅช่ฝๅๆญฅๆง่ก็ๅผฑ็น๏ผ้่ฟforEachๅฐajaxArrayๆผๅจไธๆกPromise้พไธญใ\n\n\n\n## Promiseๅญฆไน\n\n### ไธไธช็ฎๅ็ๅปถๆถๅจ\n\n```javascript\nfunction timeout(ms) {\n \treturn new Promise((resolve,reject)=>{\n\tsetTimeout(resolve, ms)\n})   \n}\n```\n\n\n\n### Promiseๅตๅฅ\n\n```javascript\nconst p1 = new Promise(function (resolve, reject) {\n  setTimeout(() => reject(new Error('fail')), 3000)\n})\n\nconst p2 = new Promise(function (resolve, reject) {\n  setTimeout(() => resolve(p1), 1000)\n})\n\np2\n  .then(result => console.log(result))\n  .catch(error => console.log(error))\n// Error: fail\n```\n\nไธ้ขไปฃ็ไธญ๏ผp1ๆฏไธไธช Promise๏ผ3 ็งไนๅๅไธบrejectedใp2็็ถๆๅจ 1 ็งไนๅๆนๅ๏ผresolveๆนๆณ่ฟๅ็ๆฏp1ใ็ฑไบp2่ฟๅ็ๆฏๅฆไธไธช Promise๏ผๅฏผ่ดp2่ชๅทฑ็็ถๆๆๆไบ๏ผ็ฑp1็็ถๆๅณๅฎp2็็ถๆใๆไปฅ๏ผๅ้ข็then่ฏญๅฅ้ฝๅๆ้ๅฏนๅ่๏ผp1๏ผใๅ่ฟไบ 2 ็ง๏ผp1ๅไธบrejected๏ผๅฏผ่ด่งฆๅcatchๆนๆณๆๅฎ็ๅ่ฐๅฝๆฐใ\n\n\n\n### Promise.resolve()\n\nๆๆถ้่ฆๅฐ็ฐๆๅฏน่ฑก่ฝฌไธบ Promise ๅฏน่ฑก๏ผ`Promise.resolve`ๆนๆณๅฐฑ่ตทๅฐ่ฟไธชไฝ็จใ\n\n`Promise.resolve`็ญไปทไบไธ้ข็ๅๆณใ\n\n```javascript\nPromise.resolve('foo')\n// ็ญไปทไบ\nnew Promise(resolve => resolve('foo'))\n```\n\n\n\n## ็ญๆก\n\nๆๅปบ้กบๅบๆง่กๅผๆญฅไปปๅก็ๅบๆฌๅๆฏ\n\n```javascript\nvar sequence = Promise.resolve();\narray.forEach(function(item) {\nsequence = sequence.then(//deal item)\n});\n```\n\n\n\n```javascript\nmergePromise = ajaxArray => {\n    //่ตทๅง็promise\n    var sequence = Promise.resolve();\n    // ๅญๆพๆฐ็ปไธญๆฏไธไธชpromise็็ปๆ\n    let ret = [];\n    //ไธบไบๅฎ็ฐPromise้พ็ๅปถ็ปญ๏ผ่ฟ้ๅฟ้กป่ฟๅไธไธชpromise๏ผ่ไธ่ฟๅๅผๆฏret\n    return new Promise((reslove, reject)=> \n        ajaxArray.forEach(function(func) {\n        \t//่ฟ้็forEachๆฏๅๆญฅๆง่ก็\n            sequence = sequence.then(function() {\n                return func()\n            }).then(function(data) {\n                ret.push(data)\n                if(ret.length===ajaxArray.length){\n                    reslove(ret)\n                    }\n                })\n\n            console.log('!!!', sequence)\n        })\n        )\n}\n\nmergePromise([ajax1, ajax2, ajax3]).then(data => {\n console.log('done');\n console.log(data); \n});\n```\n\n\n\n\n\n",
        "type": "MarkdownRemark",
        "contentDigest": "68d754e187713fdab7c50470da0cb80a",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "Promise",
        "date": "2018-07-25",
        "spoiler": "่ง่ฏไบไธ้้ข่ฏ้ข๏ผ้ๆธฉไธไธPromiseใ",
        "_PARENT": "af562c41-a48f-5b7c-b2db-cced04ba9be3"
      },
      "excerpt": "",
      "rawMarkdownBody": "\n# Promise\n\n่ง่ฏไบไธ้้ข่ฏ้ข๏ผ้ๆธฉไธไธPromiseใ\n\n## ้ข็ฎ\n\n```javascript\nconst timeout = ms => new Promise((resolve, reject) => {\n setTimeout(() => {\n  resolve();\n }, ms);\n});\n\nconst ajax1 = () => timeout(2000).then(() => {\n console.log('1');\n return 1;\n});\n\nconst ajax2 = () => timeout(1000).then(() => {\n console.log('2');\n return 2;\n});\n\nconst ajax3 = () => timeout(2000).then(() => {\n console.log('3');\n return 3;\n});\n\nmergePromise = ajaxArray => {\n  //ๅกซ่ฟ้\n}\n\nmergePromise([ajax1, ajax2, ajax3]).then(data => {\n console.log('done');\n console.log(data); \n});\n\n// ๅๅซ่พๅบ\n// 1\n// 2\n// 3\n// done\n// [1, 2, 3]\n```\n\n## ๅๆ\n\nโ\tไน็้ข็ฎๆฒกไปไนๅฐ้พ๏ผ่ฆๅฎ็ฐไนๅฏไปฅๅผบ่ก็จtimeoutๅปถ่ฟajax2็่ฐ็จใไฝๆฏ้ข็ฎ่ฏๅฎไธๆฏๅๅฎๅฐฑๅฅฝไบ๏ผๅฐฑๅจๆณmergePromise่ฝๅฆๅๆ่ฝๅฎ็ฐfc๏ผ่ไธๆฏไปไปๅฎๆ่ฟไธ้ขใ้พ็นๅฐฑๅจไบๅฆไฝ่งฃๅณforEachๆ่ไฝฟ็จreduceๅ่ฟ่ฝไฟๆthen็็ถๆ\n\n\n\n## ๆ็่งฃ็Promise\n\n> ๆ่ฐ`Promise`๏ผ็ฎๅ่ฏดๅฐฑๆฏไธไธชๅฎนๅจ๏ผ้้ขไฟๅญ็ๆไธชๆชๆฅๆไผ็ปๆ็ไบไปถ๏ผ้ๅธธๆฏไธไธชๅผๆญฅๆไฝ๏ผ็็ปๆใไป่ฏญๆณไธ่ฏด๏ผPromise ๆฏไธไธชๅฏน่ฑก๏ผไปๅฎๅฏไปฅ่ทๅๅผๆญฅๆไฝ็ๆถๆฏใPromise ๆไพ็ปไธ็ API๏ผๅ็งๅผๆญฅๆไฝ้ฝๅฏไปฅ็จๅๆท็ๆนๆณ่ฟ่กๅค็ใ\n\n> ็น็น๏ผ\n>\n>   ไธๆฆ็ถๆๆนๅ๏ผๅฐฑไธไผๅๅ๏ผไปปไฝๆถๅ้ฝๅฏไปฅๅพๅฐ่ฟไธช็ปๆใ`Promise`ๅฏน่ฑก็็ถๆๆนๅ๏ผๅชๆไธค็งๅฏ่ฝ๏ผไป`pending`ๅไธบ`fulfilled`ๅไป`pending`ๅไธบ`rejected`ใๅช่ฆ่ฟไธค็งๆๅตๅ็๏ผ็ถๆๅฐฑๅๅบไบ๏ผไธไผๅๅไบ๏ผไผไธ็ดไฟๆ่ฟไธช็ปๆ๏ผ่ฟๆถๅฐฑ็งฐไธบ resolved๏ผๅทฒๅฎๅ๏ผใๅฆๆๆนๅๅทฒ็ปๅ็ไบ๏ผไฝๅๅฏน`Promise`ๅฏน่ฑกๆทปๅๅ่ฐๅฝๆฐ๏ผไนไผ็ซๅณๅพๅฐ่ฟไธช็ปๆใ่ฟไธไบไปถ๏ผEvent๏ผๅฎๅจไธๅ๏ผไบไปถ็็น็นๆฏ๏ผๅฆๆไฝ้่ฟไบๅฎ๏ผๅๅป็ๅฌ๏ผๆฏๅพไธๅฐ็ปๆ็ใ\n\n ๆธๅฟๆฏ่ฆ็่งฃๅฎนๅจไธ็ถๆๆนๅๅๅฐฑไธไผๅๅ็็ถๆใๆไปฅๆนๆฎ่ฟไธช็นๆงๅฏไปฅๆๅฑforEachๅช่ฝๅๆญฅๆง่ก็ๅผฑ็น๏ผ้่ฟforEachๅฐajaxArrayๆผๅจไธๆกPromise้พไธญใ\n\n\n\n## Promiseๅญฆไน\n\n### ไธไธช็ฎๅ็ๅปถๆถๅจ\n\n```javascript\nfunction timeout(ms) {\n \treturn new Promise((resolve,reject)=>{\n\tsetTimeout(resolve, ms)\n})   \n}\n```\n\n\n\n### Promiseๅตๅฅ\n\n```javascript\nconst p1 = new Promise(function (resolve, reject) {\n  setTimeout(() => reject(new Error('fail')), 3000)\n})\n\nconst p2 = new Promise(function (resolve, reject) {\n  setTimeout(() => resolve(p1), 1000)\n})\n\np2\n  .then(result => console.log(result))\n  .catch(error => console.log(error))\n// Error: fail\n```\n\nไธ้ขไปฃ็ไธญ๏ผp1ๆฏไธไธช Promise๏ผ3 ็งไนๅๅไธบrejectedใp2็็ถๆๅจ 1 ็งไนๅๆนๅ๏ผresolveๆนๆณ่ฟๅ็ๆฏp1ใ็ฑไบp2่ฟๅ็ๆฏๅฆไธไธช Promise๏ผๅฏผ่ดp2่ชๅทฑ็็ถๆๆๆไบ๏ผ็ฑp1็็ถๆๅณๅฎp2็็ถๆใๆไปฅ๏ผๅ้ข็then่ฏญๅฅ้ฝๅๆ้ๅฏนๅ่๏ผp1๏ผใๅ่ฟไบ 2 ็ง๏ผp1ๅไธบrejected๏ผๅฏผ่ด่งฆๅcatchๆนๆณๆๅฎ็ๅ่ฐๅฝๆฐใ\n\n\n\n### Promise.resolve()\n\nๆๆถ้่ฆๅฐ็ฐๆๅฏน่ฑก่ฝฌไธบ Promise ๅฏน่ฑก๏ผ`Promise.resolve`ๆนๆณๅฐฑ่ตทๅฐ่ฟไธชไฝ็จใ\n\n`Promise.resolve`็ญไปทไบไธ้ข็ๅๆณใ\n\n```javascript\nPromise.resolve('foo')\n// ็ญไปทไบ\nnew Promise(resolve => resolve('foo'))\n```\n\n\n\n## ็ญๆก\n\nๆๅปบ้กบๅบๆง่กๅผๆญฅไปปๅก็ๅบๆฌๅๆฏ\n\n```javascript\nvar sequence = Promise.resolve();\narray.forEach(function(item) {\nsequence = sequence.then(//deal item)\n});\n```\n\n\n\n```javascript\nmergePromise = ajaxArray => {\n    //่ตทๅง็promise\n    var sequence = Promise.resolve();\n    // ๅญๆพๆฐ็ปไธญๆฏไธไธชpromise็็ปๆ\n    let ret = [];\n    //ไธบไบๅฎ็ฐPromise้พ็ๅปถ็ปญ๏ผ่ฟ้ๅฟ้กป่ฟๅไธไธชpromise๏ผ่ไธ่ฟๅๅผๆฏret\n    return new Promise((reslove, reject)=> \n        ajaxArray.forEach(function(func) {\n        \t//่ฟ้็forEachๆฏๅๆญฅๆง่ก็\n            sequence = sequence.then(function() {\n                return func()\n            }).then(function(data) {\n                ret.push(data)\n                if(ret.length===ajaxArray.length){\n                    reslove(ret)\n                    }\n                })\n\n            console.log('!!!', sequence)\n        })\n        )\n}\n\nmergePromise([ajax1, ajax2, ajax3]).then(data => {\n console.log('done');\n console.log(data); \n});\n```\n\n\n\n\n\n",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/Promise.md",
      "fields": {
        "slug": "/Promise/"
      }
    },
    "69a39cc4-eb3d-5a69-b48f-4f997123b699": {
      "id": "69a39cc4-eb3d-5a69-b48f-4f997123b699",
      "children": [
        "5d6aff10-a2ce-5c90-87e2-9613addfdbf8"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "3ddf1f370fdb721a81da9785b133c1ce",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/react 16.7.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/react 16.7.md",
      "relativePath": "react 16.7.md",
      "extension": "md",
      "size": 2343,
      "prettySize": "2.34 kB",
      "modifiedTime": "2018-12-22T06:12:04.096Z",
      "accessTime": "2018-12-22T06:12:04.096Z",
      "changeTime": "2018-12-22T06:12:04.101Z",
      "birthTime": "2018-12-20T12:15:32.063Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "react 16.7.md",
      "ext": ".md",
      "name": "react 16.7",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4194304,
      "ino": 13367599,
      "blocks": 8,
      "atimeMs": 1545459124096.053,
      "mtimeMs": 1545459124096.1064,
      "ctimeMs": 1545459124101.1467,
      "birthtimeMs": 1545308132063.1357,
      "atime": "2018-12-22T06:12:04.096Z",
      "mtime": "2018-12-22T06:12:04.096Z",
      "ctime": "2018-12-22T06:12:04.101Z",
      "birthtime": "2018-12-20T12:15:32.063Z"
    },
    "5d6aff10-a2ce-5c90-87e2-9613addfdbf8": {
      "id": "5d6aff10-a2ce-5c90-87e2-9613addfdbf8",
      "children": [],
      "parent": "69a39cc4-eb3d-5a69-b48f-4f997123b699",
      "internal": {
        "content": "# react 16.7\n\n## React DOM\n\n### 1. Fix performance of `React.lazy` for large numbers of lazily-loaded components. ([@acdlite](https://github.com/acdlite) in [#14429](https://github.com/facebook/react/pull/14429)) \n\n### 2. Clear fields on unmount to avoid memory leaks. ([@trueadm](https://github.com/trueadm) in [#14276](https://github.com/facebook/react/pull/14276)) \n\n### 3. Fix bug with SSR and context when mixing `react-dom/server@16.6` and `react@<16.6`. ([@gaearon](https://github.com/gaearon) in [#14291](https://github.com/facebook/react/pull/14291)) \n\n### 4. Fix a performance regression in profiling mode. ([@bvaughn](https://github.com/bvaughn) in [#14383](https://github.com/facebook/react/pull/14383))\n\n\n\n## Scheduler\n\n### 1. Post to MessageChannel instead of window. ([@acdlite](https://github.com/acdlite) in [#14234](https://github.com/facebook/react/pull/14234))\n\nโ\tScheduler้่ฆๅจpaintไนๅ่งฆๅไธไธชtask๏ผไผ็จwindowๅปpostMessage๏ผ๏ผๅจ้ๅไธบ็ฉบไนๅๆฏไธๅธง้ฝไผๅ็้ฝไผ่งฆๅใ่ฟไผๅฏผ่ดๅถไปmessage event handlerๆฏไธๅธง้ฝไผ่ขซ่ฐ็จ๏ผๅณไฝฟๅฎไปฌ็ซๅณ้ๅบ๏ผ่ฟไนไผๅขๅๆฏๅธง็ๆพ็ๅผ้ใๆไปฅๆน็จMessageChannel\n\n```javascript\n if (typeof MessageChannel === 'function') {\n    // Use a MessageChannel, if support exists\n    var channel = new MessageChannel();\n    channel.port1.onmessage = idleTick;\n    port = channel.port2;\n  } \n```\n\n### 2. Reduce serialization overhead. ([@developit](https://github.com/developit) in [#14249](https://github.com/facebook/react/pull/14249))\n\nๅจๅๆขๅฐMessageChannel็่ฟ็จไธญ๏ผ่ฟๆฏไผ้ไบ\"*\"ใ ่ฟๅฎ้ไธๆ็ปไผ่งฆๅๅบๅๅใ ไธบไบ่็ไธไบๆง่ฝ๏ผๆน็จundefined๏ผๅไธบไผ้ไธไธชๅ0่ฟๆท็ๆฐๅญไป็ถไผไบง็ๅบๅๅๅผ้ \n\nๅทไฝๅฏไปฅ็*https://cs.chromium.org/chromium/src/third_party/blink/renderer/bindings/core/v8/script_value.h?type=cs&g=0&l=74* \n\n```\n    -  port.postMessage('*');\n    +  port.postMessage(undefined);\n```\n\n### 3. Fix fallback to `setTimeout` in testing environments. ([@bvaughn](https://github.com/bvaughn) in [#14358](https://github.com/facebook/react/pull/14358))\n\n### 4. Add methods for debugging. ([@mrkev](https://github.com/mrkev) in [#14053](https://github.com/facebook/react/pull/14053))\n",
        "type": "MarkdownRemark",
        "contentDigest": "450065926f01d2a06769136f5c582d98",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "react 16.7",
        "date": "2018-12-20",
        "spoiler": "ๆฏ็๏ผhooks่ฟๆฒกๆฅ",
        "_PARENT": "69a39cc4-eb3d-5a69-b48f-4f997123b699"
      },
      "excerpt": "",
      "rawMarkdownBody": "# react 16.7\n\n## React DOM\n\n### 1. Fix performance of `React.lazy` for large numbers of lazily-loaded components. ([@acdlite](https://github.com/acdlite) in [#14429](https://github.com/facebook/react/pull/14429)) \n\n### 2. Clear fields on unmount to avoid memory leaks. ([@trueadm](https://github.com/trueadm) in [#14276](https://github.com/facebook/react/pull/14276)) \n\n### 3. Fix bug with SSR and context when mixing `react-dom/server@16.6` and `react@<16.6`. ([@gaearon](https://github.com/gaearon) in [#14291](https://github.com/facebook/react/pull/14291)) \n\n### 4. Fix a performance regression in profiling mode. ([@bvaughn](https://github.com/bvaughn) in [#14383](https://github.com/facebook/react/pull/14383))\n\n\n\n## Scheduler\n\n### 1. Post to MessageChannel instead of window. ([@acdlite](https://github.com/acdlite) in [#14234](https://github.com/facebook/react/pull/14234))\n\nโ\tScheduler้่ฆๅจpaintไนๅ่งฆๅไธไธชtask๏ผไผ็จwindowๅปpostMessage๏ผ๏ผๅจ้ๅไธบ็ฉบไนๅๆฏไธๅธง้ฝไผๅ็้ฝไผ่งฆๅใ่ฟไผๅฏผ่ดๅถไปmessage event handlerๆฏไธๅธง้ฝไผ่ขซ่ฐ็จ๏ผๅณไฝฟๅฎไปฌ็ซๅณ้ๅบ๏ผ่ฟไนไผๅขๅๆฏๅธง็ๆพ็ๅผ้ใๆไปฅๆน็จMessageChannel\n\n```javascript\n if (typeof MessageChannel === 'function') {\n    // Use a MessageChannel, if support exists\n    var channel = new MessageChannel();\n    channel.port1.onmessage = idleTick;\n    port = channel.port2;\n  } \n```\n\n### 2. Reduce serialization overhead. ([@developit](https://github.com/developit) in [#14249](https://github.com/facebook/react/pull/14249))\n\nๅจๅๆขๅฐMessageChannel็่ฟ็จไธญ๏ผ่ฟๆฏไผ้ไบ\"*\"ใ ่ฟๅฎ้ไธๆ็ปไผ่งฆๅๅบๅๅใ ไธบไบ่็ไธไบๆง่ฝ๏ผๆน็จundefined๏ผๅไธบไผ้ไธไธชๅ0่ฟๆท็ๆฐๅญไป็ถไผไบง็ๅบๅๅๅผ้ \n\nๅทไฝๅฏไปฅ็*https://cs.chromium.org/chromium/src/third_party/blink/renderer/bindings/core/v8/script_value.h?type=cs&g=0&l=74* \n\n```\n    -  port.postMessage('*');\n    +  port.postMessage(undefined);\n```\n\n### 3. Fix fallback to `setTimeout` in testing environments. ([@bvaughn](https://github.com/bvaughn) in [#14358](https://github.com/facebook/react/pull/14358))\n\n### 4. Add methods for debugging. ([@mrkev](https://github.com/mrkev) in [#14053](https://github.com/facebook/react/pull/14053))\n",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/react 16.7.md",
      "fields": {
        "slug": "/react 16.7/"
      }
    },
    "9238919a-ba8b-5c13-9887-625986ceb5cd": {
      "id": "9238919a-ba8b-5c13-9887-625986ceb5cd",
      "children": [
        "47075887-16be-50c6-96fc-5d6e79e00345"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "ae828de430c1c809ba2283def2c818e7",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/All about generator.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/All about generator.md",
      "relativePath": "All about generator.md",
      "extension": "md",
      "size": 711,
      "prettySize": "711 B",
      "modifiedTime": "2019-01-23T04:07:33.752Z",
      "accessTime": "2019-01-23T04:07:54.434Z",
      "changeTime": "2019-01-23T04:07:33.752Z",
      "birthTime": "2019-01-23T04:00:06.159Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "All about generator.md",
      "ext": ".md",
      "name": "All about generator",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4096,
      "ino": 16521695,
      "blocks": 8,
      "atimeMs": 1548216474434.2676,
      "mtimeMs": 1548216453751.6328,
      "ctimeMs": 1548216453751.6328,
      "birthtimeMs": 1548216006158.727,
      "atime": "2019-01-23T04:07:54.434Z",
      "mtime": "2019-01-23T04:07:33.752Z",
      "ctime": "2019-01-23T04:07:33.752Z",
      "birthtime": "2019-01-23T04:00:06.159Z"
    },
    "6e86617b-839e-59fd-8c05-7626d88030f6": {
      "id": "6e86617b-839e-59fd-8c05-7626d88030f6",
      "children": [
        "ea8cfa21-a625-585a-a4a0-f7228c379019"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "e30da9cf8c99e3c9deb0834b12a8a2e6",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/state & props update.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/state & props update.md",
      "relativePath": "state & props update.md",
      "extension": "md",
      "size": 19397,
      "prettySize": "19.4 kB",
      "modifiedTime": "2019-01-07T12:30:47.120Z",
      "accessTime": "2019-03-16T11:02:06.161Z",
      "changeTime": "2019-03-15T12:42:48.523Z",
      "birthTime": "2019-01-07T12:24:27.053Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "state & props update.md",
      "ext": ".md",
      "name": "state & props update",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4096,
      "ino": 13873695,
      "blocks": 40,
      "atimeMs": 1552734126161.0461,
      "mtimeMs": 1546864247119.671,
      "ctimeMs": 1552653768522.5063,
      "birthtimeMs": 1546863867053.2976,
      "atime": "2019-03-16T11:02:06.161Z",
      "mtime": "2019-01-07T12:30:47.120Z",
      "ctime": "2019-03-15T12:42:48.523Z",
      "birthtime": "2019-01-07T12:24:27.053Z"
    },
    "41032e46-9ace-53d7-9bab-5db5c57c861e": {
      "id": "41032e46-9ace-53d7-9bab-5db5c57c861e",
      "children": [
        "1b09d9a5-bd3d-5b54-a015-38a243a0175e"
      ],
      "parent": "___SOURCE___",
      "internal": {
        "contentDigest": "cd2a76d339a8f5b6764a03ed19a6b6e4",
        "type": "File",
        "mediaType": "text/markdown",
        "description": "File \"src/pages/why hooks.md\"",
        "owner": "gatsby-source-filesystem"
      },
      "sourceInstanceName": "pages",
      "absolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/why hooks.md",
      "relativePath": "why hooks.md",
      "extension": "md",
      "size": 12301,
      "prettySize": "12.3 kB",
      "modifiedTime": "2019-03-18T06:44:10.288Z",
      "accessTime": "2019-03-18T06:49:08.178Z",
      "changeTime": "2019-03-18T06:44:10.288Z",
      "birthTime": "2019-03-18T02:36:09.515Z",
      "root": "/",
      "dir": "/Users/xuzhanhong1/study/overreacted.io/src/pages",
      "base": "why hooks.md",
      "ext": ".md",
      "name": "why hooks",
      "relativeDirectory": "",
      "dev": 16777220,
      "mode": 33188,
      "nlink": 1,
      "uid": 21211859,
      "gid": 1603212982,
      "rdev": 0,
      "blksize": 4096,
      "ino": 21542618,
      "blocks": 32,
      "atimeMs": 1552891748178.421,
      "mtimeMs": 1552891450287.5427,
      "ctimeMs": 1552891450287.5427,
      "birthtimeMs": 1552876569514.5745,
      "atime": "2019-03-18T06:49:08.178Z",
      "mtime": "2019-03-18T06:44:10.288Z",
      "ctime": "2019-03-18T06:44:10.288Z",
      "birthtime": "2019-03-18T02:36:09.515Z"
    },
    "55557a74-de54-5683-bd78-3de2108f3ce8": {
      "id": "55557a74-de54-5683-bd78-3de2108f3ce8",
      "children": [],
      "parent": "86ce4482-5854-58cb-aa03-bcc2906a61ea",
      "internal": {
        "content": "\n[read this](https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e)\n\n## createFiberFromTypeAndProps\n\nโ\tๅฝไธไธชReactๅ็ด็ฌฌไธๆฌก่ขซ่ฝฌๆขๆfiber nodeๆถ๏ผReactไฝฟ็จcreateFiberFromTypeAndPropsใๅจ้ๅ็ๆดๆฐไธญReactไผ้็จfiber nodeไธๅชๆดๆฐไปๅฝๅReactๅ็ด่ทๅๅฟ้กป็ๅฑๆงใReact่ฟไผๆนๆฎkeyๅฑๆงๅจ็ฎๅฝไธญ็งปๅจ็ป็นไฝ็ฝฎๆๅ้คๅฎๅฆๆreactๅ็ด็renderๆนๆณๆฒกๆ่ฟๅๅผใ\n\n>ๆฅ็[**ChildReconciler**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactChildFiber.js#L239)ๆนๆณๅพๅฐๆๆ่กๅจๅReact้ๅฏนๅฝๅ็fiber็ป็น็ฑปๅๆง่ก็็ธๅบ็ๆนๆณ\n\n## currentๅworkInProgress tree\n\nโ\t็ฌฌไธๆฌกrender็ปๆๅ๏ผReactไผ็ๆไธไธชfiber treeๆๅฐๅบ็จ็็ถๆๅUI๏ผ่ฟไธชtreeไธ่ฌๅซ`current`ใๅฝReactๅๅคๅผๅงๆดๆฐๆถไผๆๅปบไธไธช`workInProgress `tree๏ผๅๆๅฐ่ขซๆธฒๆๅฐๅฑๅน็ๅฐๆฅ็็ถๆใ\n\nโ\tๆๆ็fibersไธ็ๅทฅไฝ้ฝไผๅจworkInProgress treeไธๆง่กใๅฝReact้ๅcurrent treeๆถ๏ผๆฏไธไธชๅญๅจ็็ป็น้ฝไผๅๅปบไธไธชalternate nodeๆฅๆๆworkInProgress treeใๅฝๆดๆฐๅฎๆไธๆๆ็็ธๅณๅทฅไฝๅฎๆๆถ๏ผReactๅๅคๅฐalternate treeๆธฒๆๅฐๅฑๅนไธใไธๆฆworkInProgress tree่ขซๆธฒๆๅฐๅฑๅนไธ๏ผไปๅฐฑไผๅๆcurrent treeใ\n\nโ\tๅจไปฃ็ไธญไฝไผ่งๅฐๅพๅคๅฝๆฐ้่ฆcurrentๅworkInProgress tree๏ผ\n\n```javascript\nfunction updateHostComponent(current, workInProgress, renderExpirationTime) {...}\n```\n\nโ\tๆฏไธไธชfiber็ป็น็alternateๅฑๆงไผๆฏๅฎๅจๅฆๅคไธ้ขๆไธ็ๅฏๆฌ็ๅผ็จใไธไธชcurrent treeไธ็็ป็นไผๆๅworkInprogress treeไธ็็ป็น๏ผๅไนไบฆ็ถใ\n\n## Side-effects && Effects list\n\nโ\tๆฏไธไธชfiber็ป็นๅฏไปฅๆไธไน็ธๅณ็ไฝ็จ๏ผ่ฟไบ่ขซๆพๅจeffectTagๅญๆฎตไธญใๆไปฅfiber็effectsๅบๆฌๅฎไนไบๅฎไพๅจๆดๆฐๅฎๅ้่ฆๅค็็[ๅทฅไฝ](https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js)ใไพๅฆhost็ปไปถ๏ผDOM ๅ็ด๏ผไผๆadding, updating or removing elementsใ็ฑป็ปไปถไผๆๆดๆฐrefs๏ผ่ฐ็จcDMๅcDU็ๅฝๅจๆใ\n\nโ\tReactไผๆๅปบไธไธชๆeffects็fiber็ป็น็็บฟๆงๅ่กจๅปๅฟซ้้ๅใ้ๅ็บฟๆงๅ่กจๆฏ้ๅๆๅฟซๅพๅค๏ผไธๆฒกๅฟ่ฆ่ฑ่ดนๆถ้ดๅจๆฒกๆๅฏไฝ็จ็็ป็นไธใ่ฟไธชๅ่กจๆฏ`finishedWork`tree็ๅญ้ไธๅฎๅจcurrentๅworkInProgress treeไธญไฝฟ็จnextEffectๅฑๆง้พๆฅ่ไธๆฏchildๅฑๆงใ\n\nโ\tไพๅฆ๏ผๆไปฌ็ๆดๆฐไผๅฏผ่ด`c2`ๆๅฅๅฐDOMไธญ๏ผ`d2`ๅ`c1`ๆนๅDOMๅฑๆง๏ผ`b2`่งฆๅ็ๅฝๅจๆใeffect listไผ่ฟๆฅไปไปฌๆไปฅReactๅฏไปฅ่ทณ่ฟๅถไป็ป็นใ\n\n![img](http://pjpqjxkf6.bkt.clouddn.com/1%2AQ0pCNcK1FfCttek32X_l7A.png)\n\n![img](http://pjpqjxkf6.bkt.clouddn.com/1%2AmbeZ1EsfMsLUk-9hOYyozw.png)\n\nๅฏไปฅ็ๅพๅฐ๏ผReactไผไปchildrenๅๅฐparentsๆง่กeffectsใ\n\n## Fiber tree็ๆน่็น\n\nReactๅฏนๆฏไธไธช่ฟไบcontainerๅๅปบ[fiber root](https://github.com/facebook/react/blob/0dc0ddc1ef5f90fe48b58f1a1ba753757961fc74/packages/react-reconciler/src/ReactFiberRoot.js#L31)๏ผไฝๅฏไปฅ่ฟๆทๆพๅฐไปไปฌ\n\n```javascript\nconst fiberRoot = $('#app')._reactRootContainer._internalRoot\n```\n\n fiber root็currentๅฑๆงไธญๆฏReactๅญๆพfiber tree็ๅฐๆนใ\n\n```javascript\nconst hostRootFiberNode = fiberRoot.current\n```\n\nfiber treeไผ็จ[ไธ็ง็นๅซ็็ฑปๅ็fiber็ป็น](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/shared/ReactWorkTags.js#L34)ๅผๅง๏ผ`HostRoot`๏ผ้่ฟ`stateNode`ๅฏไปฅไป`HostRoot`fiber็ป็น่ฟๅFiberRoot\n\n```javascript\nfiberRoot.current.stateNode === fiberRoot; // true\n```\n\n## Fiber node structure\n\n### stateNode\n\nไฟๆfiberๅฏนๆฌๅฐ็ถๆ็่็ณป๏ผ ไฟๅญๅฏน็ปไปถ็็ฑปๅฎไพ๏ผDOM่็นๆไธfiber่็นๅณ่็ๅถไปReactๅ็ด็ฑปๅ็ๅผ็จใ\n\n### type\n\nๅฎไนไธๆญคfiber่็นๅณ่็ๅ่ฝๆ็ฑป๏ผๅฏนไบclass็ปไปถ๏ผๅฎๆๅconstructorๅฝๆฐ๏ผๅฏนไบDOMๅ็ด๏ผๅฎๆฏHTML tagใ\n\n### tag\n\nๅฎไน[fiber่็น็็ฑปๅ](https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/shared/ReactWorkTags.js)ใ่ขซ็จไบๅณๅฎ้่ฆๅจreconciliationไธญๅไปไนๅทฅไฝใ\n\n### updateQueue\n\n็ถๆๆดๆฐ๏ผๅ่ฐๅDOMๆดๆฐ็้ๅใ\n\n### memoizedState\n\nfiber็จไบๅๅปบ่พๅบ็stateใๅค็ๆดๆฐๆถ๏ผๅฎไผๅๆๅฝๅๅจๅฑๅนไธๅ็ฐ็็ถๆใ\n\n### memoizedProps\n\nๅจไธไธๆฌกrenderไธญfiber็จไบๅๅปบ่พๅบ็props\n\n### pendingProps\n\nๅทฒ็ปไปreactๆฐๅ็ดไธญๆดๆฐ็propsๅนถไธ้่ฆๅบ็จไบๅญ็ปไปถๆDOMๅ็ด\n\nไฝๅฏไปฅๅจ[่ฟ้](https://github.com/facebook/react/blob/6e4f7c788603dac7fccd227a4852c110b072fe16/packages/react-reconciler/src/ReactFiber.js#L78)ๆพๅฐๅฎๆด็fiber็ปๆ\n\n## ไธป่ฆๆต็จ\n\n### render้ถๆฎต\n\nreconcile้ๅธธไป`HostRoot`fiber็ป็น๏ผๅนถ้่ฟ[renderRoot](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L1132)ๆนๆณๅผๅงใไฝๆฏ๏ผReactไผๅฟซ้่ทณ่ฟๅทฒ็ปๅค็่ฟ็fiber่็น็ฅ้ไปๆพๅฐไธไธชๆชๅฎๆๅทฅไฝ็็ป็นใ \n\n#### work loop็ไธป่ฆๆญฅ้ชค\n\nโ\tๆๆfiber่็นย[ๅจwork loopไธญ](https://github.com/facebook/react/blob/f765f022534958bcf49120bf23bc1aa665e8f651/packages/react-reconciler/src/ReactFiberScheduler.js#L1136)่ขซๅค็๏ผ่ฟ้ๆฏๅๆญฅ้จๅ็work loopๅฎ็ฐ๏ผ\n\n```javascript\nfunction workLoop(isYieldy) {\n  if (!isYieldy) {\n    while (nextUnitOfWork !== null) {\n      nextUnitOfWork = performUnitOfWork(nextUnitOfWork);\n    }\n  } else {...}\n}\n```\n\n`nextUnitOfWork`ไผไฟ็ๅฏน`workInProgress`treeไธญ้่ฆๅค็็fiber่็น็ๅผ็จใๅฝReact้ๅfiber treeๆถ๏ผไผ็จ่ฟไธชๅ้ๅป็ฅๆ่ฟ้ๆฏๅฆๆๅถไปๆชๅฎๆๅทฅไฝ็fiber็ป็นใ\n\n่ฟ้ไผๆๅไธชไธป่ฆๅฝๆฐ็จไบ้ๅtreeๅๅ่ตทๆๅฎๆๅทฅไฝ๏ผ\n\n- [performUnitOfWork](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L1056)\n- [beginWork](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L1489)\n- [completeUnitOfWork](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L879)\n- [completeWork](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberCompleteWork.js#L532)\n\n![img](http://pjpqjxkf6.bkt.clouddn.com/1%2AA3-yF-3Xf47nPamFpRm64w.gif)\n\n[่ฟ้ๆฏ่ง้ข](https://vimeo.com/302222454)\n\n```javascript\nfunction performUnitOfWork(workInProgress) {\n    let next = beginWork(workInProgress);\n    if (next === null) {\n        next = completeUnitOfWork(workInProgress);\n    }\n    return next;\n}\n\nfunction beginWork(workInProgress) {\n    console.log('work performed for ' + workInProgress.name);\n    return workInProgress.child;\n```\n\nโ\tperformUnitOfWorkไปworkInProgress treeไธญๆฅๆถไธไธชfiber่็น็ถๅๅผๅง่ฐ็จbeginWorkๅทฅไฝใbeginWorkๆฏๅผๅงๆๆ้่ฆๆง่ก่กๅจ็ๅฝๆฐ๏ผไธบไบ็คบ่๏ผๆไปฌ็ฎๅ่พๅบfiber็ๅๅญๅป่ฎฐๅฝๅทฅไฝๅทฒ็ปๅฎๆใbeginWorkๆปๆฏไผ่ฟๅไธไธไธชๅค็ๅพช็ฏ็ๅญฉๅญๆ่null๏ผ\n\nโ\tๅฆๆๆไธไธไธชๅญฉๅญ๏ผไปไผ่ตไบworkLoopไธญ็nextUnitOfWorkใๅฆๆๆฒกๆๅญฉๅญ๏ผReact็ฅ้ๅทฒ็ปๅฐ่พพๅๆฏ็็ปๅฐพๆไปฅไปๅฏไปฅๅฎๆๅฝๅ่็นใไธๆฆ่็นๅฎๆ๏ผๅฎ้่ฆไธบๅๅผๅงๅฆนๆง่กๅทฅไฝๅนถๅ็ถๆฏๅๆบฏ๏ผ่ฟ้จๅไผๅจcompleteUnitOfWorkไธญๅฎๆใ\n\n```javascript\nfunction completeUnitOfWork(workInProgress) {\n    while (true) {\n        let returnFiber = workInProgress.return;\n        let siblingFiber = workInProgress.sibling;\n\n        nextUnitOfWork = completeWork(workInProgress);\n\n        if (siblingFiber !== null) {\n            // If there is a sibling, return it\n            // to perform work for this sibling\n            return siblingFiber;\n        } else if (returnFiber !== null) {\n            // If there's no more work in this returnFiber,\n            // continue the loop to complete the parent.\n            workInProgress = returnFiber;\n            continue;\n        } else {\n            // We've reached the root.\n            return null;\n        }\n    }\n}\n\nfunction completeWork(workInProgress) {\n    console.log('work completed for ' + workInProgress.name);\n    return null;\n}\n```\n\nโ\tๅจcompleteUnitOfWorkไธญ๏ผReactๅชๅฎๆไธไธไธชๅๅผ่็น็ๅทฅไฝ๏ผไปๆฒกๆๅฎๆ็ถไบฒ่็น็ๅทฅไฝใๅชๆๅจๅฎๆไปฅๅญ่็นๅผๅง็ๆๆๅๆฏๅ๏ผๆ่ฝๅฎๆ็ถ่็นๅๅๆบฏ็ๅทฅไฝใ\n\nโ\tไปๅฎ็ฐไธญๅฏไปฅ็ๅบ๏ผperformUnitOfWorkๅcompleteUnitOfWorkไธป่ฆ็จไบ่ฟญไปฃ็ฎ็๏ผ่ไธป่ฆๆดปๅจๅๅจbeginWorkๅcompleteWorkๅฝๆฐไธญ่ฟ่กใ ๅจๆฌ็ณปๅ็ไปฅไธๆ็ซไธญ๏ผๆไปฌๅฐไบ่งฃClickCounter็ปไปถๅspan่็นไผๅ็ไปไน๏ผๅไธบReactๆญฅๅฅbeginWorkๅcompleteWorkๅฝๆฐใ\n\n### commit ้ถๆฎต\n\nโ\t่ฟไธช้ถๆฎตไป[completeRoot](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L2306)ๅผๅง๏ผ ไปๆฏreactๆดๆฐDOMๅ่ฐ็จๅๅ็ๅฝๅจๆ็ๆนๆณใๅฝreact่ฟๅฅcommit้ถๆฎตๆถ๏ผไผๆไธค้ขๆๅeffects listใ็ฌฌไธ้ขๆ(current)ไปฃ่กจๅฝๅ็ๆธฒๆ็ถๆใๅจ`render`้ถๆฎตไผๆไธ้ขalternate tree่ขซ็งฐไฝ`finishedWork`ๆ`workInProgress`่กจ็คบๅณๅฐๆธฒๆๅฐๅฑๅนไธ็็ถๆใ่ฟไธชalternate tree้่ฟchildๅsiblingๆ้็ธ่ฟ๏ผไธcurrent tree็ธไผผใ\n\nโ\t็ถๅ๏ผ่ฟๆไธไธชeffects list--ๆฅ่ช`finishedWork`ๆ็่็นๅญ้ๅนถ้่ฟnextEffectๆ้้พๆฅใ่ฆ่ฎฐไฝeffect listๆฏๆง่กrenderๅฝๆฐ็็ปๆใๆธฒๆ็้็นๆฏ็กฎๅฎ้่ฆๆๅฅใๆดๆฐๆๅ้ค้ฃไบ่็น๏ผไปฅๅๅชไบ็ปไปถ้่ฆ่ฐ็จๅถ็ๅฝๅจๆๆนๆณใ่ฟๅฐฑๆฏeffect listไฝ็จใไปๆญฃๆฏcommit้ถๆฎต่ฟญไปฃ็่็น้ใ\n\n> ไธบไบdebug๏ผcurrent treeๅฏไปฅ้่ฟfiber root็currentๅญๆฎต่ทๅใfinishedWork treeๅฏไปฅ้่ฟcurrent treeไธญ็`HostFiber`่็น็alternateๅญๆฎต่ทๅ\n\nโ\tๅจcommit้ถๆฎตๆง่ก็ไธป่ฆๅฝๆฐๆฏ[commitRoot](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L523)๏ผไป็ไธป่ฆๆต็จๅฆไธ๏ผ\n\n- ๅฏนๆ`Snapshot`effect็่็น่ฐ็จ`getSnapshotBeforeUpdate`\n- ๅฏนๆ`Deletion`effect็่็น่ฐ็จ`cWU`\n- ๆง่กๆๆ็DOMๆๅฅๆดๆฐๅๅ้ค\n- ๆfinished tree่ฝฌไธบcurrent tree\n- ๅฏนๆ`Placement`effect็่็น่ฐ็จ`cDM`\n- ๅฏนๆ`Update`effect็่็น่ฐ็จ`cDU`\n\nโ\tๅจ่ฐ็จๅๅจๅ็`getSnapshotBeforeUpdate`ๆนๆณไนๅ๏ผreactไผๅจไธๆฃตๆไธญๆไบคๆๆside-effectsใไผๅๆไธคไธชpass๏ผไธๆฏๆง่กๆๆDOM(host)ๆๅฅ๏ผๆดๆฐ๏ผๅ้คๅrefๅธ่ฝฝใ็ถๅreactไผๅฐ`finishedWork` treeๅ้็ป`FiberRoot`ๅนถๅฐ`workInProgress`treeๆ่ฎฐไธบ`current`treeใ่ฟไบไผๅจcommit้ถๆฎต็็ฌฌไธๆฌกpassๅๆง่กใๆไปฅๅจ`cWU`้ถๆฎต็current่ฟๆฏๆง็๏ผไฝๆฏ`cDM/cDU`้ถๆฎตcurrentๅฐฑๆฏ`finishedWork`treeไบใ\n\n```javascript\nfunction commitRoot(root, finishedWork) {\n    commitBeforeMutationLifecycles()\n    commitAllHostEffects();\n    root.current = finishedWork;\n    commitAllLifeCycles();\n}\n```\n\nโ\tๆฏไธไธชๅญๅฝๆฐ้ฝๅฎ็ฐไบไธไธชๅพช็ฏๅป้ๅeffects listๅนถๆฃๆฅeffects็็ฑปๅ๏ผๅฝไปๆพๅฐๆณ่ฆ็๏ผๅฐฑไผๅบ็จๅฎใ\n\n#### ๅๅๅ็็ๅฝๅจๆ\n\nโ\tไพๅฆ๏ผ่ฟญไปฃeffects listๅนถๆฃๆฅๆฃๆฅ่็นๆฏๅฆๆ`Snapshot`effect็ไปฃ็๏ผ\n\n```javascript\n//ReactFiberCommitWork.js\nfunction commitBeforeMutationLifecycles() {\n    while (nextEffect !== null) {\n        const effectTag = nextEffect.effectTag;\n        if (effectTag & Snapshot) {\n            const current = nextEffect.alternate;\n            commitBeforeMutationLifeCycles(current, nextEffect);\n        }\n        nextEffect = nextEffect.nextEffect;\n    }\n}\n```\n\nๅฏนไบไธไธชclass็ปไปถ๏ผ่ฟไธชeffectๆๅณ็่ฐ็จ`getSnapshotBeforeUpdate`็ๅฝๅจๆๅฝๆฐ\n\n#### DOMๆดๆฐ\n\n[commitAllHostEffects](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L376)ๆฏreactๆง่กDOMๆดๆฐ็ๅฝๆฐใ่ฟไธชๅฝๆฐๅฎไนไบ้่ฆ่ขซๆง่ก็็ฑปๅๅนถ่งฃๆ๏ผ\n\n```javascript\nfunction commitAllHostEffects() {\n    switch (primaryEffectTag) {\n        case Placement: {\n            commitPlacement(nextEffect);\n            ...\n        }\n        case PlacementAndUpdate: {\n            commitPlacement(nextEffect);\n            commitWork(current, nextEffect);\n            ...\n        }\n        case Update: {\n            commitWork(current, nextEffect);\n            ...\n        }\n        case Deletion: {\n            commitDeletion(nextEffect);\n            ...\n        }\n    }\n}\n```\n\nๆๆๆ็ๆฏReactๆฏๅจ`commitDeletion`ๅฝๆฐไธญไฝไธบๅ้ค็ไธ้จๅ่ฐ็จ`cWU`็\n\n#### ๅๅๅ็็ๅฝๅจๆ\n\n[commitAllLifecycles](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L465)ๆฏreact่ฐ็จๆๆๅฉไธ็็ๅฝๅจๆๆนๆณๅฆ`cDU`ๅ`cDM`\n\n",
        "type": "MarkdownRemark",
        "contentDigest": "a5f93acd9ae83c423f7a6bede87d6654",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "Inside Fiber",
        "date": "2018-12-22",
        "spoiler": "ๅฝๆไปฌๅจ่ฎจ่ฎบFiberๆถ๏ผๆไปฌๅจ่ฎจ่ฎบไปไนใ",
        "_PARENT": "86ce4482-5854-58cb-aa03-bcc2906a61ea"
      },
      "excerpt": "",
      "rawMarkdownBody": "\n[read this](https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e)\n\n## createFiberFromTypeAndProps\n\nโ\tๅฝไธไธชReactๅ็ด็ฌฌไธๆฌก่ขซ่ฝฌๆขๆfiber nodeๆถ๏ผReactไฝฟ็จcreateFiberFromTypeAndPropsใๅจ้ๅ็ๆดๆฐไธญReactไผ้็จfiber nodeไธๅชๆดๆฐไปๅฝๅReactๅ็ด่ทๅๅฟ้กป็ๅฑๆงใReact่ฟไผๆนๆฎkeyๅฑๆงๅจ็ฎๅฝไธญ็งปๅจ็ป็นไฝ็ฝฎๆๅ้คๅฎๅฆๆreactๅ็ด็renderๆนๆณๆฒกๆ่ฟๅๅผใ\n\n>ๆฅ็[**ChildReconciler**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactChildFiber.js#L239)ๆนๆณๅพๅฐๆๆ่กๅจๅReact้ๅฏนๅฝๅ็fiber็ป็น็ฑปๅๆง่ก็็ธๅบ็ๆนๆณ\n\n## currentๅworkInProgress tree\n\nโ\t็ฌฌไธๆฌกrender็ปๆๅ๏ผReactไผ็ๆไธไธชfiber treeๆๅฐๅบ็จ็็ถๆๅUI๏ผ่ฟไธชtreeไธ่ฌๅซ`current`ใๅฝReactๅๅคๅผๅงๆดๆฐๆถไผๆๅปบไธไธช`workInProgress `tree๏ผๅๆๅฐ่ขซๆธฒๆๅฐๅฑๅน็ๅฐๆฅ็็ถๆใ\n\nโ\tๆๆ็fibersไธ็ๅทฅไฝ้ฝไผๅจworkInProgress treeไธๆง่กใๅฝReact้ๅcurrent treeๆถ๏ผๆฏไธไธชๅญๅจ็็ป็น้ฝไผๅๅปบไธไธชalternate nodeๆฅๆๆworkInProgress treeใๅฝๆดๆฐๅฎๆไธๆๆ็็ธๅณๅทฅไฝๅฎๆๆถ๏ผReactๅๅคๅฐalternate treeๆธฒๆๅฐๅฑๅนไธใไธๆฆworkInProgress tree่ขซๆธฒๆๅฐๅฑๅนไธ๏ผไปๅฐฑไผๅๆcurrent treeใ\n\nโ\tๅจไปฃ็ไธญไฝไผ่งๅฐๅพๅคๅฝๆฐ้่ฆcurrentๅworkInProgress tree๏ผ\n\n```javascript\nfunction updateHostComponent(current, workInProgress, renderExpirationTime) {...}\n```\n\nโ\tๆฏไธไธชfiber็ป็น็alternateๅฑๆงไผๆฏๅฎๅจๅฆๅคไธ้ขๆไธ็ๅฏๆฌ็ๅผ็จใไธไธชcurrent treeไธ็็ป็นไผๆๅworkInprogress treeไธ็็ป็น๏ผๅไนไบฆ็ถใ\n\n## Side-effects && Effects list\n\nโ\tๆฏไธไธชfiber็ป็นๅฏไปฅๆไธไน็ธๅณ็ไฝ็จ๏ผ่ฟไบ่ขซๆพๅจeffectTagๅญๆฎตไธญใๆไปฅfiber็effectsๅบๆฌๅฎไนไบๅฎไพๅจๆดๆฐๅฎๅ้่ฆๅค็็[ๅทฅไฝ](https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js)ใไพๅฆhost็ปไปถ๏ผDOM ๅ็ด๏ผไผๆadding, updating or removing elementsใ็ฑป็ปไปถไผๆๆดๆฐrefs๏ผ่ฐ็จcDMๅcDU็ๅฝๅจๆใ\n\nโ\tReactไผๆๅปบไธไธชๆeffects็fiber็ป็น็็บฟๆงๅ่กจๅปๅฟซ้้ๅใ้ๅ็บฟๆงๅ่กจๆฏ้ๅๆๅฟซๅพๅค๏ผไธๆฒกๅฟ่ฆ่ฑ่ดนๆถ้ดๅจๆฒกๆๅฏไฝ็จ็็ป็นไธใ่ฟไธชๅ่กจๆฏ`finishedWork`tree็ๅญ้ไธๅฎๅจcurrentๅworkInProgress treeไธญไฝฟ็จnextEffectๅฑๆง้พๆฅ่ไธๆฏchildๅฑๆงใ\n\nโ\tไพๅฆ๏ผๆไปฌ็ๆดๆฐไผๅฏผ่ด`c2`ๆๅฅๅฐDOMไธญ๏ผ`d2`ๅ`c1`ๆนๅDOMๅฑๆง๏ผ`b2`่งฆๅ็ๅฝๅจๆใeffect listไผ่ฟๆฅไปไปฌๆไปฅReactๅฏไปฅ่ทณ่ฟๅถไป็ป็นใ\n\n![img](http://pjpqjxkf6.bkt.clouddn.com/1%2AQ0pCNcK1FfCttek32X_l7A.png)\n\n![img](http://pjpqjxkf6.bkt.clouddn.com/1%2AmbeZ1EsfMsLUk-9hOYyozw.png)\n\nๅฏไปฅ็ๅพๅฐ๏ผReactไผไปchildrenๅๅฐparentsๆง่กeffectsใ\n\n## Fiber tree็ๆน่็น\n\nReactๅฏนๆฏไธไธช่ฟไบcontainerๅๅปบ[fiber root](https://github.com/facebook/react/blob/0dc0ddc1ef5f90fe48b58f1a1ba753757961fc74/packages/react-reconciler/src/ReactFiberRoot.js#L31)๏ผไฝๅฏไปฅ่ฟๆทๆพๅฐไปไปฌ\n\n```javascript\nconst fiberRoot = $('#app')._reactRootContainer._internalRoot\n```\n\n fiber root็currentๅฑๆงไธญๆฏReactๅญๆพfiber tree็ๅฐๆนใ\n\n```javascript\nconst hostRootFiberNode = fiberRoot.current\n```\n\nfiber treeไผ็จ[ไธ็ง็นๅซ็็ฑปๅ็fiber็ป็น](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/shared/ReactWorkTags.js#L34)ๅผๅง๏ผ`HostRoot`๏ผ้่ฟ`stateNode`ๅฏไปฅไป`HostRoot`fiber็ป็น่ฟๅFiberRoot\n\n```javascript\nfiberRoot.current.stateNode === fiberRoot; // true\n```\n\n## Fiber node structure\n\n### stateNode\n\nไฟๆfiberๅฏนๆฌๅฐ็ถๆ็่็ณป๏ผ ไฟๅญๅฏน็ปไปถ็็ฑปๅฎไพ๏ผDOM่็นๆไธfiber่็นๅณ่็ๅถไปReactๅ็ด็ฑปๅ็ๅผ็จใ\n\n### type\n\nๅฎไนไธๆญคfiber่็นๅณ่็ๅ่ฝๆ็ฑป๏ผๅฏนไบclass็ปไปถ๏ผๅฎๆๅconstructorๅฝๆฐ๏ผๅฏนไบDOMๅ็ด๏ผๅฎๆฏHTML tagใ\n\n### tag\n\nๅฎไน[fiber่็น็็ฑปๅ](https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/shared/ReactWorkTags.js)ใ่ขซ็จไบๅณๅฎ้่ฆๅจreconciliationไธญๅไปไนๅทฅไฝใ\n\n### updateQueue\n\n็ถๆๆดๆฐ๏ผๅ่ฐๅDOMๆดๆฐ็้ๅใ\n\n### memoizedState\n\nfiber็จไบๅๅปบ่พๅบ็stateใๅค็ๆดๆฐๆถ๏ผๅฎไผๅๆๅฝๅๅจๅฑๅนไธๅ็ฐ็็ถๆใ\n\n### memoizedProps\n\nๅจไธไธๆฌกrenderไธญfiber็จไบๅๅปบ่พๅบ็props\n\n### pendingProps\n\nๅทฒ็ปไปreactๆฐๅ็ดไธญๆดๆฐ็propsๅนถไธ้่ฆๅบ็จไบๅญ็ปไปถๆDOMๅ็ด\n\nไฝๅฏไปฅๅจ[่ฟ้](https://github.com/facebook/react/blob/6e4f7c788603dac7fccd227a4852c110b072fe16/packages/react-reconciler/src/ReactFiber.js#L78)ๆพๅฐๅฎๆด็fiber็ปๆ\n\n## ไธป่ฆๆต็จ\n\n### render้ถๆฎต\n\nreconcile้ๅธธไป`HostRoot`fiber็ป็น๏ผๅนถ้่ฟ[renderRoot](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L1132)ๆนๆณๅผๅงใไฝๆฏ๏ผReactไผๅฟซ้่ทณ่ฟๅทฒ็ปๅค็่ฟ็fiber่็น็ฅ้ไปๆพๅฐไธไธชๆชๅฎๆๅทฅไฝ็็ป็นใ \n\n#### work loop็ไธป่ฆๆญฅ้ชค\n\nโ\tๆๆfiber่็นย[ๅจwork loopไธญ](https://github.com/facebook/react/blob/f765f022534958bcf49120bf23bc1aa665e8f651/packages/react-reconciler/src/ReactFiberScheduler.js#L1136)่ขซๅค็๏ผ่ฟ้ๆฏๅๆญฅ้จๅ็work loopๅฎ็ฐ๏ผ\n\n```javascript\nfunction workLoop(isYieldy) {\n  if (!isYieldy) {\n    while (nextUnitOfWork !== null) {\n      nextUnitOfWork = performUnitOfWork(nextUnitOfWork);\n    }\n  } else {...}\n}\n```\n\n`nextUnitOfWork`ไผไฟ็ๅฏน`workInProgress`treeไธญ้่ฆๅค็็fiber่็น็ๅผ็จใๅฝReact้ๅfiber treeๆถ๏ผไผ็จ่ฟไธชๅ้ๅป็ฅๆ่ฟ้ๆฏๅฆๆๅถไปๆชๅฎๆๅทฅไฝ็fiber็ป็นใ\n\n่ฟ้ไผๆๅไธชไธป่ฆๅฝๆฐ็จไบ้ๅtreeๅๅ่ตทๆๅฎๆๅทฅไฝ๏ผ\n\n- [performUnitOfWork](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L1056)\n- [beginWork](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L1489)\n- [completeUnitOfWork](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L879)\n- [completeWork](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberCompleteWork.js#L532)\n\n![img](http://pjpqjxkf6.bkt.clouddn.com/1%2AA3-yF-3Xf47nPamFpRm64w.gif)\n\n[่ฟ้ๆฏ่ง้ข](https://vimeo.com/302222454)\n\n```javascript\nfunction performUnitOfWork(workInProgress) {\n    let next = beginWork(workInProgress);\n    if (next === null) {\n        next = completeUnitOfWork(workInProgress);\n    }\n    return next;\n}\n\nfunction beginWork(workInProgress) {\n    console.log('work performed for ' + workInProgress.name);\n    return workInProgress.child;\n```\n\nโ\tperformUnitOfWorkไปworkInProgress treeไธญๆฅๆถไธไธชfiber่็น็ถๅๅผๅง่ฐ็จbeginWorkๅทฅไฝใbeginWorkๆฏๅผๅงๆๆ้่ฆๆง่ก่กๅจ็ๅฝๆฐ๏ผไธบไบ็คบ่๏ผๆไปฌ็ฎๅ่พๅบfiber็ๅๅญๅป่ฎฐๅฝๅทฅไฝๅทฒ็ปๅฎๆใbeginWorkๆปๆฏไผ่ฟๅไธไธไธชๅค็ๅพช็ฏ็ๅญฉๅญๆ่null๏ผ\n\nโ\tๅฆๆๆไธไธไธชๅญฉๅญ๏ผไปไผ่ตไบworkLoopไธญ็nextUnitOfWorkใๅฆๆๆฒกๆๅญฉๅญ๏ผReact็ฅ้ๅทฒ็ปๅฐ่พพๅๆฏ็็ปๅฐพๆไปฅไปๅฏไปฅๅฎๆๅฝๅ่็นใไธๆฆ่็นๅฎๆ๏ผๅฎ้่ฆไธบๅๅผๅงๅฆนๆง่กๅทฅไฝๅนถๅ็ถๆฏๅๆบฏ๏ผ่ฟ้จๅไผๅจcompleteUnitOfWorkไธญๅฎๆใ\n\n```javascript\nfunction completeUnitOfWork(workInProgress) {\n    while (true) {\n        let returnFiber = workInProgress.return;\n        let siblingFiber = workInProgress.sibling;\n\n        nextUnitOfWork = completeWork(workInProgress);\n\n        if (siblingFiber !== null) {\n            // If there is a sibling, return it\n            // to perform work for this sibling\n            return siblingFiber;\n        } else if (returnFiber !== null) {\n            // If there's no more work in this returnFiber,\n            // continue the loop to complete the parent.\n            workInProgress = returnFiber;\n            continue;\n        } else {\n            // We've reached the root.\n            return null;\n        }\n    }\n}\n\nfunction completeWork(workInProgress) {\n    console.log('work completed for ' + workInProgress.name);\n    return null;\n}\n```\n\nโ\tๅจcompleteUnitOfWorkไธญ๏ผReactๅชๅฎๆไธไธไธชๅๅผ่็น็ๅทฅไฝ๏ผไปๆฒกๆๅฎๆ็ถไบฒ่็น็ๅทฅไฝใๅชๆๅจๅฎๆไปฅๅญ่็นๅผๅง็ๆๆๅๆฏๅ๏ผๆ่ฝๅฎๆ็ถ่็นๅๅๆบฏ็ๅทฅไฝใ\n\nโ\tไปๅฎ็ฐไธญๅฏไปฅ็ๅบ๏ผperformUnitOfWorkๅcompleteUnitOfWorkไธป่ฆ็จไบ่ฟญไปฃ็ฎ็๏ผ่ไธป่ฆๆดปๅจๅๅจbeginWorkๅcompleteWorkๅฝๆฐไธญ่ฟ่กใ ๅจๆฌ็ณปๅ็ไปฅไธๆ็ซไธญ๏ผๆไปฌๅฐไบ่งฃClickCounter็ปไปถๅspan่็นไผๅ็ไปไน๏ผๅไธบReactๆญฅๅฅbeginWorkๅcompleteWorkๅฝๆฐใ\n\n### commit ้ถๆฎต\n\nโ\t่ฟไธช้ถๆฎตไป[completeRoot](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L2306)ๅผๅง๏ผ ไปๆฏreactๆดๆฐDOMๅ่ฐ็จๅๅ็ๅฝๅจๆ็ๆนๆณใๅฝreact่ฟๅฅcommit้ถๆฎตๆถ๏ผไผๆไธค้ขๆๅeffects listใ็ฌฌไธ้ขๆ(current)ไปฃ่กจๅฝๅ็ๆธฒๆ็ถๆใๅจ`render`้ถๆฎตไผๆไธ้ขalternate tree่ขซ็งฐไฝ`finishedWork`ๆ`workInProgress`่กจ็คบๅณๅฐๆธฒๆๅฐๅฑๅนไธ็็ถๆใ่ฟไธชalternate tree้่ฟchildๅsiblingๆ้็ธ่ฟ๏ผไธcurrent tree็ธไผผใ\n\nโ\t็ถๅ๏ผ่ฟๆไธไธชeffects list--ๆฅ่ช`finishedWork`ๆ็่็นๅญ้ๅนถ้่ฟnextEffectๆ้้พๆฅใ่ฆ่ฎฐไฝeffect listๆฏๆง่กrenderๅฝๆฐ็็ปๆใๆธฒๆ็้็นๆฏ็กฎๅฎ้่ฆๆๅฅใๆดๆฐๆๅ้ค้ฃไบ่็น๏ผไปฅๅๅชไบ็ปไปถ้่ฆ่ฐ็จๅถ็ๅฝๅจๆๆนๆณใ่ฟๅฐฑๆฏeffect listไฝ็จใไปๆญฃๆฏcommit้ถๆฎต่ฟญไปฃ็่็น้ใ\n\n> ไธบไบdebug๏ผcurrent treeๅฏไปฅ้่ฟfiber root็currentๅญๆฎต่ทๅใfinishedWork treeๅฏไปฅ้่ฟcurrent treeไธญ็`HostFiber`่็น็alternateๅญๆฎต่ทๅ\n\nโ\tๅจcommit้ถๆฎตๆง่ก็ไธป่ฆๅฝๆฐๆฏ[commitRoot](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L523)๏ผไป็ไธป่ฆๆต็จๅฆไธ๏ผ\n\n- ๅฏนๆ`Snapshot`effect็่็น่ฐ็จ`getSnapshotBeforeUpdate`\n- ๅฏนๆ`Deletion`effect็่็น่ฐ็จ`cWU`\n- ๆง่กๆๆ็DOMๆๅฅๆดๆฐๅๅ้ค\n- ๆfinished tree่ฝฌไธบcurrent tree\n- ๅฏนๆ`Placement`effect็่็น่ฐ็จ`cDM`\n- ๅฏนๆ`Update`effect็่็น่ฐ็จ`cDU`\n\nโ\tๅจ่ฐ็จๅๅจๅ็`getSnapshotBeforeUpdate`ๆนๆณไนๅ๏ผreactไผๅจไธๆฃตๆไธญๆไบคๆๆside-effectsใไผๅๆไธคไธชpass๏ผไธๆฏๆง่กๆๆDOM(host)ๆๅฅ๏ผๆดๆฐ๏ผๅ้คๅrefๅธ่ฝฝใ็ถๅreactไผๅฐ`finishedWork` treeๅ้็ป`FiberRoot`ๅนถๅฐ`workInProgress`treeๆ่ฎฐไธบ`current`treeใ่ฟไบไผๅจcommit้ถๆฎต็็ฌฌไธๆฌกpassๅๆง่กใๆไปฅๅจ`cWU`้ถๆฎต็current่ฟๆฏๆง็๏ผไฝๆฏ`cDM/cDU`้ถๆฎตcurrentๅฐฑๆฏ`finishedWork`treeไบใ\n\n```javascript\nfunction commitRoot(root, finishedWork) {\n    commitBeforeMutationLifecycles()\n    commitAllHostEffects();\n    root.current = finishedWork;\n    commitAllLifeCycles();\n}\n```\n\nโ\tๆฏไธไธชๅญๅฝๆฐ้ฝๅฎ็ฐไบไธไธชๅพช็ฏๅป้ๅeffects listๅนถๆฃๆฅeffects็็ฑปๅ๏ผๅฝไปๆพๅฐๆณ่ฆ็๏ผๅฐฑไผๅบ็จๅฎใ\n\n#### ๅๅๅ็็ๅฝๅจๆ\n\nโ\tไพๅฆ๏ผ่ฟญไปฃeffects listๅนถๆฃๆฅๆฃๆฅ่็นๆฏๅฆๆ`Snapshot`effect็ไปฃ็๏ผ\n\n```javascript\n//ReactFiberCommitWork.js\nfunction commitBeforeMutationLifecycles() {\n    while (nextEffect !== null) {\n        const effectTag = nextEffect.effectTag;\n        if (effectTag & Snapshot) {\n            const current = nextEffect.alternate;\n            commitBeforeMutationLifeCycles(current, nextEffect);\n        }\n        nextEffect = nextEffect.nextEffect;\n    }\n}\n```\n\nๅฏนไบไธไธชclass็ปไปถ๏ผ่ฟไธชeffectๆๅณ็่ฐ็จ`getSnapshotBeforeUpdate`็ๅฝๅจๆๅฝๆฐ\n\n#### DOMๆดๆฐ\n\n[commitAllHostEffects](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L376)ๆฏreactๆง่กDOMๆดๆฐ็ๅฝๆฐใ่ฟไธชๅฝๆฐๅฎไนไบ้่ฆ่ขซๆง่ก็็ฑปๅๅนถ่งฃๆ๏ผ\n\n```javascript\nfunction commitAllHostEffects() {\n    switch (primaryEffectTag) {\n        case Placement: {\n            commitPlacement(nextEffect);\n            ...\n        }\n        case PlacementAndUpdate: {\n            commitPlacement(nextEffect);\n            commitWork(current, nextEffect);\n            ...\n        }\n        case Update: {\n            commitWork(current, nextEffect);\n            ...\n        }\n        case Deletion: {\n            commitDeletion(nextEffect);\n            ...\n        }\n    }\n}\n```\n\nๆๆๆ็ๆฏReactๆฏๅจ`commitDeletion`ๅฝๆฐไธญไฝไธบๅ้ค็ไธ้จๅ่ฐ็จ`cWU`็\n\n#### ๅๅๅ็็ๅฝๅจๆ\n\n[commitAllLifecycles](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L465)ๆฏreact่ฐ็จๆๆๅฉไธ็็ๅฝๅจๆๆนๆณๅฆ`cDU`ๅ`cDM`\n\n",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/Inside Fiber.md",
      "fields": {
        "slug": "/Inside Fiber/"
      }
    },
    "47075887-16be-50c6-96fc-5d6e79e00345": {
      "id": "47075887-16be-50c6-96fc-5d6e79e00345",
      "children": [],
      "parent": "9238919a-ba8b-5c13-9887-625986ceb5cd",
      "internal": {
        "content": "\n## co็ๅบๆฌๅฎ็ฐ\n\n```javascript\nconst get = (url)=> {\n  return fetch(url).then(function(response) {\n    return response.json();\n  })\n}\n\nfunction* getData(){\n  let data = yield get('https://api.github.com/users/github')\n  console.log(data)\n  return data\n}\n\nconst co = (gen) => {\n  ctx = gen()\n  return new Promise((resolve, reject)=>{\n    const temp = (value)=> {\n      let val = ctx.next(value)\n      console.log('temp', value, val)\n      if(val.done){\n        return resolve(val.value)\n      }\n      val.value.then(data=>temp(data))\n    }\n    temp()\n  })\n}\nco(getData).then(data=> {console.log(\"!!!!\",data) })\n```",
        "type": "MarkdownRemark",
        "contentDigest": "1994cb00b4089fa4dbd825e67f5be746",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "All about generator",
        "date": "2019-01-23",
        "spoiler": "้ๆฐๅญฆไนjavaScriptๅผๆญฅ",
        "_PARENT": "9238919a-ba8b-5c13-9887-625986ceb5cd"
      },
      "excerpt": "",
      "rawMarkdownBody": "\n## co็ๅบๆฌๅฎ็ฐ\n\n```javascript\nconst get = (url)=> {\n  return fetch(url).then(function(response) {\n    return response.json();\n  })\n}\n\nfunction* getData(){\n  let data = yield get('https://api.github.com/users/github')\n  console.log(data)\n  return data\n}\n\nconst co = (gen) => {\n  ctx = gen()\n  return new Promise((resolve, reject)=>{\n    const temp = (value)=> {\n      let val = ctx.next(value)\n      console.log('temp', value, val)\n      if(val.done){\n        return resolve(val.value)\n      }\n      val.value.then(data=>temp(data))\n    }\n    temp()\n  })\n}\nco(getData).then(data=> {console.log(\"!!!!\",data) })\n```",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/All about generator.md",
      "fields": {
        "slug": "/All about generator/"
      }
    },
    "ea8cfa21-a625-585a-a4a0-f7228c379019": {
      "id": "ea8cfa21-a625-585a-a4a0-f7228c379019",
      "children": [],
      "parent": "6e86617b-839e-59fd-8c05-7626d88030f6",
      "internal": {
        "content": "\nDemo:\n\nhttps://stackblitz.com/edit/react-jwqn64\n\n```jsx\nclass ClickCounter extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {count: 0};\n        this.handleClick = this.handleClick.bind(this);\n    }\n\n    handleClick() {\n        this.setState((state) => {\n            return {count: state.count + 1};\n        });\n    }\n    \n    componentDidUpdate() {}\n\n    render() {\n        return [\n            <button key=\"1\" onClick={this.handleClick}>Update counter</button>,\n            <span key=\"2\">{this.state.count}</span>\n        ]\n    }\n}\n```\n\nๅฝๆไปฌ็นๅปbuttonๆถ๏ผๆไปฌๅฏไปฅ็ๅฐ[**completeWork**](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberCompleteWork.js#L532)๏ผ\n\n* ๆดๆฐ`ClickCounter`ไธญ็count state\n* ่ฐ็จ`render`ๆนๆณๅปๅพๅฐchildrenๅ่กจๅนถๆง่กๆฏ่พ\n* ๆดๆฐ`span`ๅ็ด็props\n\nๅจ[**commitRoot**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L523)๏ผ\n\n* ๆดๆฐ`span`ๅ็ด็`textContent`ๅฑๆง\n* ่ฐ็จ`cDU`\n\n## render้ถๆฎต\n\n### Scheduling updates๏ผๅฎๆๆดๆฐ๏ผ\n\nโ\tๅฝๆไปฌ็นๅปๆ้ฎ๏ผไผ่งฆๅ็นๅปไบไปถ็ถๅreact่งฃๆๆไปฌไผ็ปๆ้ฎprops็callbackใๅจ่ฟไธชๅบ็จไธญcallbackๆฏๅขๅcounterๅนถๆดๆฐstateใ\n\n```jsx\nclass ClickCounter extends React.Component {\n    //...\n    handleClick() {\n        this.setState((state) => {\n            return {count: state.count + 1};\n        });\n    }\n}   \n```\n\nโ\t\tๆฏไธไธชReact็ปไปถ้ฝๆไธไธช`updater`ไฝไธบ็ปไปถๅreactๆธๅฟ้ไฟก็ๆกฅๆขใไปๅ่ฎธ`setState`ๅจไธๅ็็ฏๅขไธ๏ผReactDOM๏ผRN๏ผ SSR๏ผ test๏ผๅฎ็ฐไธๅ็ๆๆ\n\n> ๆณจ๏ผๅณไบupdater๏ผๅฏไปฅๅณ่ๅญฆไนdanๅคง็ฅๅๅฎข็[How Does setState Know What to Do?]( https://overreacted.io/how-does-setstate-know-what-to-do/) \n\nโ\tๅจ่ฟ็ฏๆ็ซไธญ๏ผๆไปฌไผไพง้ReactDom็ไฝฟ็จไบFiber reconciler็updaterๅฎ็ฐ๏ผๅฏนไบ`ClickCounter`็ปไปถๆฏ[**classComponentUpdater**](https://github.com/facebook/react/blob/6938dcaacbffb901df27782b7821836961a5b68d/packages/react-reconciler/src/ReactFiberClassComponent.js#L186)๏ผไป่ด่ดฃๆฃ็ดขfiberๅฎไพ๏ผ้ๅๆดๆฐๅๅฎๆๅทฅไฝใ\n\nโ\tๅฝๆดๆฐๆ้ๆถ๏ผไปไปฌๅบๆฌไธๅชๆฏ่ขซๆทปๅๅฐfiber่็นไธๅค็็ๆดๆฐ้ๅไธญใๅจๆไปฌ็ๅฎไพไธญ๏ผไธClickCounter็ปไปถๅฏนๅบ็fiber่็นๆไปฅไธ็็ปๆ\n\n```javascript\n{\n    stateNode: new ClickCounter,\n    type: ClickCounter,\n    updateQueue: {\n         baseState: {count: 0}\n         firstUpdate: {\n             next: {\n                 payload: (state) => { return {count: state.count + 1} }\n             }\n         },\n         ...\n     },\n     ...\n}\n```\n\nๆไปฌๅฏไปฅ็ๅฐ๏ผ`updateQueue.firstUpdate.next.payload`ไธญ็ๅฝๆฐๆฏๆไปฌไผ็ป`ClickCounter`็ปไปถไธญsetState็callbackใไป่กจ็คบๅจrender้ถๆฎต้่ฆ่ขซๅค็็็ฌฌไธไธชๆดๆฐใ\n\n### ๅค็ClickCounter Fiber็ป็น็ๆดๆฐ\n\nโ\tๆไปฌๅทฒ็ปๆไธไธชClickCounterๅฎไพ๏ผๆไปฅๆไปฌ่ฟๅฅ[**updateClassInstance**](https://github.com/facebook/react/blob/6938dcaacbffb901df27782b7821836961a5b68d/packages/react-reconciler/src/ReactFiberClassComponent.js#L976)ๅฝๆฐ๏ผ่ฟ้ๆฏreactๅฏนclass็ปไปถๆง่กๆๅคๆไฝ็ๅฝๆฐใไปฅไธๆฏๆๆง่ก้กบๅบๅจๅฝๆฐไธญๆง่ก็ๆ้่ฆ็ๆไฝ๏ผ\n\n* ่ฐ็จ**UNSAFE_componentWillReceiveProps**้ฉๅญ๏ผๅจreact v17ไธญๅผ็จ๏ผ\n* ๆง่ก**updateQueue**ไธญ็ๆดๆฐๅนถ็ๆๆฐ็state\n* ็จๆฐ็state่ฐ็จ**getDerivedStateFromProps**ๅนถๅพๅฐ็ปๆ\n* ่ฐ็จ**sCU**็กฎๅฎไธไธช็ปไปถๆฏๅฆ้่ฆๆดๆฐ๏ผๅฆๆ**false**๏ผ่ทณ่ฟๆดไธชๆธฒๆ่ฟ็จ\n* ่ฐ็จ**UNSAFE_componentWillUpdate**้ฉๅญ๏ผๅจreact v17ไธญๅผ็จ๏ผ\n* ๆทปๅไธไธชeffectๅป่งฆๅ**componentDidUpdate**้ฉๅญ\n\n> **cDU**่ฟไธชeffectๅจ**render**้ถๆฎตไธญ่ขซๆทปๅ๏ผไฝๆฏๅจ**commit**ไธญๆง่ก\n\n* ๆดๆฐ็ปไปถๅฎไพ็**state**ๅ**props**\n\nๅฝๆฐ็ฎๅๅๅฆไธ๏ผ\n\n```javascript\nfunction updateClassInstance(current, workInProgress, ctor, newProps, ...) {\n    const instance = workInProgress.stateNode;\n\n    const oldProps = workInProgress.memoizedProps;\n    instance.props = oldProps;\n    if (oldProps !== newProps) {\n        callComponentWillReceiveProps(workInProgress, instance, newProps, ...);\n    }\n\n    let updateQueue = workInProgress.updateQueue;\n    if (updateQueue !== null) {\n        processUpdateQueue(workInProgress, updateQueue, ...);\n        newState = workInProgress.memoizedState;\n    }\n\n    applyDerivedStateFromProps(workInProgress, ...);\n    newState = workInProgress.memoizedState;\n\n    const shouldUpdate = checkShouldComponentUpdate(workInProgress, ctor, ...);\n    if (shouldUpdate) {\n        instance.componentWillUpdate(newProps, newState, nextContext);\n        workInProgress.effectTag |= Update;\n        workInProgress.effectTag |= Snapshot;\n    }\n\n    instance.props = newProps;\n    instance.state = newState;\n\n    return shouldUpdate;\n}\n```\n\nไธ้ข็ไปฃ็็ๆฎต็งป้คไบไธไบ่พๅฉไปฃ็ใไพๅฆ๏ผๅจ่ฐ็จ็ๅฝๅจๆๆนๆณๆๆทปๅeffectๆฅ่งฆๅๅฎไปฌๆถ๏ผreactไผ็จ**typeof**ๆฃๆฅไธไธช็ปไปถๆฏๅฆๅฎ็ฐไบ่ฟไบๆนๆณใไธ้ขๆฏreactๅจๆทปๅeffectๅๆฃๆฅ**cDU**ๆนๆณ\n\n```javascript\nif (typeof instance.componentDidUpdate === 'function') {\n    workInProgress.effectTag |= Update;\n}\n```\n\nๅฅฝ็๏ผ็ฐๅจๆไปฌ็ฅ้ๅจrender้ถๆฎต**ClickCounter**ไผๆง่กไปไนๆไฝ๏ผ็ฐๅจ่ฎฉๆไปฌ็็่ฟไบๆไฝๆฏๆไนๆนๅfiber่็น็ๅผใๅฝreactๅผๅงๅทฅไฝๅ๏ผ**ClickCounter**็fiber่็น๏ผ\n\n```javascript\n{\n    effectTag: 0,\n    elementType: class ClickCounter,\n    firstEffect: null,\n    memoizedState: {count: 0},\n    type: class ClickCounter,\n    stateNode: {\n        state: {count: 0}\n    },\n    updateQueue: {\n        baseState: {count: 0},\n        firstUpdate: {\n            next: {\n                payload: (state, props) => {โฆ}\n            }\n        },\n        ...\n    }\n}\n```\n\nๅจๅทฅไฝๅฎๆๅ๏ผfiber่็นๆฏ่ฟๆท็๏ผ\n\n```javascript\n{\n    effectTag: 4,\n    elementType: class ClickCounter,\n    firstEffect: null,\n    memoizedState: {count: 1},\n    type: class ClickCounter,\n    stateNode: {\n        state: {count: 1}\n    },\n    updateQueue: {\n        baseState: {count: 1},\n        firstUpdate: null,\n        ...\n    }\n}\n```\n\nๅจๆดๆฐ่ขซๆง่กๅ๏ผ**count**็ๅผๅจ**memoized**ๅ**updateQueue**ไธญ็**baseState**ๅๆไบ**1**ใreactไนๆดๆฐไบ**ClickCounter**็ปไปถๅฎไพไธญ็state(stateNode)ใ\n\nๅจ่ฟไธชๆถๅ๏ผ้ๅไธญๅทฒ็ปๆฒกๆๆดๆฐไบ๏ผๆไปฅ**firstUpdate**ๆฏ**null**ใ่ไธ**effectTag**ไป0->4๏ผไบ่ฟๅถไธญๆฏ100๏ผๅณ็ฌฌไธไฝ่ฎพไบ1๏ผๆไนๆฏย[side-effect tag](https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js)ไธญ็**Update**:\n\n```javascript\nexport const Update = 0b00000000100;\n```\n\nๆป็ป๏ผๅฝๅจๅค็ClickCounter fiber่็นๆถ๏ผreact่ฐ็จๆดๆฐๅ็็ๅฝๅจๆ๏ผๆดๆฐstateๅๅฎไน็ธๅบ็side-effectsใ\n\n### Reconciling children for the ClickCounter Fiber\n\nไธไธๆญฅ๏ผreactๅผๅงย[finishClassComponent](https://github.com/facebook/react/blob/340bfd9393e8173adca5380e6587e1ea1a23cefa/packages/react-reconciler/src/ReactFiberBeginWork.js#L355)๏ผๅจ่ฟ้reactไผ่ฐ็จreact็ปไปถๅฎไพ็**render**ๆนๆณๅนถๅจ็ปไปถ่ฟๅ็็ๅญฉๅญไธๅบ็จdiff็ฎๆณใๆด้ซ้ถ็ๆฆ่ฟฐๅจ่ฟไธช[ๆๆกฃ](https://reactjs.org/docs/reconciliation.html#the-diffing-algorithm)ใ\n\n> ๅฝๆฏ่พไธคไธช็ธๅ็ฑปๅ็React DOMๅ็ดๆถ๏ผReactๆฅ็ไธค่็ๅฑๆง๏ผไฟๆ็ธๅ็ๅบๅฑDOM่็น๏ผๅนถไปๆดๆฐๆดๆน็ๅฑๆงใ\n\nๅฆๆๆไปฌๆทฑๅฅๆๆ๏ผๆไปฌไผๅ็ฐๅฎ้ไธๆฏๆฏ่พreactๅ็ด็fiber่็น๏ผไฝๆ็ฐๅจไธไผ่ฏฆ็ปไป็ป๏ผๅไธบ่ฟไธช่ฟ็จ้ๅธธ็ฒพ็ปใๆไผๅไธ็ฏๅ็ฌ็ๆ็ซ๏ผ็นๅซๅณๆณจchild reconciliationใ\n\n> ๅฆๆๆจๆฅไบ่ชๅทฑๅญฆไน็ป่๏ผๆฅ็[reconcileChildrenArray](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactChildFiber.js#L732)ๅฝๆฐๅไธบๆไปฌ่ฟไธชๅบ็จ็renderๆนๆณ่ฟๅไบไธไธชreactๅ็ด็ๆฐ็ปใ\n\nๆไปฌ้่ฆ็่งฃไธคไธช้่ฆ็ๆฆๅฟต๏ผ\n\n1. ๅฝreactๆง่กchild reconciliationๆถ๏ผไปๅๅปบๆๆดๆฐrenderๆนๆณ่ฟๅ็reacๅ็ด็fiber่็นใ**finishClassComponent**ๅฝๆฐ่ฟๅๅฝๅfiber่็น็ฌฌไธไธชๅญฉๅญ็ๅผ็จใๅฎไผๅ้ๅฐ**nextUnitOfWork**ๅนถๅจ็จๅ็work loopไธญๅค็ใ\n\n2. reactๆดๆฐchildren็propsไฝไธบparentๅทฅไฝ็ไธ้จๅใไธบๆญค๏ผๅฎไฝฟ็จๆฅ่ชrenderๆนๆณ่ฟๅ็Reactๅ็ด็ๆฐๆฎใไพๅฆ๏ผ่ฟๆฏ**span**ๅจreact reconcileไนๅ็fiber่็น\n\n   ```javascript\n   {\n       stateNode: new HTMLSpanElement,\n       type: \"span\",\n       key: \"2\",\n       memoizedProps: {children: 0},\n       pendingProps: {children: 0},\n       ...\n   }\n   ```\n\n   ๅฏไปฅ็ๅฐ๏ผ**memoizedProps**ๅ**pendingProps**ไธญ็**children**ๆฏ**0**๏ผ่ฟ้ๆฏspanๅ็ด่ขซrenderๅ่ฟๅ็reactๅ็ด\n\n   ```javascript\n   {\n       $$typeof: Symbol(react.element)\n       key: \"2\"\n       props: {children: 1}\n       ref: null\n       type: \"span\"\n   }\n   ```\n\n   ๅฏไปฅ็ๅฐ๏ผfiber่็นไธญ็propsๅ่ขซ่ฟๅ็reactๅ็ดๆไธๅ๏ผๅจ[**createWorkInProgress**](https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/react-reconciler/src/ReactFiber.js#L326)ๅฝๆฐไธญๅๅปบalternate fiber่็น๏ผ**reactไผไปreactๅ็ดไธญๆๆดๆฐ็ๅฑๆงไธญๅคๅถๅฐfiber่็น**ใๆไปฅ๏ผๅฝreact็ปๆ**ClickCouter**็ปไปถ็child reconciliation๏ผ**span**็fiber่็นไผๆดๆฐ**pendingProps**ๅฑๆงใ\n\n   ```javascript\n   {\n       stateNode: new HTMLSpanElement,\n       type: \"span\",\n       key: \"2\",\n       memoizedProps: {children: 0},\n       pendingProps: {children: 1},\n       ...\n   }\n   ```\n\n   ๅฝreactๆง่กspan fiber่็นๅทฅไฝๆถ๏ผไผๅฐpendingPropsๅคๅถๅฐ**memoizedProps**ไธญๅนถๆทปๅไธไธชeffectsๅปๆดๆฐDOMใ\n\n   \n\n   ่ฟๅฐฑๆฏrender้ถๆฎตreactๅจ**ClickCounter** fiber่็นไธ็ๅทฅไฝใๅไธบbuttonๆฏClickCounter็ปไปถ็็ฌฌไธไธชๅญฉๅญ๏ผไปไผ่ขซๅ้ๅฐ**nextUnitOfWork**๏ผไธไปๆฒกไปไนๅตไบ่ฆๅนฒ๏ผๆไปฅreactไผ็งปๅจๅฐไป็ๅๅผ่็น--spanใ\n\n\n\n\n\n### Processing updates for the Span fiber\n\nไธ**ClickCounter**็ธไผผ๏ผไป[beginWork](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L1489)ๅฝๆฐๅผๅงใๅไธบ**span**่็นๆฏ**HostComponent**็ฑปๅ๏ผๆไปฅ๏ผ\n\n````javascript\nfunction beginWork(current$$1, workInProgress, ...) {\n    ...\n    switch (workInProgress.tag) {\n        case FunctionalComponent: {...}\n        case ClassComponent: {...}\n        case HostComponent:\n          return updateHostComponent(current, workInProgress, ...);\n        case ...\n}\n````\n\nๅจ[updateHostComponent](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L686)็ปๆใๅฏไปฅไธclass็ปไปถ่ฐ็จ็**updateClassComponent**ๅฏนๆฏใๅฏนไบๅฝๆฐๅผ็ปไปถๆฏ**updateFunctionComponent**ใไฝๅฏไปฅๅจ[**ReactFiberBeginWork.js**](https://github.com/facebook/react/blob/1034e26fe5e42ba07492a736da7bdf5bf2108bc6/packages/react-reconciler/src/ReactFiberBeginWork.js)ไธญๆพๅฐๆๆ่ฟไบๅฝๆฐใ\n\n### Reconciling children for the span fiber\n\nๅจๆไปฌ็ไพๅญไธญ๏ผspan่็น็**updateHostComponent**ไธญๆฒกๆ็นๅซ้่ฆ็ไบๆๅ็ใ\n\n### Completing work for the Span Fiber node\n\nๅฝ**beginWork**็ปๆๅ๏ผไผ่ฟๅฅ**completeWork**ใไธ่ฟๅจ่ฟไนๅ๏ผreact้่ฆๆดๆฐspan fiber่็นไธ็**memoizedProps**๏ผไฝๅฏ่ฝ่ฟ่ฎฐๅพๅฝ**ClickCounter**ไธreconciling childrenๆถ๏ผreactๆดๆฐไบspan fiber่็น็**pendingProps**\n\n```javascript\n//่ฟๆฏไนๅ็\n{\n    stateNode: new HTMLSpanElement,\n    type: \"span\",\n    key: \"2\",\n    memoizedProps: {children: 0},\n    pendingProps: {children: 1},\n    ...\n}\n```\n\nๅฝ**span**็fiber**beginWork**ๅฎๆๅ๏ผreactๆดๆฐpendingPropsไปฅๅน้memoizedProps\n\n```javascript\nfunction performUnitOfWork(workInProgress) {\n    ...\n    next = beginWork(current$$1, workInProgress, nextRenderExpirationTime);\n    workInProgress.memoizedProps = workInProgress.pendingProps;\n    ...\n}\n```\n\n็ถๅๅฎ่ฐ็จcompleteWorkๅฝๆฐ๏ผๅฎๅบๆฌไธๆฏไธไธช็ฑปไผผไบๆไปฌๅจbeginWorkไธญ็ๅฐ็ๅคง่ฝฌๆข่ฏญๅฅ\n\n```javascript\n\nfunction completeWork(current, workInProgress, ...) {\n    ...\n    switch (workInProgress.tag) {\n        case FunctionComponent: {...}\n        case ClassComponent: {...}\n        case HostComponent: {\n            ...\n            updateHostComponent(current, workInProgress, ...);\n        }\n        case ...\n    }\n}\n```\n\n็ฑไบๆไปฌ็span Fiber่็นๆฏHostComponent๏ผๅๆญคๅฎ่ฟ่ก[**updateHostComponent**](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L686)ๅฝๆฐใๅจ่ฟไธชๅฝๆฐไธญ๏ผReactๅบๆฌไธๆง่กไปฅไธๆไฝ๏ผ\n\n* ๅๅคDOMๆดๆฐ\n* ๅฐ่ฟไบๆดๆฐๆพๅฐspan fiber่็น็updateQueue\n* ๅฐ่ฟไบeffectๅบ็จๅฐๆดๆฐDOMไธ\n\nๅจๆง่ก่ฟไบๆไฝไนๅ๏ผspan Fiber่็นๅฆไธๆ็คบ๏ผ\n\n```javascript\n{\n    stateNode: new HTMLSpanElement,\n    type: \"span\",\n    effectTag: 0\n    updateQueue: null\n    ...\n}\n```\n\nๅฝๅทฅไฝๅฎๆๆถ๏ผๅฎ็่ตทๆฅๅ่ฟๆท๏ผ\n\n```javascript\n{\n    stateNode: new HTMLSpanElement,\n    type: \"span\",\n    effectTag: 4,\n    updateQueue: [\"children\", \"1\"],\n    ...\n}\n```\n\nโ\tๆณจๆeffectTagๅupdateQueueๅญๆฎต็ๅบๅซใๅฎไธๅๆฏ0๏ผๅฎ็ๅผๆฏ4.ๅจไบ่ฟๅถไธญ๏ผ่ฟๆฏ100๏ผ่ฟๆๅณ็็ฌฌไธไฝ่ขซ่ฎพ็ฝฎ๏ผ่ฟๆฏ**update** side-effect็ๆๅฟไฝใ่ฟๆฏreact้่ฆๅจๆฅไธๆฅ็commit้ถๆฎตๅฏน่ฟไธช่็นไป้็ๅทฅไฝใ**updateQueue**ๅญๆฎตไฟๅญๅฐ็จไบๆดๆฐ็ๆๆpayloadใ \n\nโ\tๅฝreactๅค็ๅฎ**ClickCounter**ๅไป็ๅญฉๅญ๏ผrender้ถๆฎตๅฐฑ็ปๆไบใๅฎ็ฐๅจๅฏไปฅๅฐๅฎๆ็alternate treeๅ้็ปFiberRootไธ็finishedWorkๅฑๆงใ่ฟๆฏ้่ฆๅทๆฐๅฐๅฑๅน็ๆฐๆใๅฎๅฏไปฅๅจๆธฒๆ้ถๆฎตๅ็ซๅณๅค็๏ผไนๅฏไปฅๅจๆต่งๅจ็ปๅบReactๆถ้ดๅๅๅค็ใ\n\n### Effects list\n\nโ\tๅจๆไปฌ็ไพๅญไธญ๏ผๅไธบspan่็นๅClickCounter็ปไปถๆside effects๏ผreactไผๅฐspan็fiber่็น่ฟๆฅๅฐHostFiber็firstEffectๅฑๆงใreactไผๅจ[**compliteUnitOfWork**](https://github.com/facebook/react/blob/d5e1bf07d086e4fc1998653331adecddcd0f5274/packages/react-reconciler/src/ReactFiberScheduler.js#L999)ๅฝๆฐๆๅปบeffects list๏ผไปฅไธๆฏๅทๆๆดๆฐspan่็นๅClickCounterไธ็้ฉๅญๆๆ็fiber tree๏ผ\n\n![](http://pjpqjxkf6.bkt.clouddn.com/1_TRmFSeuOuWlY3HXh86cvDA.png)\n\n## commit้ถๆฎต\n\nโ\tcommit้ถๆฎตๆฏreactๆดๆฐDOMๅ่ฐ็จcDU็ๅฝๅจๆใไธบไบๅฎ็ฐ๏ผreactไผ้ๅrender้ถๆฎตๆๅปบ็effects listๅนถๅบ็จไปไปฌใ\n\n```javascript\n{ type: ClickCounter, effectTag: 5 }\n{ type: 'span', effectTag: 4 }\n```\n\nโ\tClickCouter็effect tagๆฏ5๏ผไบ่ฟๅถๆฏ101๏ผ๏ผๅฎไนไบ**Update**๏ผๅฏนไบclass็ปไปถๆฅ่ฏดๅบๆฌไธๆฏ่ฝฌๆข**componentDidUpdate**๏ผไบ่ฟๅถ็ๆๅไธไฝ่ขซ่ฎพ็ฝฎๆๅณ็่ฟไธชfiber่็นๅจ**render**้ถๆฎต็ๆๆๅทฅไฝๅทฒ็ปๅฎๆใ\n\nโ\tspan็effect tagๆฏ4๏ผไบ่ฟๅถ100๏ผ๏ผๅฎไนไบ update๏ผๅฏนไบhost็ปไปถๆฅ่ฏดๆฏDOMๆดๆฐใๅจspanๅ็ด็ๆๅตไธ๏ผreactไผๆดๆฐๅ็ด็**textContent**ใ\n\n### Applying effects\n\nโ\t่ฎฉๆไปฌ็็reactๆฏๅฆไฝๅบ็จ่ฟไบeffects็๏ผ[**commitRoot**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L523)ๅฝๆฐ๏ผๅๅซไบไธไธชๅญๅฝๆฐ๏ผ\n\n```javascript\nfunction commitRoot(root, finishedWork) {\n    commitBeforeMutationLifecycles()\n    commitAllHostEffects();\n    root.current = finishedWork;\n    commitAllLifeCycles();\n}\n```\n\n \tๆฏไธไธชๅญๅฝๆฐ้ฝไผ้ๅeffecys listๅนถๆฃๆฅeffects็็ฑปๅใๅฝๅฎๆพๅฐไธๅฝๆฐ็ฎ็็ธๅณ็ๆๆๆถ๏ผๅฎไผๅบ็จๅฎใๅจๆไปฌ็ไพๅญไธญ๏ผcommitRootไผ่ฐ็จ**ClickCounter**็**cDU**ๅๆดๆฐ**span**ๅ็ด็ๆๆฌใ\n\nโ\t็ฌฌไธไธชๅฝๆฐ[commitBeforeMutationLifeCycles](https://github.com/facebook/react/blob/fefa1269e2a67fa5ef0992d5cc1d6114b7948b7e/packages/react-reconciler/src/ReactFiberCommitWork.js#L183)ไผๆฅๆพ[**Snapshot**](https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js#L25) effectๅนถ่ฐ็จ**getSnapshotBeforeUpdate**ๆนๆณใไธ่ฟๆไปฌ็**ClickCouter**็ปไปถๆฒกๆๅฎ็ฐ่ฟไธชๆนๆณ๏ผreactไธไผๅจ**render**้ถๆฎตไธญๆทปๅ่ฟไธชeffect๏ผๆไปฅๅจๆไปฌ็ไพๅญไธญ๏ผ่ฟไธชๅฝๆฐไธ่ตทไฝ็จใ\n\n### DOM updates\n\nโ\tไธไธๆญฅ๏ผreactไผๆง่ก[**commitAllHostEffects**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L376)ๅฝๆฐ๏ผๅจ่ฟไธชๅฝๆฐไธญReactไผๅฐ**span**ๅ็ด็ๆๆฌไป0ๆนๅๅฐ1๏ผ่ClickCounter็ปไปถๅไธๅไปปไฝๅฝฑๅๅไธบclass็ปไปถๅฏนๅบ็่็นๆฒกๆไปปไฝDOMๆดๆฐใ\n\nโ\t่ฏฅๅฝๆฐ็่ฆ็นๆฏๅฎ้ๆฉๆญฃ็กฎ็ๆๆ็ฑปๅๅนถๅบ็จ็ธๅบ็ๆไฝใๅจๆไปฌ็ไพๅญไธญ๏ผๆไปฌ้่ฆๆดๆฐspanๅ็ด็ๆๆฌ๏ผๆไปฅๆไปฌๅจ่ฟ้้็จ**Update**ๅๆฏ๏ผ\n\n```javascript\nfunction updateHostEffects() {\n    switch (primaryEffectTag) {\n      case Placement: {...}\n      case PlacementAndUpdate: {...}\n      case Update:\n        {\n          var current = nextEffect.alternate;\n          commitWork(current, nextEffect);\n          break;\n        }\n      case Deletion: {...}\n    }\n}\n```\n\n\n\nโ\t็ปง็ปญๆง่ก**commitWork**๏ผreactไผๆง่ก[**updateDOMProperties**](https://github.com/facebook/react/blob/8a8d973d3cc5623676a84f87af66ef9259c3937c/packages/react-dom/src/client/ReactDOMComponent.js#L326)ๅฝๆฐ๏ผไปๅฐๅจrender้ถๆฎตๆทปๅ็updateQueueๅบ็จๅฐfiber่็นไธ๏ผๅนถๆดๆฐ**span**ๅ็ด็**textContent**ๅฑๆงใ\n\n```javascript\nfunction updateDOMProperties(domElement, updatePayload, ...) {\n  for (let i = 0; i < updatePayload.length; i += 2) {\n    const propKey = updatePayload[i];\n    const propValue = updatePayload[i + 1];\n    if (propKey === STYLE) { ...} \n    else if (propKey === DANGEROUSLY_SET_INNER_HTML) {...} \n    else if (propKey === CHILDREN) {\n      setTextContent(domElement, propValue);\n    } else {...}\n  }\n}\n```\n\nโ\tๅฝDOMๆดๆฐ่ขซๆง่กๅ๏ผreactๅฐ**finishedWork**ๆๅ้ๅฐ**HostRoot**๏ผ\n\n```javascript\nroot.current = finishedWork;\n```\n\n\n\n### Calling post mutation lifecycle hooks\n\nโ\tๅฉไธ็ๆๅไธไธชๅฝๆฐๆฏ[**commitAllLifecycles**](https://github.com/facebook/react/blob/d5e1bf07d086e4fc1998653331adecddcd0f5274/packages/react-reconciler/src/ReactFiberScheduler.js#L479)ใๅจ่ฟ้reactไผ่ฐ็จๆดๆฐๅ็็ๅฝๅจๆใๅจrender้ถๆฎตไธญ๏ผreactๆทปๅ**Update** effectๅฐ**ClickCounter**็ปไปถไธญใ่ฟๆฏ**commitAllLifecycles**ๆฅๆพๅนถ่ฐ็จ็ๅถไธญไธไธชๅจๆใ\n\n```javascript\nfunction commitAllLifeCycles(finishedRoot, ...) {\n    while (nextEffect !== null) {\n        const effectTag = nextEffect.effectTag;\n\n        if (effectTag & (Update | Callback)) {\n            const current = nextEffect.alternate;\n            commitLifeCycles(finishedRoot, current, nextEffect, ...);\n        }\n        \n        if (effectTag & Ref) {\n            commitAttachRef(nextEffect);\n        }\n        \n        nextEffect = nextEffect.nextEffect;\n    }\n}\n```\n\nโ\tๅจ่ฟไธชๅฝๆฐไธญ๏ผreactไนไผ่ฐ็จ็ฌฌไธๆฌก่ขซๆธฒๆ็็ปไปถ็**cDM**",
        "type": "MarkdownRemark",
        "contentDigest": "b3ef6a40033c4bde18b66149acd4dbcd",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "state & props update",
        "date": "2018-01-07",
        "spoiler": "ๆทฑๅฅreactๅ้จ",
        "_PARENT": "6e86617b-839e-59fd-8c05-7626d88030f6"
      },
      "excerpt": "",
      "rawMarkdownBody": "\nDemo:\n\nhttps://stackblitz.com/edit/react-jwqn64\n\n```jsx\nclass ClickCounter extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {count: 0};\n        this.handleClick = this.handleClick.bind(this);\n    }\n\n    handleClick() {\n        this.setState((state) => {\n            return {count: state.count + 1};\n        });\n    }\n    \n    componentDidUpdate() {}\n\n    render() {\n        return [\n            <button key=\"1\" onClick={this.handleClick}>Update counter</button>,\n            <span key=\"2\">{this.state.count}</span>\n        ]\n    }\n}\n```\n\nๅฝๆไปฌ็นๅปbuttonๆถ๏ผๆไปฌๅฏไปฅ็ๅฐ[**completeWork**](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberCompleteWork.js#L532)๏ผ\n\n* ๆดๆฐ`ClickCounter`ไธญ็count state\n* ่ฐ็จ`render`ๆนๆณๅปๅพๅฐchildrenๅ่กจๅนถๆง่กๆฏ่พ\n* ๆดๆฐ`span`ๅ็ด็props\n\nๅจ[**commitRoot**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L523)๏ผ\n\n* ๆดๆฐ`span`ๅ็ด็`textContent`ๅฑๆง\n* ่ฐ็จ`cDU`\n\n## render้ถๆฎต\n\n### Scheduling updates๏ผๅฎๆๆดๆฐ๏ผ\n\nโ\tๅฝๆไปฌ็นๅปๆ้ฎ๏ผไผ่งฆๅ็นๅปไบไปถ็ถๅreact่งฃๆๆไปฌไผ็ปๆ้ฎprops็callbackใๅจ่ฟไธชๅบ็จไธญcallbackๆฏๅขๅcounterๅนถๆดๆฐstateใ\n\n```jsx\nclass ClickCounter extends React.Component {\n    //...\n    handleClick() {\n        this.setState((state) => {\n            return {count: state.count + 1};\n        });\n    }\n}   \n```\n\nโ\t\tๆฏไธไธชReact็ปไปถ้ฝๆไธไธช`updater`ไฝไธบ็ปไปถๅreactๆธๅฟ้ไฟก็ๆกฅๆขใไปๅ่ฎธ`setState`ๅจไธๅ็็ฏๅขไธ๏ผReactDOM๏ผRN๏ผ SSR๏ผ test๏ผๅฎ็ฐไธๅ็ๆๆ\n\n> ๆณจ๏ผๅณไบupdater๏ผๅฏไปฅๅณ่ๅญฆไนdanๅคง็ฅๅๅฎข็[How Does setState Know What to Do?]( https://overreacted.io/how-does-setstate-know-what-to-do/) \n\nโ\tๅจ่ฟ็ฏๆ็ซไธญ๏ผๆไปฌไผไพง้ReactDom็ไฝฟ็จไบFiber reconciler็updaterๅฎ็ฐ๏ผๅฏนไบ`ClickCounter`็ปไปถๆฏ[**classComponentUpdater**](https://github.com/facebook/react/blob/6938dcaacbffb901df27782b7821836961a5b68d/packages/react-reconciler/src/ReactFiberClassComponent.js#L186)๏ผไป่ด่ดฃๆฃ็ดขfiberๅฎไพ๏ผ้ๅๆดๆฐๅๅฎๆๅทฅไฝใ\n\nโ\tๅฝๆดๆฐๆ้ๆถ๏ผไปไปฌๅบๆฌไธๅชๆฏ่ขซๆทปๅๅฐfiber่็นไธๅค็็ๆดๆฐ้ๅไธญใๅจๆไปฌ็ๅฎไพไธญ๏ผไธClickCounter็ปไปถๅฏนๅบ็fiber่็นๆไปฅไธ็็ปๆ\n\n```javascript\n{\n    stateNode: new ClickCounter,\n    type: ClickCounter,\n    updateQueue: {\n         baseState: {count: 0}\n         firstUpdate: {\n             next: {\n                 payload: (state) => { return {count: state.count + 1} }\n             }\n         },\n         ...\n     },\n     ...\n}\n```\n\nๆไปฌๅฏไปฅ็ๅฐ๏ผ`updateQueue.firstUpdate.next.payload`ไธญ็ๅฝๆฐๆฏๆไปฌไผ็ป`ClickCounter`็ปไปถไธญsetState็callbackใไป่กจ็คบๅจrender้ถๆฎต้่ฆ่ขซๅค็็็ฌฌไธไธชๆดๆฐใ\n\n### ๅค็ClickCounter Fiber็ป็น็ๆดๆฐ\n\nโ\tๆไปฌๅทฒ็ปๆไธไธชClickCounterๅฎไพ๏ผๆไปฅๆไปฌ่ฟๅฅ[**updateClassInstance**](https://github.com/facebook/react/blob/6938dcaacbffb901df27782b7821836961a5b68d/packages/react-reconciler/src/ReactFiberClassComponent.js#L976)ๅฝๆฐ๏ผ่ฟ้ๆฏreactๅฏนclass็ปไปถๆง่กๆๅคๆไฝ็ๅฝๆฐใไปฅไธๆฏๆๆง่ก้กบๅบๅจๅฝๆฐไธญๆง่ก็ๆ้่ฆ็ๆไฝ๏ผ\n\n* ่ฐ็จ**UNSAFE_componentWillReceiveProps**้ฉๅญ๏ผๅจreact v17ไธญๅผ็จ๏ผ\n* ๆง่ก**updateQueue**ไธญ็ๆดๆฐๅนถ็ๆๆฐ็state\n* ็จๆฐ็state่ฐ็จ**getDerivedStateFromProps**ๅนถๅพๅฐ็ปๆ\n* ่ฐ็จ**sCU**็กฎๅฎไธไธช็ปไปถๆฏๅฆ้่ฆๆดๆฐ๏ผๅฆๆ**false**๏ผ่ทณ่ฟๆดไธชๆธฒๆ่ฟ็จ\n* ่ฐ็จ**UNSAFE_componentWillUpdate**้ฉๅญ๏ผๅจreact v17ไธญๅผ็จ๏ผ\n* ๆทปๅไธไธชeffectๅป่งฆๅ**componentDidUpdate**้ฉๅญ\n\n> **cDU**่ฟไธชeffectๅจ**render**้ถๆฎตไธญ่ขซๆทปๅ๏ผไฝๆฏๅจ**commit**ไธญๆง่ก\n\n* ๆดๆฐ็ปไปถๅฎไพ็**state**ๅ**props**\n\nๅฝๆฐ็ฎๅๅๅฆไธ๏ผ\n\n```javascript\nfunction updateClassInstance(current, workInProgress, ctor, newProps, ...) {\n    const instance = workInProgress.stateNode;\n\n    const oldProps = workInProgress.memoizedProps;\n    instance.props = oldProps;\n    if (oldProps !== newProps) {\n        callComponentWillReceiveProps(workInProgress, instance, newProps, ...);\n    }\n\n    let updateQueue = workInProgress.updateQueue;\n    if (updateQueue !== null) {\n        processUpdateQueue(workInProgress, updateQueue, ...);\n        newState = workInProgress.memoizedState;\n    }\n\n    applyDerivedStateFromProps(workInProgress, ...);\n    newState = workInProgress.memoizedState;\n\n    const shouldUpdate = checkShouldComponentUpdate(workInProgress, ctor, ...);\n    if (shouldUpdate) {\n        instance.componentWillUpdate(newProps, newState, nextContext);\n        workInProgress.effectTag |= Update;\n        workInProgress.effectTag |= Snapshot;\n    }\n\n    instance.props = newProps;\n    instance.state = newState;\n\n    return shouldUpdate;\n}\n```\n\nไธ้ข็ไปฃ็็ๆฎต็งป้คไบไธไบ่พๅฉไปฃ็ใไพๅฆ๏ผๅจ่ฐ็จ็ๅฝๅจๆๆนๆณๆๆทปๅeffectๆฅ่งฆๅๅฎไปฌๆถ๏ผreactไผ็จ**typeof**ๆฃๆฅไธไธช็ปไปถๆฏๅฆๅฎ็ฐไบ่ฟไบๆนๆณใไธ้ขๆฏreactๅจๆทปๅeffectๅๆฃๆฅ**cDU**ๆนๆณ\n\n```javascript\nif (typeof instance.componentDidUpdate === 'function') {\n    workInProgress.effectTag |= Update;\n}\n```\n\nๅฅฝ็๏ผ็ฐๅจๆไปฌ็ฅ้ๅจrender้ถๆฎต**ClickCounter**ไผๆง่กไปไนๆไฝ๏ผ็ฐๅจ่ฎฉๆไปฌ็็่ฟไบๆไฝๆฏๆไนๆนๅfiber่็น็ๅผใๅฝreactๅผๅงๅทฅไฝๅ๏ผ**ClickCounter**็fiber่็น๏ผ\n\n```javascript\n{\n    effectTag: 0,\n    elementType: class ClickCounter,\n    firstEffect: null,\n    memoizedState: {count: 0},\n    type: class ClickCounter,\n    stateNode: {\n        state: {count: 0}\n    },\n    updateQueue: {\n        baseState: {count: 0},\n        firstUpdate: {\n            next: {\n                payload: (state, props) => {โฆ}\n            }\n        },\n        ...\n    }\n}\n```\n\nๅจๅทฅไฝๅฎๆๅ๏ผfiber่็นๆฏ่ฟๆท็๏ผ\n\n```javascript\n{\n    effectTag: 4,\n    elementType: class ClickCounter,\n    firstEffect: null,\n    memoizedState: {count: 1},\n    type: class ClickCounter,\n    stateNode: {\n        state: {count: 1}\n    },\n    updateQueue: {\n        baseState: {count: 1},\n        firstUpdate: null,\n        ...\n    }\n}\n```\n\nๅจๆดๆฐ่ขซๆง่กๅ๏ผ**count**็ๅผๅจ**memoized**ๅ**updateQueue**ไธญ็**baseState**ๅๆไบ**1**ใreactไนๆดๆฐไบ**ClickCounter**็ปไปถๅฎไพไธญ็state(stateNode)ใ\n\nๅจ่ฟไธชๆถๅ๏ผ้ๅไธญๅทฒ็ปๆฒกๆๆดๆฐไบ๏ผๆไปฅ**firstUpdate**ๆฏ**null**ใ่ไธ**effectTag**ไป0->4๏ผไบ่ฟๅถไธญๆฏ100๏ผๅณ็ฌฌไธไฝ่ฎพไบ1๏ผๆไนๆฏย[side-effect tag](https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js)ไธญ็**Update**:\n\n```javascript\nexport const Update = 0b00000000100;\n```\n\nๆป็ป๏ผๅฝๅจๅค็ClickCounter fiber่็นๆถ๏ผreact่ฐ็จๆดๆฐๅ็็ๅฝๅจๆ๏ผๆดๆฐstateๅๅฎไน็ธๅบ็side-effectsใ\n\n### Reconciling children for the ClickCounter Fiber\n\nไธไธๆญฅ๏ผreactๅผๅงย[finishClassComponent](https://github.com/facebook/react/blob/340bfd9393e8173adca5380e6587e1ea1a23cefa/packages/react-reconciler/src/ReactFiberBeginWork.js#L355)๏ผๅจ่ฟ้reactไผ่ฐ็จreact็ปไปถๅฎไพ็**render**ๆนๆณๅนถๅจ็ปไปถ่ฟๅ็็ๅญฉๅญไธๅบ็จdiff็ฎๆณใๆด้ซ้ถ็ๆฆ่ฟฐๅจ่ฟไธช[ๆๆกฃ](https://reactjs.org/docs/reconciliation.html#the-diffing-algorithm)ใ\n\n> ๅฝๆฏ่พไธคไธช็ธๅ็ฑปๅ็React DOMๅ็ดๆถ๏ผReactๆฅ็ไธค่็ๅฑๆง๏ผไฟๆ็ธๅ็ๅบๅฑDOM่็น๏ผๅนถไปๆดๆฐๆดๆน็ๅฑๆงใ\n\nๅฆๆๆไปฌๆทฑๅฅๆๆ๏ผๆไปฌไผๅ็ฐๅฎ้ไธๆฏๆฏ่พreactๅ็ด็fiber่็น๏ผไฝๆ็ฐๅจไธไผ่ฏฆ็ปไป็ป๏ผๅไธบ่ฟไธช่ฟ็จ้ๅธธ็ฒพ็ปใๆไผๅไธ็ฏๅ็ฌ็ๆ็ซ๏ผ็นๅซๅณๆณจchild reconciliationใ\n\n> ๅฆๆๆจๆฅไบ่ชๅทฑๅญฆไน็ป่๏ผๆฅ็[reconcileChildrenArray](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactChildFiber.js#L732)ๅฝๆฐๅไธบๆไปฌ่ฟไธชๅบ็จ็renderๆนๆณ่ฟๅไบไธไธชreactๅ็ด็ๆฐ็ปใ\n\nๆไปฌ้่ฆ็่งฃไธคไธช้่ฆ็ๆฆๅฟต๏ผ\n\n1. ๅฝreactๆง่กchild reconciliationๆถ๏ผไปๅๅปบๆๆดๆฐrenderๆนๆณ่ฟๅ็reacๅ็ด็fiber่็นใ**finishClassComponent**ๅฝๆฐ่ฟๅๅฝๅfiber่็น็ฌฌไธไธชๅญฉๅญ็ๅผ็จใๅฎไผๅ้ๅฐ**nextUnitOfWork**ๅนถๅจ็จๅ็work loopไธญๅค็ใ\n\n2. reactๆดๆฐchildren็propsไฝไธบparentๅทฅไฝ็ไธ้จๅใไธบๆญค๏ผๅฎไฝฟ็จๆฅ่ชrenderๆนๆณ่ฟๅ็Reactๅ็ด็ๆฐๆฎใไพๅฆ๏ผ่ฟๆฏ**span**ๅจreact reconcileไนๅ็fiber่็น\n\n   ```javascript\n   {\n       stateNode: new HTMLSpanElement,\n       type: \"span\",\n       key: \"2\",\n       memoizedProps: {children: 0},\n       pendingProps: {children: 0},\n       ...\n   }\n   ```\n\n   ๅฏไปฅ็ๅฐ๏ผ**memoizedProps**ๅ**pendingProps**ไธญ็**children**ๆฏ**0**๏ผ่ฟ้ๆฏspanๅ็ด่ขซrenderๅ่ฟๅ็reactๅ็ด\n\n   ```javascript\n   {\n       $$typeof: Symbol(react.element)\n       key: \"2\"\n       props: {children: 1}\n       ref: null\n       type: \"span\"\n   }\n   ```\n\n   ๅฏไปฅ็ๅฐ๏ผfiber่็นไธญ็propsๅ่ขซ่ฟๅ็reactๅ็ดๆไธๅ๏ผๅจ[**createWorkInProgress**](https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/react-reconciler/src/ReactFiber.js#L326)ๅฝๆฐไธญๅๅปบalternate fiber่็น๏ผ**reactไผไปreactๅ็ดไธญๆๆดๆฐ็ๅฑๆงไธญๅคๅถๅฐfiber่็น**ใๆไปฅ๏ผๅฝreact็ปๆ**ClickCouter**็ปไปถ็child reconciliation๏ผ**span**็fiber่็นไผๆดๆฐ**pendingProps**ๅฑๆงใ\n\n   ```javascript\n   {\n       stateNode: new HTMLSpanElement,\n       type: \"span\",\n       key: \"2\",\n       memoizedProps: {children: 0},\n       pendingProps: {children: 1},\n       ...\n   }\n   ```\n\n   ๅฝreactๆง่กspan fiber่็นๅทฅไฝๆถ๏ผไผๅฐpendingPropsๅคๅถๅฐ**memoizedProps**ไธญๅนถๆทปๅไธไธชeffectsๅปๆดๆฐDOMใ\n\n   \n\n   ่ฟๅฐฑๆฏrender้ถๆฎตreactๅจ**ClickCounter** fiber่็นไธ็ๅทฅไฝใๅไธบbuttonๆฏClickCounter็ปไปถ็็ฌฌไธไธชๅญฉๅญ๏ผไปไผ่ขซๅ้ๅฐ**nextUnitOfWork**๏ผไธไปๆฒกไปไนๅตไบ่ฆๅนฒ๏ผๆไปฅreactไผ็งปๅจๅฐไป็ๅๅผ่็น--spanใ\n\n\n\n\n\n### Processing updates for the Span fiber\n\nไธ**ClickCounter**็ธไผผ๏ผไป[beginWork](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L1489)ๅฝๆฐๅผๅงใๅไธบ**span**่็นๆฏ**HostComponent**็ฑปๅ๏ผๆไปฅ๏ผ\n\n````javascript\nfunction beginWork(current$$1, workInProgress, ...) {\n    ...\n    switch (workInProgress.tag) {\n        case FunctionalComponent: {...}\n        case ClassComponent: {...}\n        case HostComponent:\n          return updateHostComponent(current, workInProgress, ...);\n        case ...\n}\n````\n\nๅจ[updateHostComponent](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L686)็ปๆใๅฏไปฅไธclass็ปไปถ่ฐ็จ็**updateClassComponent**ๅฏนๆฏใๅฏนไบๅฝๆฐๅผ็ปไปถๆฏ**updateFunctionComponent**ใไฝๅฏไปฅๅจ[**ReactFiberBeginWork.js**](https://github.com/facebook/react/blob/1034e26fe5e42ba07492a736da7bdf5bf2108bc6/packages/react-reconciler/src/ReactFiberBeginWork.js)ไธญๆพๅฐๆๆ่ฟไบๅฝๆฐใ\n\n### Reconciling children for the span fiber\n\nๅจๆไปฌ็ไพๅญไธญ๏ผspan่็น็**updateHostComponent**ไธญๆฒกๆ็นๅซ้่ฆ็ไบๆๅ็ใ\n\n### Completing work for the Span Fiber node\n\nๅฝ**beginWork**็ปๆๅ๏ผไผ่ฟๅฅ**completeWork**ใไธ่ฟๅจ่ฟไนๅ๏ผreact้่ฆๆดๆฐspan fiber่็นไธ็**memoizedProps**๏ผไฝๅฏ่ฝ่ฟ่ฎฐๅพๅฝ**ClickCounter**ไธreconciling childrenๆถ๏ผreactๆดๆฐไบspan fiber่็น็**pendingProps**\n\n```javascript\n//่ฟๆฏไนๅ็\n{\n    stateNode: new HTMLSpanElement,\n    type: \"span\",\n    key: \"2\",\n    memoizedProps: {children: 0},\n    pendingProps: {children: 1},\n    ...\n}\n```\n\nๅฝ**span**็fiber**beginWork**ๅฎๆๅ๏ผreactๆดๆฐpendingPropsไปฅๅน้memoizedProps\n\n```javascript\nfunction performUnitOfWork(workInProgress) {\n    ...\n    next = beginWork(current$$1, workInProgress, nextRenderExpirationTime);\n    workInProgress.memoizedProps = workInProgress.pendingProps;\n    ...\n}\n```\n\n็ถๅๅฎ่ฐ็จcompleteWorkๅฝๆฐ๏ผๅฎๅบๆฌไธๆฏไธไธช็ฑปไผผไบๆไปฌๅจbeginWorkไธญ็ๅฐ็ๅคง่ฝฌๆข่ฏญๅฅ\n\n```javascript\n\nfunction completeWork(current, workInProgress, ...) {\n    ...\n    switch (workInProgress.tag) {\n        case FunctionComponent: {...}\n        case ClassComponent: {...}\n        case HostComponent: {\n            ...\n            updateHostComponent(current, workInProgress, ...);\n        }\n        case ...\n    }\n}\n```\n\n็ฑไบๆไปฌ็span Fiber่็นๆฏHostComponent๏ผๅๆญคๅฎ่ฟ่ก[**updateHostComponent**](https://github.com/facebook/react/blob/cbbc2b6c4d0d8519145560bd8183ecde55168b12/packages/react-reconciler/src/ReactFiberBeginWork.js#L686)ๅฝๆฐใๅจ่ฟไธชๅฝๆฐไธญ๏ผReactๅบๆฌไธๆง่กไปฅไธๆไฝ๏ผ\n\n* ๅๅคDOMๆดๆฐ\n* ๅฐ่ฟไบๆดๆฐๆพๅฐspan fiber่็น็updateQueue\n* ๅฐ่ฟไบeffectๅบ็จๅฐๆดๆฐDOMไธ\n\nๅจๆง่ก่ฟไบๆไฝไนๅ๏ผspan Fiber่็นๅฆไธๆ็คบ๏ผ\n\n```javascript\n{\n    stateNode: new HTMLSpanElement,\n    type: \"span\",\n    effectTag: 0\n    updateQueue: null\n    ...\n}\n```\n\nๅฝๅทฅไฝๅฎๆๆถ๏ผๅฎ็่ตทๆฅๅ่ฟๆท๏ผ\n\n```javascript\n{\n    stateNode: new HTMLSpanElement,\n    type: \"span\",\n    effectTag: 4,\n    updateQueue: [\"children\", \"1\"],\n    ...\n}\n```\n\nโ\tๆณจๆeffectTagๅupdateQueueๅญๆฎต็ๅบๅซใๅฎไธๅๆฏ0๏ผๅฎ็ๅผๆฏ4.ๅจไบ่ฟๅถไธญ๏ผ่ฟๆฏ100๏ผ่ฟๆๅณ็็ฌฌไธไฝ่ขซ่ฎพ็ฝฎ๏ผ่ฟๆฏ**update** side-effect็ๆๅฟไฝใ่ฟๆฏreact้่ฆๅจๆฅไธๆฅ็commit้ถๆฎตๅฏน่ฟไธช่็นไป้็ๅทฅไฝใ**updateQueue**ๅญๆฎตไฟๅญๅฐ็จไบๆดๆฐ็ๆๆpayloadใ \n\nโ\tๅฝreactๅค็ๅฎ**ClickCounter**ๅไป็ๅญฉๅญ๏ผrender้ถๆฎตๅฐฑ็ปๆไบใๅฎ็ฐๅจๅฏไปฅๅฐๅฎๆ็alternate treeๅ้็ปFiberRootไธ็finishedWorkๅฑๆงใ่ฟๆฏ้่ฆๅทๆฐๅฐๅฑๅน็ๆฐๆใๅฎๅฏไปฅๅจๆธฒๆ้ถๆฎตๅ็ซๅณๅค็๏ผไนๅฏไปฅๅจๆต่งๅจ็ปๅบReactๆถ้ดๅๅๅค็ใ\n\n### Effects list\n\nโ\tๅจๆไปฌ็ไพๅญไธญ๏ผๅไธบspan่็นๅClickCounter็ปไปถๆside effects๏ผreactไผๅฐspan็fiber่็น่ฟๆฅๅฐHostFiber็firstEffectๅฑๆงใreactไผๅจ[**compliteUnitOfWork**](https://github.com/facebook/react/blob/d5e1bf07d086e4fc1998653331adecddcd0f5274/packages/react-reconciler/src/ReactFiberScheduler.js#L999)ๅฝๆฐๆๅปบeffects list๏ผไปฅไธๆฏๅทๆๆดๆฐspan่็นๅClickCounterไธ็้ฉๅญๆๆ็fiber tree๏ผ\n\n![](http://pjpqjxkf6.bkt.clouddn.com/1_TRmFSeuOuWlY3HXh86cvDA.png)\n\n## commit้ถๆฎต\n\nโ\tcommit้ถๆฎตๆฏreactๆดๆฐDOMๅ่ฐ็จcDU็ๅฝๅจๆใไธบไบๅฎ็ฐ๏ผreactไผ้ๅrender้ถๆฎตๆๅปบ็effects listๅนถๅบ็จไปไปฌใ\n\n```javascript\n{ type: ClickCounter, effectTag: 5 }\n{ type: 'span', effectTag: 4 }\n```\n\nโ\tClickCouter็effect tagๆฏ5๏ผไบ่ฟๅถๆฏ101๏ผ๏ผๅฎไนไบ**Update**๏ผๅฏนไบclass็ปไปถๆฅ่ฏดๅบๆฌไธๆฏ่ฝฌๆข**componentDidUpdate**๏ผไบ่ฟๅถ็ๆๅไธไฝ่ขซ่ฎพ็ฝฎๆๅณ็่ฟไธชfiber่็นๅจ**render**้ถๆฎต็ๆๆๅทฅไฝๅทฒ็ปๅฎๆใ\n\nโ\tspan็effect tagๆฏ4๏ผไบ่ฟๅถ100๏ผ๏ผๅฎไนไบ update๏ผๅฏนไบhost็ปไปถๆฅ่ฏดๆฏDOMๆดๆฐใๅจspanๅ็ด็ๆๅตไธ๏ผreactไผๆดๆฐๅ็ด็**textContent**ใ\n\n### Applying effects\n\nโ\t่ฎฉๆไปฌ็็reactๆฏๅฆไฝๅบ็จ่ฟไบeffects็๏ผ[**commitRoot**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L523)ๅฝๆฐ๏ผๅๅซไบไธไธชๅญๅฝๆฐ๏ผ\n\n```javascript\nfunction commitRoot(root, finishedWork) {\n    commitBeforeMutationLifecycles()\n    commitAllHostEffects();\n    root.current = finishedWork;\n    commitAllLifeCycles();\n}\n```\n\n \tๆฏไธไธชๅญๅฝๆฐ้ฝไผ้ๅeffecys listๅนถๆฃๆฅeffects็็ฑปๅใๅฝๅฎๆพๅฐไธๅฝๆฐ็ฎ็็ธๅณ็ๆๆๆถ๏ผๅฎไผๅบ็จๅฎใๅจๆไปฌ็ไพๅญไธญ๏ผcommitRootไผ่ฐ็จ**ClickCounter**็**cDU**ๅๆดๆฐ**span**ๅ็ด็ๆๆฌใ\n\nโ\t็ฌฌไธไธชๅฝๆฐ[commitBeforeMutationLifeCycles](https://github.com/facebook/react/blob/fefa1269e2a67fa5ef0992d5cc1d6114b7948b7e/packages/react-reconciler/src/ReactFiberCommitWork.js#L183)ไผๆฅๆพ[**Snapshot**](https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js#L25) effectๅนถ่ฐ็จ**getSnapshotBeforeUpdate**ๆนๆณใไธ่ฟๆไปฌ็**ClickCouter**็ปไปถๆฒกๆๅฎ็ฐ่ฟไธชๆนๆณ๏ผreactไธไผๅจ**render**้ถๆฎตไธญๆทปๅ่ฟไธชeffect๏ผๆไปฅๅจๆไปฌ็ไพๅญไธญ๏ผ่ฟไธชๅฝๆฐไธ่ตทไฝ็จใ\n\n### DOM updates\n\nโ\tไธไธๆญฅ๏ผreactไผๆง่ก[**commitAllHostEffects**](https://github.com/facebook/react/blob/95a313ec0b957f71798a69d8e83408f40e76765b/packages/react-reconciler/src/ReactFiberScheduler.js#L376)ๅฝๆฐ๏ผๅจ่ฟไธชๅฝๆฐไธญReactไผๅฐ**span**ๅ็ด็ๆๆฌไป0ๆนๅๅฐ1๏ผ่ClickCounter็ปไปถๅไธๅไปปไฝๅฝฑๅๅไธบclass็ปไปถๅฏนๅบ็่็นๆฒกๆไปปไฝDOMๆดๆฐใ\n\nโ\t่ฏฅๅฝๆฐ็่ฆ็นๆฏๅฎ้ๆฉๆญฃ็กฎ็ๆๆ็ฑปๅๅนถๅบ็จ็ธๅบ็ๆไฝใๅจๆไปฌ็ไพๅญไธญ๏ผๆไปฌ้่ฆๆดๆฐspanๅ็ด็ๆๆฌ๏ผๆไปฅๆไปฌๅจ่ฟ้้็จ**Update**ๅๆฏ๏ผ\n\n```javascript\nfunction updateHostEffects() {\n    switch (primaryEffectTag) {\n      case Placement: {...}\n      case PlacementAndUpdate: {...}\n      case Update:\n        {\n          var current = nextEffect.alternate;\n          commitWork(current, nextEffect);\n          break;\n        }\n      case Deletion: {...}\n    }\n}\n```\n\n\n\nโ\t็ปง็ปญๆง่ก**commitWork**๏ผreactไผๆง่ก[**updateDOMProperties**](https://github.com/facebook/react/blob/8a8d973d3cc5623676a84f87af66ef9259c3937c/packages/react-dom/src/client/ReactDOMComponent.js#L326)ๅฝๆฐ๏ผไปๅฐๅจrender้ถๆฎตๆทปๅ็updateQueueๅบ็จๅฐfiber่็นไธ๏ผๅนถๆดๆฐ**span**ๅ็ด็**textContent**ๅฑๆงใ\n\n```javascript\nfunction updateDOMProperties(domElement, updatePayload, ...) {\n  for (let i = 0; i < updatePayload.length; i += 2) {\n    const propKey = updatePayload[i];\n    const propValue = updatePayload[i + 1];\n    if (propKey === STYLE) { ...} \n    else if (propKey === DANGEROUSLY_SET_INNER_HTML) {...} \n    else if (propKey === CHILDREN) {\n      setTextContent(domElement, propValue);\n    } else {...}\n  }\n}\n```\n\nโ\tๅฝDOMๆดๆฐ่ขซๆง่กๅ๏ผreactๅฐ**finishedWork**ๆๅ้ๅฐ**HostRoot**๏ผ\n\n```javascript\nroot.current = finishedWork;\n```\n\n\n\n### Calling post mutation lifecycle hooks\n\nโ\tๅฉไธ็ๆๅไธไธชๅฝๆฐๆฏ[**commitAllLifecycles**](https://github.com/facebook/react/blob/d5e1bf07d086e4fc1998653331adecddcd0f5274/packages/react-reconciler/src/ReactFiberScheduler.js#L479)ใๅจ่ฟ้reactไผ่ฐ็จๆดๆฐๅ็็ๅฝๅจๆใๅจrender้ถๆฎตไธญ๏ผreactๆทปๅ**Update** effectๅฐ**ClickCounter**็ปไปถไธญใ่ฟๆฏ**commitAllLifecycles**ๆฅๆพๅนถ่ฐ็จ็ๅถไธญไธไธชๅจๆใ\n\n```javascript\nfunction commitAllLifeCycles(finishedRoot, ...) {\n    while (nextEffect !== null) {\n        const effectTag = nextEffect.effectTag;\n\n        if (effectTag & (Update | Callback)) {\n            const current = nextEffect.alternate;\n            commitLifeCycles(finishedRoot, current, nextEffect, ...);\n        }\n        \n        if (effectTag & Ref) {\n            commitAttachRef(nextEffect);\n        }\n        \n        nextEffect = nextEffect.nextEffect;\n    }\n}\n```\n\nโ\tๅจ่ฟไธชๅฝๆฐไธญ๏ผreactไนไผ่ฐ็จ็ฌฌไธๆฌก่ขซๆธฒๆ็็ปไปถ็**cDM**",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/state & props update.md",
      "fields": {
        "slug": "/state & props update/"
      }
    },
    "1b09d9a5-bd3d-5b54-a015-38a243a0175e": {
      "id": "1b09d9a5-bd3d-5b54-a015-38a243a0175e",
      "children": [],
      "parent": "41032e46-9ace-53d7-9bab-5db5c57c861e",
      "internal": {
        "content": "\n## ๅ่จ\n\nโ\t็ฎๅ่ฏดไธไธบไปไนReact้ๆฉๅฝๆฐๅผ็ปไปถ๏ผไธป่ฆๆฏclass็ปไปถๆฏ่พๅไฝใ็ๅฝๅจๆๅฝๆฐๅๆณไธๅๅฅฝ๏ผ้ชๅๆณๅค๏ผfunctional็ปไปถๆด็ฌฆๅReact็ผ็จๆๆณ็ญ็ญ็ญใๆดๅทไฝ็ๅฏไปฅๆ่ฏปdanๅคง็ฅ็blog:[ไผ้้จ](https://overreacted.io/how-are-function-components-different-from-classes/)ใๅถไธญ**Function components capture the rendered values**่ฟๅฅๅๅ็ฒพ่พ็้ๅบๅฝๆฐๅผ็ปไปถ็ไผๅฟใ\n\nโ\tไฝๆฏๅจ16.8ไนๅreact็ๅฝๆฐๅผ็ปไปถๅๅ็พธๅผฑ๏ผๅบๆฌๅช่ฝไฝ็จไบ็บฏๅฑ็คบ็ปไปถ๏ผไธป่ฆๅไธบ็ผบๅฐstateๅ็ๅฝๅจๆใๆฌไบบๆพ็ปๅจhooksๅบๆฅๅ่ด่ดฃ่ฟ็บฏๅฝๆฐๅผ็react้กน็ฎ๏ผๆๆ็ถๆๅค็้ฝๅฟ้กปๅจreducerไธญ่ฟ่ก๏ผๆๆๅฏไฝ็จ้ฝๅจsagaไธญๆง่ก๏ผๅฏไปฅ่ฏดๆฏๅๅ่ฐ่พ็็ปๅไบใๅจhooksๅบๆฅๅๆๅจๅฌๅธ็ไธไธชๅฐไธญๅฐ้กน็ฎไธญไฝฟ็จ๏ผ่ฝๅฐๆๆไธ้๏ผไปฃ็้ๆพ่ๅๅฐ็ๅๆถๆๅไบไปฃ็็ๅฏ่ฏปๆงใๅไธบ้่ฟcustom hooksๅฏไปฅๆดๅฅฝๅฐๅฅ็ฆปไปฃ็็ปๆ๏ผไธไผๅไปฅๅ็ฑป็ปไปถ้ฃๆทๅจcDU็ญ็ๅฝๅจๆๅไบไธๅคงๅ้ป่พ๏ผๅจๅฝไปคๅผไปฃ็ๅๅฃฐๆๅผไปฃ็ไธญๆไธไธช่ฏๆง็่พน็ใ\n\n## useStateๅจReactไธญๆฏๆไนๅฎ็ฐ็\n\n> Hooks take some getting used to โ and especially at the boundary of imperative and declarative code.\n\nโ\tๅฆๆๅฏนhooksไธๅคชไบ่งฃ็ๅฏไปฅๅ็็่ฟ็ฏๆ็ซ:[ๅๆๆ่ฆ](https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e)๏ผๅๅ็ฎๆ็ไป็ปไบhooks็ๆธๅฟๅ็๏ผไฝๆฏๆๅฏนuseEffect๏ผuseRef็ญ้ฉๅญ็ๅฎ็ฐๆฏ่พๅฅฝๅฅ๏ผๆไปฅๅผๅงๅ่ตทไบๆบ็๏ผไธ้ขๆไผ็ปๅๆบ็ไป็ปuseState็ๅ็ใuseStateๅทไฝ้ป่พๅๆไธ้จๅ๏ผmountState๏ผdispatch๏ผ updateState\n\n### hook็็ปๆ\n\n้ฆๅ็ๆฏhooks็็ปๆ๏ผhooksๆฏๆ่ฝฝๅจ็ปไปถFiber็ป็นไธmemoizedState็๏ผๅณไบFiber็ป็นๅฏไปฅ็็ๆ็ๅฆไธ็ฏ๏ผ[ไผ้้จ](https://xuzhanhh.com/Inside%20Fiber/)\n\n```javascript\n//hook็็ปๆ\nexport type Hook = {\n  memoizedState: any, //ไธไธๆฌก็state\n  baseState: any,  //ๅฝๅstate\n  baseUpdate: Update<any, any> | null,  // update func\n  queue: UpdateQueue<any, any> | null,  //็จไบ็ผๅญๅคๆฌกaction\n  next: Hook | null, //้พ่กจ\n};\n```\n\n### renderWithHooks\n\nๅจreconcilerไธญๅค็ๅฝๆฐๅผ็ปไปถ็ๅฝๆฐๆฏrenderWithHooks๏ผๅถ็ฑปๅๆฏ๏ผ\n\n```javascript\nrenderWithHooks(\n  current: Fiber | null, //ๅฝๅ็fiber็ป็น\n  workInProgress: Fiber, \n  Component: any, //jsxไธญ็จ<>่ฐ็จ็ๅฝๆฐ\n  props: any,\n  refOrContext: any,\n  nextRenderExpirationTime: ExpirationTime, //้่ฆๅจไปไนๆถๅ็ปๆ\n): any\n```\n\nๅจrenderWithHooks๏ผๆธๅฟๆต็จๅฆไธ๏ผ\n\n```javascript\n//ไปmemoizedStateไธญๅๅบhooks\nnextCurrentHook = current !== null ? current.memoizedState : null; \n//ๅคๆญ้่ฟๆๆฒกๆhooksๅคๆญๆฏmount่ฟๆฏupdate๏ผไธค่็ๅฝๆฐไธๅ\nReactCurrentDispatcher.current =\n      nextCurrentHook === null\n        ? HooksDispatcherOnMount\n        : HooksDispatcherOnUpdate;\n//ๆง่กไผๅฅ็typeๅฝๆฐ\nlet children = Component(props, refOrContext);\n//ๆง่กๅฎๅฝๆฐๅ็dispatcherๅๆๅช่ฝ่ฐ็จcontext็\nReactCurrentDispatcher.current = ContextOnlyDispatcher;\n\nreturn children;\n```\n\n### useStateๆๅปบๆถๆต็จ\n\n**mountState**\n\nๅจHooksDispatcherOnMountไธญ๏ผuseState่ฐ็จ็ๆฏไธ้ข็mountState๏ผไฝ็จๆฏๅๅปบไธไธชๆฐ็hookๅนถไฝฟ็จ้ป่ฎคๅผๅๅงๅๅนถ็ปๅฎๅถ่งฆๅๅจ๏ผๅไธบuseStateๅบๅฑๆฏuseReducer๏ผๆไปฅๆฐ็ป็ฌฌไบไธชๅผ่ฟๅ็ๆฏdispatchใ\n\n```typescript\ntype BasicStateAction<S> = (S => S) | S;\n\nfunction mountState<S>(\n  initialState: (() => S) | S,\n): [S, Dispatch<BasicStateAction<S>>] {\n  const hook = mountWorkInProgressHook();\n//ๅฆๆๅฅๅๆฏfuncๅไผ่ฐ็จ๏ผไฝๆฏไธๆไพๅๆฐ๏ผๅธฆๅๆฐ็้่ฆๅไธๅฑ\n  if (typeof initialState === 'function') {\n    initialState = initialState();\n  }\n//ไธไธไธชstateๅๅบๆฌ(ๅฝๅ)state้ฝๅๅงๅ\n  hook.memoizedState = hook.baseState = initialState;\n  const queue = (hook.queue = {\n    last: null,\n    dispatch: null,\n    eagerReducer: basicStateReducer, // useStateไฝฟ็จๅบ็กreducer\n    eagerState: (initialState: any),\n  });\n//่ฟๅ่งฆๅๅจ\n  const dispatch: Dispatch<\n    //useStateๅบๅฑๆฏuseReducer๏ผๆไปฅtypeๆฏBasicStateAction\n    BasicStateAction<S>,\n  > = (queue.dispatch = (dispatchAction.bind(\n    null,\n    //็ปๅฎๅฝๅfiber็ป็นๅqueue\n    ((currentlyRenderingFiber: any): Fiber),\n    queue,\n  ): any));\n  return [hook.memoizedState, dispatch];\n}\n```\n\n**mountWorkInProgressHook**\n\n่ฟไธชๅฝๆฐๆฏmountStateๆถ่ฐ็จ็ๆๅปบhook็ๆนๆณ๏ผๅจๅๅงๅๅฎๆฏๅไผ่ฟๆฅๅฐๅฝๅhook.next๏ผๅฆๆๆ็่ฏ๏ผ\n\n```javascript\nfunction mountWorkInProgressHook(): Hook {\n  const hook: Hook = {\n    memoizedState: null,\n    baseState: null,\n    queue: null,\n    baseUpdate: null,\n    next: null,\n  };\n  if (workInProgressHook === null) {\n    // ๅ่กจไธญ็็ฌฌไธไธชhook\n    firstWorkInProgressHook = workInProgressHook = hook;\n  } else {\n    // ๆทปๅๅฐๅ่กจ็ๆซๅฐพ\n    workInProgressHook = workInProgressHook.next = hook;\n  }\n  return workInProgressHook;\n}\n```\n\n### dispatchๅๅๅฝๆฐ\n\nโ\tๅจไธ้ขๆไปฌๆๅฐ๏ผuseStateๅบๅฑๆฏuseReducer๏ผๆไปฅ่ฟๅ็็ฌฌไบไธชๅๆฐๆฏdispatchๅฝๆฐ๏ผๅถไธญ็่ฎพ่ฎกๅๅๅทงๅฆใ\n\nๅ่ฎพๆไปฌๆไปฅไธไปฃ็:\n\n```javascript\nconst [data, setData] = React.useState(0)\nsetData('first')\nsetData('second')\nsetData('third')\n```\n\n![image-20190317151730512](/images/image-20190317151730512.png)\n\nๅจ็ฌฌไธๆฌกsetDataๅ๏ผ hooks็็ปๆๅฆไธๅพ\n\n![image-20190317152006773](/images/image-20190317152006773.png)\n\nๅจ็ฌฌไบๆฌกsetDataๅ๏ผ hooks็็ปๆๅฆไธๅพ\n\n![image-20190317152401946](/images/image-20190317152401946.png)\n\nๅจ็ฌฌไธๆฌกsetDataๅ๏ผ hooks็็ปๆๅฆไธๅพ\n\n![image-20190318114449227](/images/image-20190318114449227.png)\n\nๅจๆญฃๅธธๆๅตไธ๏ผๆฏไธไผๅจdispatcherไธญ่งฆๅreducer่ๆฏๅฐactionๅญๅฅupdateไธญๅจupdateStateไธญๅๆง่ก๏ผไฝๆฏๅฆๆๅจreactๆฒกๆ้ๆธฒๆ้ๆฑ็ๅๆไธๆฏไผๆๅ่ฎก็ฎstateๅณeagerStateใไฝไธบๆง่ฝไผๅ็ไธ็ฏใ\n\n```typescript\nfunction dispatchAction<S, A>(\n  fiber: Fiber,\n  queue: UpdateQueue<S, A>,\n  action: A,\n) {\n  const alternate = fiber.alternate;\n   {\n    flushPassiveEffects();\n\t//่ทๅๅฝๅๆถ้ดๅนถ่ฎก็ฎๅฏ็จๆถ้ด\n    const currentTime = requestCurrentTime();\n    const expirationTime = computeExpirationForFiber(currentTime, fiber);\n\n    const update: Update<S, A> = {\n      expirationTime,\n      action,\n      eagerReducer: null,\n      eagerState: null,\n      next: null,\n    };\n\t//ไธ้ข็ไปฃ็ๅฐฑๆฏไธบไบๆๅปบqueue.lastๆฏๆๆฐ็ๆดๆฐ๏ผ็ถๅlast.nextๅผๅงๆฏๆฏไธๆฌก็action\n    // ๅๅบlast\n    const last = queue.last;\n    if (last === null) {\n      // ่ชๅ\n      update.next = update;\n    } else {\n      const first = last.next;\n      if (first !== null) {\n        \n        update.next = first;\n      }\n      last.next = update;\n    }\n    queue.last = update;\n\n    if (\n      fiber.expirationTime === NoWork &&\n      (alternate === null || alternate.expirationTime === NoWork)\n    ) {\n      // ๅฝๅ้ๅไธบ็ฉบ๏ผๆไปฌๅฏไปฅๅจ่ฟๅฅrender้ถๆฎตๅๆๅ่ฎก็ฎๅบไธไธไธช็ถๆใๅฆๆๆฐ็็ถๆๅๅฝๅ็ถๆ็ธๅ๏ผๅๅฏไปฅ้ๅบ้ๆธฒๆ\n      const lastRenderedReducer = queue.lastRenderedReducer; // ไธๆฌกๆดๆฐๅฎๅ็reducer\n      if (lastRenderedReducer !== null) {\n        let prevDispatcher;\n        if (__DEV__) {\n          prevDispatcher = ReactCurrentDispatcher.current;  // ๆๅญdispatcher\n          ReactCurrentDispatcher.current = InvalidNestedHooksDispatcherOnUpdateInDEV;\n        }\n        try {\n          const currentState: S = (queue.lastRenderedState: any);\n          // ่ฎก็ฎไธๆฌกstate\n          const eagerState = lastRenderedReducer(currentState, action);\n          // ๅจupdateๅฏน่ฑกไธญๅญๅจ้ข่ฎก็ฎ็ๅฎๆด็ถๆๅreducer๏ผๅฆๆๅจ่ฟๅฅrender้ถๆฎตๅreducerๆฒกๆๅๅ้ฃไนๅฏไปฅๆ็จeagerState่ไธ็จ้ๆฐๅๆฌก่ฐ็จreducer\n          update.eagerReducer = lastRenderedReducer;\n          update.eagerState = eagerState;\n          if (is(eagerState, currentState)) {\n            // ๅจๅ็ปญ็ๆถ้ดไธญ๏ผๅฆๆ่ฟไธช็ปไปถๅๅซ็ๅๅ่ขซ้ๆธฒๆไธๅจ้ฃๆถreducerๆดๅๅ๏ผไปๆๅฏ่ฝ้ๅปบ่ฟๆฌกๆดๆฐ\n            return;\n          }\n        } catch (error) {\n          // Suppress the error. It will throw again in the render phase.\n        } finally {\n          if (__DEV__) {\n            ReactCurrentDispatcher.current = prevDispatcher;\n          }\n        }\n      }\n    }\n    scheduleWork(fiber, expirationTime);\n  }\n}\n```\n\n\n\n### useStateๆดๆฐๆถๆต็จ\n\n**updateReducer**\n\nโ\tๅไธบuseStateๅบๅฑๆฏuseReducer๏ผๆไปฅๅจๆดๆฐๆถ็ๆต็จ(ๅณ้ๆธฒๆ็ปไปถๅ)ๆฏ่ฐ็จupdateReducer็ใ\n\n```typescript\nfunction updateState<S>(\n  initialState: (() => S) | S,\n): [S, Dispatch<BasicStateAction<S>>] {\n  return updateReducer(basicStateReducer, (initialState: any));\n}\n```\n\nโ\tๆไปฅๅถreducerๅๅ็ฎๅ\n\n```typescript\nfunction basicStateReducer<S>(state: S, action: BasicStateAction<S>): S {\n  return typeof action === 'function' ? action(state) : action;\n}\n```\n\nโ\tๆไปฌๅๆๅคๆๆๅตๆๅผ๏ผ่ท้updateReducerๆต็จ\n\n```typescript\nfunction updateReducer<S, I, A>(\n  reducer: (S, A) => S,\n  initialArg: I,\n  init?: I => S,\n): [S, Dispatch<A>] {\n  // ่ทๅๅฝๅhook,queue\n  const hook = updateWorkInProgressHook();\n  const queue = hook.queue;\n\n  queue.lastRenderedReducer = reducer;\n\n  // action้ๅ็ๆๅไธไธชๆดๆฐ\n  const last = queue.last;\n  // ๆๅไธไธชๆดๆฐๆฏๅบๆฌ็ถๆ\n  const baseUpdate = hook.baseUpdate;\n  const baseState = hook.baseState;\n\n  // ๆพๅฐ็ฌฌไธไธชๆฒกๅค็็ๆดๆฐ\n  let first;\n  if (baseUpdate !== null) {\n    if (last !== null) {\n      // ็ฌฌไธๆฌกๆดๆฐๆถ๏ผ้ๅๆฏไธไธช่ชๅqueue.last.next = queue.firstใๅฝ็ฌฌไธๆฌกupdateๆไบคๅ๏ผbaseUpdateไธๅไธบ็ฉบๅณๅฏ่ทณๅบ้ๅ\n      last.next = null;\n    }\n    first = baseUpdate.next;\n  } else {\n    first = last !== null ? last.next : null;\n  }\n  if (first !== null) {\n    let newState = baseState;\n    let newBaseState = null;\n    let newBaseUpdate = null;\n    let prevUpdate = baseUpdate;\n    let update = first;\n    let didSkip = false;\n    do {\n      const updateExpirationTime = update.expirationTime;\n      if (updateExpirationTime < renderExpirationTime) {\n        // ไผๅ็บงไธ่ถณ๏ผ่ทณ่ฟ่ฟๆฌกๆดๆฐ๏ผๅฆๆ่ฟๆฏ็ฌฌไธๆฌก่ทณ่ฟๆดๆฐ๏ผไธไธไธชupdate/stateๆฏnewBaseupdate/state\n        if (!didSkip) {\n          didSkip = true;\n          newBaseUpdate = prevUpdate;\n          newBaseState = newState;\n        }\n        // ๆดๆฐไผๅ็บง\n        if (updateExpirationTime > remainingExpirationTime) {\n          remainingExpirationTime = updateExpirationTime;\n        }\n      } else {\n        // ๅค็ๆดๆฐ\n        if (update.eagerReducer === reducer) {\n          // ๅฆๆๆดๆฐ่ขซๆๅๅค็ไบไธreducer่ทๅฝๅreducerๅน้๏ผๅฏไปฅๅค็จeagerState\n          newState = ((update.eagerState: any): S);\n        } else {\n          // ๅพช็ฏ่ฐ็จreducer\n          const action = update.action;\n          newState = reducer(newState, action);\n        }\n      }\n      prevUpdate = update;\n      update = update.next;\n    } while (update !== null && update !== first);\n\n    if (!didSkip) {\n      newBaseUpdate = prevUpdate;\n      newBaseState = newState;\n    }\n\n    // ๅชๆๅจๅๅstateๅไบๆไผๆ่ฎฐ\n    if (!is(newState, hook.memoizedState)) {\n      markWorkInProgressReceivedUpdate();\n    }\n    hook.memoizedState = newState;\n    hook.baseUpdate = newBaseUpdate;\n    hook.baseState = newBaseState;\n    queue.lastRenderedState = newState;\n  }\n\n  const dispatch: Dispatch<A> = (queue.dispatch: any);\n  return [hook.memoizedState, dispatch];\n}\n```\n\n\n\n```javascript\nexport function markWorkInProgressReceivedUpdate() {\n  didReceiveUpdate = true;\n}\n```\n\n\n\n## ๅ่ฎฐ\n\nโ\tไฝไธบ็ณปๅ็็ฌฌไธ็ฏๆ็ซ๏ผๆ้ๆฉไบๆๅธธ็จ็hooksๅผๅง๏ผๆๅผๆๅ่ฎก็ฎๅไธreact-reconciler็ไบๅจ๏ผๆดไธชๆต็จๆฏๅๅๆธๆฐๆๆ็ใmount็ๆถๅๆๅปบ้ฉๅญ๏ผ่งฆๅdispatchๆถๆๅบๆๅฅupdateใupdateState็ๆถๅๅๆๅบ่งฆๅreducerใๅฏไปฅ่ฏดๅฐฑๆฏไธไธช็ฎๅ็reduxใไฝๆฏไฝไธบ็ณปๅ็ๅผ็ฏๆ่ฎคไธบ็ฅ่ฏ้ๅทฒ็ป่พพๅฐ่ฆๆฑไบxd",
        "type": "MarkdownRemark",
        "contentDigest": "92cc848036adebd0a960c2d397dd0ce1",
        "owner": "gatsby-transformer-remark",
        "fieldOwners": {
          "slug": "default-site-plugin"
        }
      },
      "frontmatter": {
        "title": "why hooks๏ผไธ๏ผ",
        "date": "2019-03-17",
        "spoiler": "ไปhooksๅๅฅ๏ผๆทฑๅฅไบ่งฃReact็ผ็จๆจกๅ",
        "_PARENT": "41032e46-9ace-53d7-9bab-5db5c57c861e"
      },
      "excerpt": "",
      "rawMarkdownBody": "\n## ๅ่จ\n\nโ\t็ฎๅ่ฏดไธไธบไปไนReact้ๆฉๅฝๆฐๅผ็ปไปถ๏ผไธป่ฆๆฏclass็ปไปถๆฏ่พๅไฝใ็ๅฝๅจๆๅฝๆฐๅๆณไธๅๅฅฝ๏ผ้ชๅๆณๅค๏ผfunctional็ปไปถๆด็ฌฆๅReact็ผ็จๆๆณ็ญ็ญ็ญใๆดๅทไฝ็ๅฏไปฅๆ่ฏปdanๅคง็ฅ็blog:[ไผ้้จ](https://overreacted.io/how-are-function-components-different-from-classes/)ใๅถไธญ**Function components capture the rendered values**่ฟๅฅๅๅ็ฒพ่พ็้ๅบๅฝๆฐๅผ็ปไปถ็ไผๅฟใ\n\nโ\tไฝๆฏๅจ16.8ไนๅreact็ๅฝๆฐๅผ็ปไปถๅๅ็พธๅผฑ๏ผๅบๆฌๅช่ฝไฝ็จไบ็บฏๅฑ็คบ็ปไปถ๏ผไธป่ฆๅไธบ็ผบๅฐstateๅ็ๅฝๅจๆใๆฌไบบๆพ็ปๅจhooksๅบๆฅๅ่ด่ดฃ่ฟ็บฏๅฝๆฐๅผ็react้กน็ฎ๏ผๆๆ็ถๆๅค็้ฝๅฟ้กปๅจreducerไธญ่ฟ่ก๏ผๆๆๅฏไฝ็จ้ฝๅจsagaไธญๆง่ก๏ผๅฏไปฅ่ฏดๆฏๅๅ่ฐ่พ็็ปๅไบใๅจhooksๅบๆฅๅๆๅจๅฌๅธ็ไธไธชๅฐไธญๅฐ้กน็ฎไธญไฝฟ็จ๏ผ่ฝๅฐๆๆไธ้๏ผไปฃ็้ๆพ่ๅๅฐ็ๅๆถๆๅไบไปฃ็็ๅฏ่ฏปๆงใๅไธบ้่ฟcustom hooksๅฏไปฅๆดๅฅฝๅฐๅฅ็ฆปไปฃ็็ปๆ๏ผไธไผๅไปฅๅ็ฑป็ปไปถ้ฃๆทๅจcDU็ญ็ๅฝๅจๆๅไบไธๅคงๅ้ป่พ๏ผๅจๅฝไปคๅผไปฃ็ๅๅฃฐๆๅผไปฃ็ไธญๆไธไธช่ฏๆง็่พน็ใ\n\n## useStateๅจReactไธญๆฏๆไนๅฎ็ฐ็\n\n> Hooks take some getting used to โ and especially at the boundary of imperative and declarative code.\n\nโ\tๅฆๆๅฏนhooksไธๅคชไบ่งฃ็ๅฏไปฅๅ็็่ฟ็ฏๆ็ซ:[ๅๆๆ่ฆ](https://medium.com/@ryardley/react-hooks-not-magic-just-arrays-cd4f1857236e)๏ผๅๅ็ฎๆ็ไป็ปไบhooks็ๆธๅฟๅ็๏ผไฝๆฏๆๅฏนuseEffect๏ผuseRef็ญ้ฉๅญ็ๅฎ็ฐๆฏ่พๅฅฝๅฅ๏ผๆไปฅๅผๅงๅ่ตทไบๆบ็๏ผไธ้ขๆไผ็ปๅๆบ็ไป็ปuseState็ๅ็ใuseStateๅทไฝ้ป่พๅๆไธ้จๅ๏ผmountState๏ผdispatch๏ผ updateState\n\n### hook็็ปๆ\n\n้ฆๅ็ๆฏhooks็็ปๆ๏ผhooksๆฏๆ่ฝฝๅจ็ปไปถFiber็ป็นไธmemoizedState็๏ผๅณไบFiber็ป็นๅฏไปฅ็็ๆ็ๅฆไธ็ฏ๏ผ[ไผ้้จ](https://xuzhanhh.com/Inside%20Fiber/)\n\n```javascript\n//hook็็ปๆ\nexport type Hook = {\n  memoizedState: any, //ไธไธๆฌก็state\n  baseState: any,  //ๅฝๅstate\n  baseUpdate: Update<any, any> | null,  // update func\n  queue: UpdateQueue<any, any> | null,  //็จไบ็ผๅญๅคๆฌกaction\n  next: Hook | null, //้พ่กจ\n};\n```\n\n### renderWithHooks\n\nๅจreconcilerไธญๅค็ๅฝๆฐๅผ็ปไปถ็ๅฝๆฐๆฏrenderWithHooks๏ผๅถ็ฑปๅๆฏ๏ผ\n\n```javascript\nrenderWithHooks(\n  current: Fiber | null, //ๅฝๅ็fiber็ป็น\n  workInProgress: Fiber, \n  Component: any, //jsxไธญ็จ<>่ฐ็จ็ๅฝๆฐ\n  props: any,\n  refOrContext: any,\n  nextRenderExpirationTime: ExpirationTime, //้่ฆๅจไปไนๆถๅ็ปๆ\n): any\n```\n\nๅจrenderWithHooks๏ผๆธๅฟๆต็จๅฆไธ๏ผ\n\n```javascript\n//ไปmemoizedStateไธญๅๅบhooks\nnextCurrentHook = current !== null ? current.memoizedState : null; \n//ๅคๆญ้่ฟๆๆฒกๆhooksๅคๆญๆฏmount่ฟๆฏupdate๏ผไธค่็ๅฝๆฐไธๅ\nReactCurrentDispatcher.current =\n      nextCurrentHook === null\n        ? HooksDispatcherOnMount\n        : HooksDispatcherOnUpdate;\n//ๆง่กไผๅฅ็typeๅฝๆฐ\nlet children = Component(props, refOrContext);\n//ๆง่กๅฎๅฝๆฐๅ็dispatcherๅๆๅช่ฝ่ฐ็จcontext็\nReactCurrentDispatcher.current = ContextOnlyDispatcher;\n\nreturn children;\n```\n\n### useStateๆๅปบๆถๆต็จ\n\n**mountState**\n\nๅจHooksDispatcherOnMountไธญ๏ผuseState่ฐ็จ็ๆฏไธ้ข็mountState๏ผไฝ็จๆฏๅๅปบไธไธชๆฐ็hookๅนถไฝฟ็จ้ป่ฎคๅผๅๅงๅๅนถ็ปๅฎๅถ่งฆๅๅจ๏ผๅไธบuseStateๅบๅฑๆฏuseReducer๏ผๆไปฅๆฐ็ป็ฌฌไบไธชๅผ่ฟๅ็ๆฏdispatchใ\n\n```typescript\ntype BasicStateAction<S> = (S => S) | S;\n\nfunction mountState<S>(\n  initialState: (() => S) | S,\n): [S, Dispatch<BasicStateAction<S>>] {\n  const hook = mountWorkInProgressHook();\n//ๅฆๆๅฅๅๆฏfuncๅไผ่ฐ็จ๏ผไฝๆฏไธๆไพๅๆฐ๏ผๅธฆๅๆฐ็้่ฆๅไธๅฑ\n  if (typeof initialState === 'function') {\n    initialState = initialState();\n  }\n//ไธไธไธชstateๅๅบๆฌ(ๅฝๅ)state้ฝๅๅงๅ\n  hook.memoizedState = hook.baseState = initialState;\n  const queue = (hook.queue = {\n    last: null,\n    dispatch: null,\n    eagerReducer: basicStateReducer, // useStateไฝฟ็จๅบ็กreducer\n    eagerState: (initialState: any),\n  });\n//่ฟๅ่งฆๅๅจ\n  const dispatch: Dispatch<\n    //useStateๅบๅฑๆฏuseReducer๏ผๆไปฅtypeๆฏBasicStateAction\n    BasicStateAction<S>,\n  > = (queue.dispatch = (dispatchAction.bind(\n    null,\n    //็ปๅฎๅฝๅfiber็ป็นๅqueue\n    ((currentlyRenderingFiber: any): Fiber),\n    queue,\n  ): any));\n  return [hook.memoizedState, dispatch];\n}\n```\n\n**mountWorkInProgressHook**\n\n่ฟไธชๅฝๆฐๆฏmountStateๆถ่ฐ็จ็ๆๅปบhook็ๆนๆณ๏ผๅจๅๅงๅๅฎๆฏๅไผ่ฟๆฅๅฐๅฝๅhook.next๏ผๅฆๆๆ็่ฏ๏ผ\n\n```javascript\nfunction mountWorkInProgressHook(): Hook {\n  const hook: Hook = {\n    memoizedState: null,\n    baseState: null,\n    queue: null,\n    baseUpdate: null,\n    next: null,\n  };\n  if (workInProgressHook === null) {\n    // ๅ่กจไธญ็็ฌฌไธไธชhook\n    firstWorkInProgressHook = workInProgressHook = hook;\n  } else {\n    // ๆทปๅๅฐๅ่กจ็ๆซๅฐพ\n    workInProgressHook = workInProgressHook.next = hook;\n  }\n  return workInProgressHook;\n}\n```\n\n### dispatchๅๅๅฝๆฐ\n\nโ\tๅจไธ้ขๆไปฌๆๅฐ๏ผuseStateๅบๅฑๆฏuseReducer๏ผๆไปฅ่ฟๅ็็ฌฌไบไธชๅๆฐๆฏdispatchๅฝๆฐ๏ผๅถไธญ็่ฎพ่ฎกๅๅๅทงๅฆใ\n\nๅ่ฎพๆไปฌๆไปฅไธไปฃ็:\n\n```javascript\nconst [data, setData] = React.useState(0)\nsetData('first')\nsetData('second')\nsetData('third')\n```\n\n![image-20190317151730512](/images/image-20190317151730512.png)\n\nๅจ็ฌฌไธๆฌกsetDataๅ๏ผ hooks็็ปๆๅฆไธๅพ\n\n![image-20190317152006773](/images/image-20190317152006773.png)\n\nๅจ็ฌฌไบๆฌกsetDataๅ๏ผ hooks็็ปๆๅฆไธๅพ\n\n![image-20190317152401946](/images/image-20190317152401946.png)\n\nๅจ็ฌฌไธๆฌกsetDataๅ๏ผ hooks็็ปๆๅฆไธๅพ\n\n![image-20190318114449227](/images/image-20190318114449227.png)\n\nๅจๆญฃๅธธๆๅตไธ๏ผๆฏไธไผๅจdispatcherไธญ่งฆๅreducer่ๆฏๅฐactionๅญๅฅupdateไธญๅจupdateStateไธญๅๆง่ก๏ผไฝๆฏๅฆๆๅจreactๆฒกๆ้ๆธฒๆ้ๆฑ็ๅๆไธๆฏไผๆๅ่ฎก็ฎstateๅณeagerStateใไฝไธบๆง่ฝไผๅ็ไธ็ฏใ\n\n```typescript\nfunction dispatchAction<S, A>(\n  fiber: Fiber,\n  queue: UpdateQueue<S, A>,\n  action: A,\n) {\n  const alternate = fiber.alternate;\n   {\n    flushPassiveEffects();\n\t//่ทๅๅฝๅๆถ้ดๅนถ่ฎก็ฎๅฏ็จๆถ้ด\n    const currentTime = requestCurrentTime();\n    const expirationTime = computeExpirationForFiber(currentTime, fiber);\n\n    const update: Update<S, A> = {\n      expirationTime,\n      action,\n      eagerReducer: null,\n      eagerState: null,\n      next: null,\n    };\n\t//ไธ้ข็ไปฃ็ๅฐฑๆฏไธบไบๆๅปบqueue.lastๆฏๆๆฐ็ๆดๆฐ๏ผ็ถๅlast.nextๅผๅงๆฏๆฏไธๆฌก็action\n    // ๅๅบlast\n    const last = queue.last;\n    if (last === null) {\n      // ่ชๅ\n      update.next = update;\n    } else {\n      const first = last.next;\n      if (first !== null) {\n        \n        update.next = first;\n      }\n      last.next = update;\n    }\n    queue.last = update;\n\n    if (\n      fiber.expirationTime === NoWork &&\n      (alternate === null || alternate.expirationTime === NoWork)\n    ) {\n      // ๅฝๅ้ๅไธบ็ฉบ๏ผๆไปฌๅฏไปฅๅจ่ฟๅฅrender้ถๆฎตๅๆๅ่ฎก็ฎๅบไธไธไธช็ถๆใๅฆๆๆฐ็็ถๆๅๅฝๅ็ถๆ็ธๅ๏ผๅๅฏไปฅ้ๅบ้ๆธฒๆ\n      const lastRenderedReducer = queue.lastRenderedReducer; // ไธๆฌกๆดๆฐๅฎๅ็reducer\n      if (lastRenderedReducer !== null) {\n        let prevDispatcher;\n        if (__DEV__) {\n          prevDispatcher = ReactCurrentDispatcher.current;  // ๆๅญdispatcher\n          ReactCurrentDispatcher.current = InvalidNestedHooksDispatcherOnUpdateInDEV;\n        }\n        try {\n          const currentState: S = (queue.lastRenderedState: any);\n          // ่ฎก็ฎไธๆฌกstate\n          const eagerState = lastRenderedReducer(currentState, action);\n          // ๅจupdateๅฏน่ฑกไธญๅญๅจ้ข่ฎก็ฎ็ๅฎๆด็ถๆๅreducer๏ผๅฆๆๅจ่ฟๅฅrender้ถๆฎตๅreducerๆฒกๆๅๅ้ฃไนๅฏไปฅๆ็จeagerState่ไธ็จ้ๆฐๅๆฌก่ฐ็จreducer\n          update.eagerReducer = lastRenderedReducer;\n          update.eagerState = eagerState;\n          if (is(eagerState, currentState)) {\n            // ๅจๅ็ปญ็ๆถ้ดไธญ๏ผๅฆๆ่ฟไธช็ปไปถๅๅซ็ๅๅ่ขซ้ๆธฒๆไธๅจ้ฃๆถreducerๆดๅๅ๏ผไปๆๅฏ่ฝ้ๅปบ่ฟๆฌกๆดๆฐ\n            return;\n          }\n        } catch (error) {\n          // Suppress the error. It will throw again in the render phase.\n        } finally {\n          if (__DEV__) {\n            ReactCurrentDispatcher.current = prevDispatcher;\n          }\n        }\n      }\n    }\n    scheduleWork(fiber, expirationTime);\n  }\n}\n```\n\n\n\n### useStateๆดๆฐๆถๆต็จ\n\n**updateReducer**\n\nโ\tๅไธบuseStateๅบๅฑๆฏuseReducer๏ผๆไปฅๅจๆดๆฐๆถ็ๆต็จ(ๅณ้ๆธฒๆ็ปไปถๅ)ๆฏ่ฐ็จupdateReducer็ใ\n\n```typescript\nfunction updateState<S>(\n  initialState: (() => S) | S,\n): [S, Dispatch<BasicStateAction<S>>] {\n  return updateReducer(basicStateReducer, (initialState: any));\n}\n```\n\nโ\tๆไปฅๅถreducerๅๅ็ฎๅ\n\n```typescript\nfunction basicStateReducer<S>(state: S, action: BasicStateAction<S>): S {\n  return typeof action === 'function' ? action(state) : action;\n}\n```\n\nโ\tๆไปฌๅๆๅคๆๆๅตๆๅผ๏ผ่ท้updateReducerๆต็จ\n\n```typescript\nfunction updateReducer<S, I, A>(\n  reducer: (S, A) => S,\n  initialArg: I,\n  init?: I => S,\n): [S, Dispatch<A>] {\n  // ่ทๅๅฝๅhook,queue\n  const hook = updateWorkInProgressHook();\n  const queue = hook.queue;\n\n  queue.lastRenderedReducer = reducer;\n\n  // action้ๅ็ๆๅไธไธชๆดๆฐ\n  const last = queue.last;\n  // ๆๅไธไธชๆดๆฐๆฏๅบๆฌ็ถๆ\n  const baseUpdate = hook.baseUpdate;\n  const baseState = hook.baseState;\n\n  // ๆพๅฐ็ฌฌไธไธชๆฒกๅค็็ๆดๆฐ\n  let first;\n  if (baseUpdate !== null) {\n    if (last !== null) {\n      // ็ฌฌไธๆฌกๆดๆฐๆถ๏ผ้ๅๆฏไธไธช่ชๅqueue.last.next = queue.firstใๅฝ็ฌฌไธๆฌกupdateๆไบคๅ๏ผbaseUpdateไธๅไธบ็ฉบๅณๅฏ่ทณๅบ้ๅ\n      last.next = null;\n    }\n    first = baseUpdate.next;\n  } else {\n    first = last !== null ? last.next : null;\n  }\n  if (first !== null) {\n    let newState = baseState;\n    let newBaseState = null;\n    let newBaseUpdate = null;\n    let prevUpdate = baseUpdate;\n    let update = first;\n    let didSkip = false;\n    do {\n      const updateExpirationTime = update.expirationTime;\n      if (updateExpirationTime < renderExpirationTime) {\n        // ไผๅ็บงไธ่ถณ๏ผ่ทณ่ฟ่ฟๆฌกๆดๆฐ๏ผๅฆๆ่ฟๆฏ็ฌฌไธๆฌก่ทณ่ฟๆดๆฐ๏ผไธไธไธชupdate/stateๆฏnewBaseupdate/state\n        if (!didSkip) {\n          didSkip = true;\n          newBaseUpdate = prevUpdate;\n          newBaseState = newState;\n        }\n        // ๆดๆฐไผๅ็บง\n        if (updateExpirationTime > remainingExpirationTime) {\n          remainingExpirationTime = updateExpirationTime;\n        }\n      } else {\n        // ๅค็ๆดๆฐ\n        if (update.eagerReducer === reducer) {\n          // ๅฆๆๆดๆฐ่ขซๆๅๅค็ไบไธreducer่ทๅฝๅreducerๅน้๏ผๅฏไปฅๅค็จeagerState\n          newState = ((update.eagerState: any): S);\n        } else {\n          // ๅพช็ฏ่ฐ็จreducer\n          const action = update.action;\n          newState = reducer(newState, action);\n        }\n      }\n      prevUpdate = update;\n      update = update.next;\n    } while (update !== null && update !== first);\n\n    if (!didSkip) {\n      newBaseUpdate = prevUpdate;\n      newBaseState = newState;\n    }\n\n    // ๅชๆๅจๅๅstateๅไบๆไผๆ่ฎฐ\n    if (!is(newState, hook.memoizedState)) {\n      markWorkInProgressReceivedUpdate();\n    }\n    hook.memoizedState = newState;\n    hook.baseUpdate = newBaseUpdate;\n    hook.baseState = newBaseState;\n    queue.lastRenderedState = newState;\n  }\n\n  const dispatch: Dispatch<A> = (queue.dispatch: any);\n  return [hook.memoizedState, dispatch];\n}\n```\n\n\n\n```javascript\nexport function markWorkInProgressReceivedUpdate() {\n  didReceiveUpdate = true;\n}\n```\n\n\n\n## ๅ่ฎฐ\n\nโ\tไฝไธบ็ณปๅ็็ฌฌไธ็ฏๆ็ซ๏ผๆ้ๆฉไบๆๅธธ็จ็hooksๅผๅง๏ผๆๅผๆๅ่ฎก็ฎๅไธreact-reconciler็ไบๅจ๏ผๆดไธชๆต็จๆฏๅๅๆธๆฐๆๆ็ใmount็ๆถๅๆๅปบ้ฉๅญ๏ผ่งฆๅdispatchๆถๆๅบๆๅฅupdateใupdateState็ๆถๅๅๆๅบ่งฆๅreducerใๅฏไปฅ่ฏดๅฐฑๆฏไธไธช็ฎๅ็reduxใไฝๆฏไฝไธบ็ณปๅ็ๅผ็ฏๆ่ฎคไธบ็ฅ่ฏ้ๅทฒ็ป่พพๅฐ่ฆๆฑไบxd",
      "fileAbsolutePath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/why hooks.md",
      "fields": {
        "slug": "/why hooks/"
      }
    },
    "SitePage /why hooks/": {
      "jsonName": "why-hooks-e09",
      "internalComponentName": "ComponentWhyHooks",
      "path": "/why hooks/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/why hooks/",
        "previous": {
          "fields": {
            "slug": "/All about generator/"
          },
          "frontmatter": {
            "title": "All about generator"
          }
        },
        "next": null
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /why hooks/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "c061b4dc9fec21727823efc880430210",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /All about generator/": {
      "jsonName": "all-about-generator-055",
      "internalComponentName": "ComponentAllAboutGenerator",
      "path": "/All about generator/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/All about generator/",
        "previous": {
          "fields": {
            "slug": "/Inside Fiber/"
          },
          "frontmatter": {
            "title": "Inside Fiber"
          }
        },
        "next": {
          "fields": {
            "slug": "/why hooks/"
          },
          "frontmatter": {
            "title": "why hooks๏ผไธ๏ผ"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /All about generator/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "578f98f1747de6584495c95db534784b",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /Inside Fiber/": {
      "jsonName": "inside-fiber-8ec",
      "internalComponentName": "ComponentInsideFiber",
      "path": "/Inside Fiber/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/Inside Fiber/",
        "previous": {
          "fields": {
            "slug": "/react 16.7/"
          },
          "frontmatter": {
            "title": "react 16.7"
          }
        },
        "next": {
          "fields": {
            "slug": "/All about generator/"
          },
          "frontmatter": {
            "title": "All about generator"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /Inside Fiber/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "fa27d49d5417afb82ed6d15a5c5bde9b",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /react 16.7/": {
      "jsonName": "react-16-7-c3b",
      "internalComponentName": "ComponentReact167",
      "path": "/react 16.7/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/react 16.7/",
        "previous": {
          "fields": {
            "slug": "/react hooks@seb/"
          },
          "frontmatter": {
            "title": "react hooks@seb"
          }
        },
        "next": {
          "fields": {
            "slug": "/Inside Fiber/"
          },
          "frontmatter": {
            "title": "Inside Fiber"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /react 16.7/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "48e79961089b8ec200ce2c093e4e286d",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /react hooks@seb/": {
      "jsonName": "react-hooks-seb-80c",
      "internalComponentName": "ComponentReactHooksSeb",
      "path": "/react hooks@seb/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/react hooks@seb/",
        "previous": {
          "fields": {
            "slug": "/learning A Cartoon to Fiber/"
          },
          "frontmatter": {
            "title": "learning A Cartoon to Fiber"
          }
        },
        "next": {
          "fields": {
            "slug": "/react 16.7/"
          },
          "frontmatter": {
            "title": "react 16.7"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /react hooks@seb/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "029bb9f851b75d79cb09b9f76dbc25d7",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /learning A Cartoon to Fiber/": {
      "jsonName": "learning-a-cartoon-to-fiber-49a",
      "internalComponentName": "ComponentLearningACartoonToFiber",
      "path": "/learning A Cartoon to Fiber/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/learning A Cartoon to Fiber/",
        "previous": {
          "fields": {
            "slug": "/Promise/"
          },
          "frontmatter": {
            "title": "Promise"
          }
        },
        "next": {
          "fields": {
            "slug": "/react hooks@seb/"
          },
          "frontmatter": {
            "title": "react hooks@seb"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /learning A Cartoon to Fiber/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "d24c7bb62cd5906c2392e27b6570831c",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /Promise/": {
      "jsonName": "promise-95f",
      "internalComponentName": "ComponentPromise",
      "path": "/Promise/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/Promise/",
        "previous": {
          "fields": {
            "slug": "/state & props update/"
          },
          "frontmatter": {
            "title": "state & props update"
          }
        },
        "next": {
          "fields": {
            "slug": "/learning A Cartoon to Fiber/"
          },
          "frontmatter": {
            "title": "learning A Cartoon to Fiber"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /Promise/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "075a83575ecd12270905237eaa2fdece",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /state & props update/": {
      "jsonName": "state-props-update-e16",
      "internalComponentName": "ComponentStatePropsUpdate",
      "path": "/state & props update/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "componentChunkName": "component---src-templates-blog-post-js",
      "context": {
        "slug": "/state & props update/",
        "previous": null,
        "next": {
          "fields": {
            "slug": "/Promise/"
          },
          "frontmatter": {
            "title": "Promise"
          }
        }
      },
      "pluginCreator___NODE": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "pluginCreatorId": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js",
      "id": "SitePage /state & props update/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "a8195db38f7d40e242c1e938d8369437",
        "description": "7374ebf2-d961-52ee-92a2-c25e7cb387a9",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /404/": {
      "jsonName": "404-22d",
      "internalComponentName": "Component404",
      "path": "/404/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js",
      "componentChunkName": "component---src-pages-404-js",
      "context": {},
      "pluginCreator___NODE": "de1454a8-036b-57ef-8599-4e481f13b079",
      "pluginCreatorId": "de1454a8-036b-57ef-8599-4e481f13b079",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js",
      "id": "SitePage /404/",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "25a47886fc72adfc4261d5e3de012242",
        "description": "de1454a8-036b-57ef-8599-4e481f13b079",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /": {
      "jsonName": "index",
      "internalComponentName": "ComponentIndex",
      "path": "/",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/pages/index.js",
      "componentChunkName": "component---src-pages-index-js",
      "context": {},
      "pluginCreator___NODE": "de1454a8-036b-57ef-8599-4e481f13b079",
      "pluginCreatorId": "de1454a8-036b-57ef-8599-4e481f13b079",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/index.js",
      "id": "SitePage /",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "5081d8363c193a80af4e92cc7fcc4e1f",
        "description": "de1454a8-036b-57ef-8599-4e481f13b079",
        "owner": "internal-data-bridge"
      }
    },
    "SitePage /404.html": {
      "jsonName": "404-html-516",
      "internalComponentName": "Component404Html",
      "path": "/404.html",
      "component": "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js",
      "componentChunkName": "component---src-pages-404-js",
      "context": {},
      "pluginCreator___NODE": "f795702c-a3b8-5a88-88ee-5d06019d44fa",
      "pluginCreatorId": "f795702c-a3b8-5a88-88ee-5d06019d44fa",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js",
      "id": "SitePage /404.html",
      "parent": "SOURCE",
      "children": [],
      "internal": {
        "type": "SitePage",
        "contentDigest": "10971f3d0a22ffd200c4ed8a14c8f4d0",
        "description": "f795702c-a3b8-5a88-88ee-5d06019d44fa",
        "owner": "internal-data-bridge"
      }
    }
  },
  "status": {
    "plugins": {},
    "PLUGINS_HASH": "6ce1b85c57bc368073d99d24d22bb1fd"
  },
  "componentDataDependencies": {
    "nodes": {
      "Site": [
        "/",
        "/Inside Fiber/",
        "/react hooks@seb/",
        "/learning A Cartoon to Fiber/",
        "/Promise/",
        "/react 16.7/",
        "/why hooks/",
        "/All about generator/",
        "/state & props update/",
        "sq--src-components-seo-js"
      ],
      "55557a74-de54-5683-bd78-3de2108f3ce8": [
        "/Inside Fiber/"
      ],
      "351744df-b3d1-5265-a694-9e77f722426e": [
        "/react hooks@seb/"
      ],
      "8b5a4b64-a89e-5d42-a386-121a4aeb1e1d": [
        "/learning A Cartoon to Fiber/"
      ],
      "d16d8354-6f61-5f1a-ad48-bd02309a1329": [
        "/Promise/"
      ],
      "5d6aff10-a2ce-5c90-87e2-9613addfdbf8": [
        "/react 16.7/"
      ],
      "1b09d9a5-bd3d-5b54-a015-38a243a0175e": [
        "/why hooks/"
      ],
      "47075887-16be-50c6-96fc-5d6e79e00345": [
        "/All about generator/"
      ],
      "ea8cfa21-a625-585a-a4a0-f7228c379019": [
        "/state & props update/"
      ]
    },
    "connections": {
      "MarkdownRemark": [
        null,
        "/",
        null
      ]
    }
  },
  "jsonDataPaths": {
    "sq--src-components-seo-js": 3236765318,
    "index": "580/path---index-6a9-S7jZl2MadYxY0j2D7fy88t5qUk",
    "optimized-for-change-778": "760/path---optimized-for-change-778-742-poFtbajknC5Kk4f2Dpb6bYqTXoM",
    "my-wishlist-for-hot-reloading-5e1": "76/path---my-wishlist-for-hot-reloading-5-e-1-d05-ChKRFkmUcwIQ1bYRqzUOg3QUo",
    "how-does-setstate-know-what-to-do-c44": "590/path---how-does-setstate-know-what-to-do-c-44-cad-EFCfbQ8QgTA4SRUQw8H2iDXFzM",
    "why-do-react-elements-have-typeof-property-678": "8/path---why-do-react-elements-have-typeof-property-678-398-Ke0id29WD7WA40reZHA3mwptDw",
    "how-does-react-tell-a-class-from-a-function-45e": "148/path---how-does-react-tell-a-class-from-a-function-45-e-4b0-3ACXpnFLCMWbbfkS8Je6MLfL91Q",
    "dev-404-page-5f9": "920/path---dev-404-page-5-f-9-fab-NZuapzHg3X9TaN1iIixfv1W23E",
    "why-do-we-write-super-props-abc": "206/path---why-do-we-write-super-props-abc-42e-m0YOSACxgMMmG1vkgDhGP4RZk",
    "404-22d": "44/path---404-22-d-bce-NZuapzHg3X9TaN1iIixfv1W23E",
    "404-html-516": "164/path---404-html-516-62a-NZuapzHg3X9TaN1iIixfv1W23E",
    "inside-fiber-8ec": "632/path---inside-fiber-8-ec-531-3e1FA5nhwArJ81qk7mdiP5Hg268",
    "react-hooks-seb-80c": "712/path---react-hooks-seb-80-c-41b-6oE84fps3f0udOJEl8obZr744g",
    "promise-95f": "871/path---promise-95-f-05e-Kzvl9gxsc4cQkMot3G6qzQHU0",
    "learning-a-cartoon-to-fiber-49a": "445/path---learning-a-cartoon-to-fiber-49-a-336-0VdIaiRpcADLCLjx8M3aJvgUXU",
    "react-16-7-c3b": "602/path---react-16-7-c-3-b-58e-VvltQrVjHBwJDMBhfHYT2QdUN0",
    "all-about-generator-055": "663/path---all-about-generator-055-d4a-F4FpaAnVepMjKMqQoMS9KrAsrQ",
    "why-hooks-e09": "846/path---why-hooks-e-09-c1d-HIQM30egzEa8eIDGxJf8XUzYg",
    "state-props-update-e16": "636/path---state-props-update-e-16-282-88dz1pazmoXhHSTDNlfONO37hA"
  },
  "components": {
    "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js": {
      "query": "query BlogPostBySlug(\n  $slug: String!\n) {\n  site {\n    siteMetadata {\n      title\n      author\n    }\n  }\n  markdownRemark(fields: {slug: {eq: $slug}}) {\n    id\n    html\n    timeToRead\n    frontmatter {\n      title\n      date(formatString: \"MMMM DD, YYYY\")\n      spoiler\n    }\n    fields {\n      slug\n    }\n  }\n}\n",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/templates/blog-post.js"
    },
    "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js": {
      "query": "",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/404.js"
    },
    "/Users/xuzhanhong1/study/overreacted.io/src/pages/index.js": {
      "query": "query usersXuzhanhong1StudyOverreactedIoSrcPagesIndexJs796900122 {\n  site {\n    siteMetadata {\n      title\n      description\n    }\n  }\n  allMarkdownRemark(sort: {fields: [frontmatter___date], order: DESC}) {\n    edges {\n      node {\n        fields {\n          slug\n        }\n        timeToRead\n        frontmatter {\n          date(formatString: \"MMMM DD, YYYY\")\n          title\n          spoiler\n        }\n      }\n    }\n  }\n}\n",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/pages/index.js"
    }
  },
  "staticQueryComponents": {
    "sq--src-components-seo-js": {
      "name": "GetSiteMetadata",
      "componentPath": "/Users/xuzhanhong1/study/overreacted.io/src/components/SEO.js",
      "id": "sq--src-components-seo-js",
      "jsonName": "sq--src-components-seo-js",
      "query": "query GetSiteMetadata {\n  site {\n    siteMetadata {\n      title\n      author\n      description\n      siteUrl\n      social {\n        twitter\n      }\n    }\n  }\n}\n",
      "hash": 3236765318
    }
  }
}